{"version":3,"sources":["webpack://wc.[modulename]/./client/wc-api/reports/utils.js"],"names":["getFilterQuery","options","endpoint","query","limitBy","filters","advancedFilters","search","limitProperties","reduce","result","limitProperty","map","filter","getQueryFromConfig","configQuery","Object","assign","noIntervalEndpoints","timeStampFilterDates","config","activeFilter","advancedFilterConfig","key","get","rule","value","timeOfDayMap","after","before","Array","isArray","appendTimestamp","moment","queryValue","param","activeFilters","getActiveFiltersFromQuery","length","getUrlKey","match","find","flattenFilters","settings","isReportDataEmpty","report","data","totals","isNull","checkIntervals","includes","intervals","getRequestQuery","dataType","fields","datesFromQuery","getCurrentDates","defaultDateRange","interval","getIntervalForQuery","filterQuery","end","noIntervals","order","per_page","MAX_PER_PAGE","segmentby","getSummaryNumbers","select","getReportStats","getReportStatsError","isReportStatsRequesting","response","isRequesting","isError","primary","secondary","primaryQuery","primaryTotals","secondaryQuery","secondaryTotals","getReportChartData","isEmpty","requestQuery","stats","totalResults","isFetching","pagedData","totalPages","Math","ceil","pagesFetched","i","nextQuery","page","_data","push","forEach","concat","getTooltipValueFormat","type","formatCurrency","getReportTableQuery","tableQuery","orderby","undefined","paged","QUERY_DEFAULTS","pageSize","getReportTableData","getReportItems","getReportItemsError","isReportItemsRequesting","reportsUtils","items"],"mappings":"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","file":"chunks/analytics-report-categories~analytics-report-coupons~analytics-report-customers~analytics-report-dow~141c9af9.812c41fb98cc6e3f843e.min.js","sourcesContent":["/**\n * External dependencies\n */\nimport { find, forEach, isNull, get, includes } from 'lodash';\nimport moment from 'moment';\n\n/**\n * WooCommerce dependencies\n */\nimport {\n\tappendTimestamp,\n\tgetCurrentDates,\n\tgetIntervalForQuery,\n} from 'lib/date';\nimport {\n\tflattenFilters,\n\tgetActiveFiltersFromQuery,\n\tgetUrlKey,\n} from '@woocommerce/navigation';\n\n/**\n * Internal dependencies\n */\nimport { MAX_PER_PAGE, QUERY_DEFAULTS } from 'wc-api/constants';\nimport * as reportsUtils from './utils';\n\n/**\n * Add filters and advanced filters values to a query object.\n *\n * @param  {Object} options                   arguments\n * @param  {string} options.endpoint          Report API Endpoint\n * @param  {Object} options.query             Query parameters in the url\n * @param  {Array}  options.limitBy           Properties used to limit the results. It will be used in the API call to send the IDs.\n * @param  {Array}  [options.filters]         config filters\n * @param  {Object} [options.advancedFilters] config advanced filters\n * @return {Object} A query object with the values from filters and advanced fitlters applied.\n */\nexport function getFilterQuery( options ) {\n\tconst {\n\t\tendpoint,\n\t\tquery,\n\t\tlimitBy,\n\t\tfilters = [],\n\t\tadvancedFilters = {},\n\t} = options;\n\tif ( query.search ) {\n\t\tconst limitProperties = limitBy || [ endpoint ];\n\t\treturn limitProperties.reduce( ( result, limitProperty ) => {\n\t\t\tresult[ limitProperty ] = query[ limitProperty ];\n\t\t\treturn result;\n\t\t}, {} );\n\t}\n\n\treturn filters\n\t\t.map( ( filter ) =>\n\t\t\tgetQueryFromConfig( filter, advancedFilters, query )\n\t\t)\n\t\t.reduce(\n\t\t\t( result, configQuery ) => Object.assign( result, configQuery ),\n\t\t\t{}\n\t\t);\n}\n\n// Some stats endpoints don't have interval data, so they can ignore after/before params and omit that part of the response.\nconst noIntervalEndpoints = [ 'stock', 'customers' ];\n\n/**\n * Add timestamp to advanced filter parameters involving date. The api\n * expects a timestamp for these values similar to `before` and `after`.\n *\n * @param {Object} config - advancedFilters config object.\n * @param {Object} activeFilter - an active filter.\n * @return {Object} - an active filter with timestamp added to date values.\n */\nexport function timeStampFilterDates( config, activeFilter ) {\n\tconst advancedFilterConfig = config.filters[ activeFilter.key ];\n\tif ( get( advancedFilterConfig, [ 'input', 'component' ] ) !== 'Date' ) {\n\t\treturn activeFilter;\n\t}\n\n\tconst { rule, value } = activeFilter;\n\tconst timeOfDayMap = {\n\t\tafter: 'start',\n\t\tbefore: 'end',\n\t};\n\t// If the value is an array, it signifies \"between\" values which must have a timestamp\n\t// appended to each value.\n\tif ( Array.isArray( value ) ) {\n\t\tconst [ after, before ] = value;\n\t\treturn Object.assign( {}, activeFilter, {\n\t\t\tvalue: [\n\t\t\t\tappendTimestamp( moment( after ), timeOfDayMap.after ),\n\t\t\t\tappendTimestamp( moment( before ), timeOfDayMap.before ),\n\t\t\t],\n\t\t} );\n\t}\n\n\treturn Object.assign( {}, activeFilter, {\n\t\tvalue: appendTimestamp( moment( value ), timeOfDayMap[ rule ] ),\n\t} );\n}\n\nexport function getQueryFromConfig( config, advancedFilters, query ) {\n\tconst queryValue = query[ config.param ];\n\n\tif ( ! queryValue ) {\n\t\treturn {};\n\t}\n\n\tif ( queryValue === 'advanced' ) {\n\t\tconst activeFilters = getActiveFiltersFromQuery(\n\t\t\tquery,\n\t\t\tadvancedFilters.filters\n\t\t);\n\n\t\tif ( activeFilters.length === 0 ) {\n\t\t\treturn {};\n\t\t}\n\n\t\treturn activeFilters\n\t\t\t.map( ( filter ) =>\n\t\t\t\ttimeStampFilterDates( advancedFilters, filter )\n\t\t\t)\n\t\t\t.reduce(\n\t\t\t\t( result, activeFilter ) => {\n\t\t\t\t\tconst { key, rule, value } = activeFilter;\n\t\t\t\t\tresult[ getUrlKey( key, rule ) ] = value;\n\t\t\t\t\treturn result;\n\t\t\t\t},\n\t\t\t\t{ match: query.match || 'all' }\n\t\t\t);\n\t}\n\n\tconst filter = find( flattenFilters( config.filters ), {\n\t\tvalue: queryValue,\n\t} );\n\n\tif ( ! filter ) {\n\t\treturn {};\n\t}\n\n\tif ( filter.settings && filter.settings.param ) {\n\t\tconst { param } = filter.settings;\n\n\t\tif ( query[ param ] ) {\n\t\t\treturn {\n\t\t\t\t[ param ]: query[ param ],\n\t\t\t};\n\t\t}\n\n\t\treturn {};\n\t}\n\n\treturn {\n\t\t[ config.param ]: queryValue,\n\t};\n}\n\n/**\n * Returns true if a report object is empty.\n *\n * @param  {Object}  report   Report to check\n * @param  {string}  endpoint Endpoint slug\n * @return {boolean}        True if report is data is empty.\n */\nexport function isReportDataEmpty( report, endpoint ) {\n\tif ( ! report ) {\n\t\treturn true;\n\t}\n\tif ( ! report.data ) {\n\t\treturn true;\n\t}\n\tif ( ! report.data.totals || isNull( report.data.totals ) ) {\n\t\treturn true;\n\t}\n\n\tconst checkIntervals = ! includes( noIntervalEndpoints, endpoint );\n\tif (\n\t\tcheckIntervals &&\n\t\t( ! report.data.intervals || report.data.intervals.length === 0 )\n\t) {\n\t\treturn true;\n\t}\n\treturn false;\n}\n\n/**\n * Constructs and returns a query associated with a Report data request.\n *\n * @param  {Object} options           arguments\n * @param  {string} options.endpoint  Report API Endpoint\n * @param  {string} options.dataType  'primary' or 'secondary'.\n * @param  {Object} options.query     Query parameters in the url.\n * @param  {Array}  options.limitBy   Properties used to limit the results. It will be used in the API call to send the IDs.\n * @param  {string}  options.defaultDateRange   User specified default date range.\n * @return {Object} data request query parameters.\n */\nfunction getRequestQuery( options ) {\n\tconst { endpoint, dataType, query, fields } = options;\n\tconst datesFromQuery = getCurrentDates( query, options.defaultDateRange );\n\tconst interval = getIntervalForQuery( query );\n\tconst filterQuery = getFilterQuery( options );\n\tconst end = datesFromQuery[ dataType ].before;\n\n\tconst noIntervals = includes( noIntervalEndpoints, endpoint );\n\treturn noIntervals\n\t\t? { ...filterQuery, fields }\n\t\t: {\n\t\t\t\torder: 'asc',\n\t\t\t\tinterval,\n\t\t\t\tper_page: MAX_PER_PAGE,\n\t\t\t\tafter: appendTimestamp(\n\t\t\t\t\tdatesFromQuery[ dataType ].after,\n\t\t\t\t\t'start'\n\t\t\t\t),\n\t\t\t\tbefore: appendTimestamp( end, 'end' ),\n\t\t\t\tsegmentby: query.segmentby,\n\t\t\t\tfields,\n\t\t\t\t...filterQuery,\n\t\t  };\n}\n\n/**\n * Returns summary number totals needed to render a report page.\n *\n * @param  {Object} options           arguments\n * @param  {string} options.endpoint  Report API Endpoint\n * @param  {Object} options.query     Query parameters in the url\n * @param  {Object} options.select    Instance of @wordpress/select\n * @param  {Array}  options.limitBy   Properties used to limit the results. It will be used in the API call to send the IDs.\n * @param  {string}  options.defaultDateRange   User specified default date range.\n * @return {Object} Object containing summary number responses.\n */\nexport function getSummaryNumbers( options ) {\n\tconst { endpoint, select } = options;\n\tconst {\n\t\tgetReportStats,\n\t\tgetReportStatsError,\n\t\tisReportStatsRequesting,\n\t} = select( 'wc-api' );\n\tconst response = {\n\t\tisRequesting: false,\n\t\tisError: false,\n\t\ttotals: {\n\t\t\tprimary: null,\n\t\t\tsecondary: null,\n\t\t},\n\t};\n\n\tconst primaryQuery = getRequestQuery( { ...options, dataType: 'primary' } );\n\n\t// Disable eslint rule requiring `getReportStats` to be defined below because the next two statements\n\t// depend on `getReportStats` to have been called.\n\t// eslint-disable-next-line @wordpress/no-unused-vars-before-return\n\tconst primary = getReportStats( endpoint, primaryQuery );\n\n\tif ( isReportStatsRequesting( endpoint, primaryQuery ) ) {\n\t\treturn { ...response, isRequesting: true };\n\t} else if ( getReportStatsError( endpoint, primaryQuery ) ) {\n\t\treturn { ...response, isError: true };\n\t}\n\n\tconst primaryTotals =\n\t\t( primary && primary.data && primary.data.totals ) || null;\n\n\tconst secondaryQuery = getRequestQuery( {\n\t\t...options,\n\t\tdataType: 'secondary',\n\t} );\n\n\t// Disable eslint rule requiring `getReportStats` to be defined below because the next two statements\n\t// depend on `getReportStats` to have been called.\n\t// eslint-disable-next-line @wordpress/no-unused-vars-before-return\n\tconst secondary = getReportStats( endpoint, secondaryQuery );\n\n\tif ( isReportStatsRequesting( endpoint, secondaryQuery ) ) {\n\t\treturn { ...response, isRequesting: true };\n\t} else if ( getReportStatsError( endpoint, secondaryQuery ) ) {\n\t\treturn { ...response, isError: true };\n\t}\n\n\tconst secondaryTotals =\n\t\t( secondary && secondary.data && secondary.data.totals ) || null;\n\n\treturn {\n\t\t...response,\n\t\ttotals: { primary: primaryTotals, secondary: secondaryTotals },\n\t};\n}\n\n/**\n * Returns all of the data needed to render a chart with summary numbers on a report page.\n *\n * @param  {Object} options           arguments\n * @param  {string} options.endpoint  Report API Endpoint\n * @param  {string} options.dataType  'primary' or 'secondary'\n * @param  {Object} options.query     Query parameters in the url\n * @param  {Object} options.select    Instance of @wordpress/select\n * @param  {Array}  options.limitBy   Properties used to limit the results. It will be used in the API call to send the IDs.\n * @param  {string}  options.defaultDateRange   User specified default date range.\n * @return {Object}  Object containing API request information (response, fetching, and error details)\n */\nexport function getReportChartData( options ) {\n\tconst { endpoint, select } = options;\n\tconst {\n\t\tgetReportStats,\n\t\tgetReportStatsError,\n\t\tisReportStatsRequesting,\n\t} = select( 'wc-api' );\n\n\tconst response = {\n\t\tisEmpty: false,\n\t\tisError: false,\n\t\tisRequesting: false,\n\t\tdata: {\n\t\t\ttotals: {},\n\t\t\tintervals: [],\n\t\t},\n\t};\n\n\tconst requestQuery = getRequestQuery( options );\n\t// Disable eslint rule requiring `stats` to be defined below because the next two if statements\n\t// depend on `getReportStats` to have been called.\n\t// eslint-disable-next-line @wordpress/no-unused-vars-before-return\n\tconst stats = getReportStats( endpoint, requestQuery );\n\n\tif ( isReportStatsRequesting( endpoint, requestQuery ) ) {\n\t\treturn { ...response, isRequesting: true };\n\t}\n\n\tif ( getReportStatsError( endpoint, requestQuery ) ) {\n\t\treturn { ...response, isError: true };\n\t}\n\n\tif ( isReportDataEmpty( stats, endpoint ) ) {\n\t\treturn { ...response, isEmpty: true };\n\t}\n\n\tconst totals = ( stats && stats.data && stats.data.totals ) || null;\n\tlet intervals = ( stats && stats.data && stats.data.intervals ) || [];\n\n\t// If we have more than 100 results for this time period,\n\t// we need to make additional requests to complete the response.\n\tif ( stats.totalResults > MAX_PER_PAGE ) {\n\t\tlet isFetching = true;\n\t\tlet isError = false;\n\t\tconst pagedData = [];\n\t\tconst totalPages = Math.ceil( stats.totalResults / MAX_PER_PAGE );\n\t\tlet pagesFetched = 1;\n\n\t\tfor ( let i = 2; i <= totalPages; i++ ) {\n\t\t\tconst nextQuery = { ...requestQuery, page: i };\n\t\t\tconst _data = getReportStats( endpoint, nextQuery );\n\t\t\tif ( isReportStatsRequesting( endpoint, nextQuery ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif ( getReportStatsError( endpoint, nextQuery ) ) {\n\t\t\t\tisError = true;\n\t\t\t\tisFetching = false;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tpagedData.push( _data );\n\t\t\tpagesFetched++;\n\n\t\t\tif ( pagesFetched === totalPages ) {\n\t\t\t\tisFetching = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif ( isFetching ) {\n\t\t\treturn { ...response, isRequesting: true };\n\t\t} else if ( isError ) {\n\t\t\treturn { ...response, isError: true };\n\t\t}\n\n\t\tforEach( pagedData, function( _data ) {\n\t\t\tintervals = intervals.concat( _data.data.intervals );\n\t\t} );\n\t}\n\n\treturn { ...response, data: { totals, intervals } };\n}\n\n/**\n * Returns a formatting function or string to be used by d3-format\n *\n * @param  {string} type Type of number, 'currency', 'number', 'percent', 'average'\n * @param  {Function} formatCurrency format currency function\n * @return {string|Function}  returns a number format based on the type or an overriding formatting function\n */\nexport function getTooltipValueFormat( type, formatCurrency ) {\n\tswitch ( type ) {\n\t\tcase 'currency':\n\t\t\treturn formatCurrency;\n\t\tcase 'percent':\n\t\t\treturn '.0%';\n\t\tcase 'number':\n\t\t\treturn ',';\n\t\tcase 'average':\n\t\t\treturn ',.2r';\n\t\tdefault:\n\t\t\treturn ',';\n\t}\n}\n\n/**\n * Returns query needed for a request to populate a table.\n *\n * @param  {Object} options              arguments\n * @param  {Object} options.query        Query parameters in the url\n * @param  {Object} options.tableQuery   Query parameters specific for that endpoint\n * @param  {string} options.defaultDateRange   User specified default date range.\n * @return {Object} Object    Table data response\n */\nexport function getReportTableQuery( options ) {\n\tconst { query, tableQuery = {} } = options;\n\tconst filterQuery = getFilterQuery( options );\n\tconst datesFromQuery = getCurrentDates( query, options.defaultDateRange );\n\n\tconst noIntervals = includes( noIntervalEndpoints, options.endpoint );\n\n\treturn {\n\t\torderby: query.orderby || 'date',\n\t\torder: query.order || 'desc',\n\t\tafter: noIntervals\n\t\t\t? undefined\n\t\t\t: appendTimestamp( datesFromQuery.primary.after, 'start' ),\n\t\tbefore: noIntervals\n\t\t\t? undefined\n\t\t\t: appendTimestamp( datesFromQuery.primary.before, 'end' ),\n\t\tpage: query.paged || 1,\n\t\tper_page: query.per_page || QUERY_DEFAULTS.pageSize,\n\t\t...filterQuery,\n\t\t...tableQuery,\n\t};\n}\n\n/**\n * Returns table data needed to render a report page.\n *\n * @param  {Object} options                arguments\n * @param  {string} options.endpoint       Report API Endpoint\n * @param  {Object} options.query          Query parameters in the url\n * @param  {Object} options.select         Instance of @wordpress/select\n * @param  {Object} options.tableQuery     Query parameters specific for that endpoint\n * @param  {string}  options.defaultDateRange   User specified default date range.\n * @return {Object} Object    Table data response\n */\nexport function getReportTableData( options ) {\n\tconst { endpoint, select } = options;\n\tconst {\n\t\tgetReportItems,\n\t\tgetReportItemsError,\n\t\tisReportItemsRequesting,\n\t} = select( 'wc-api' );\n\n\tconst tableQuery = reportsUtils.getReportTableQuery( options );\n\tconst response = {\n\t\tquery: tableQuery,\n\t\tisRequesting: false,\n\t\tisError: false,\n\t\titems: {\n\t\t\tdata: [],\n\t\t\ttotalResults: 0,\n\t\t},\n\t};\n\n\t// Disable eslint rule requiring `items` to be defined below because the next two if statements\n\t// depend on `getReportItems` to have been called.\n\t// eslint-disable-next-line @wordpress/no-unused-vars-before-return\n\tconst items = getReportItems( endpoint, tableQuery );\n\n\tif ( isReportItemsRequesting( endpoint, tableQuery ) ) {\n\t\treturn { ...response, isRequesting: true };\n\t} else if ( getReportItemsError( endpoint, tableQuery ) ) {\n\t\treturn { ...response, isError: true };\n\t}\n\n\treturn { ...response, items };\n}\n"],"sourceRoot":""}