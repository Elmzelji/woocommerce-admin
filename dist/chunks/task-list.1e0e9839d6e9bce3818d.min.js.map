{"version":3,"sources":["webpack://wc.[modulename]/./client/dashboard/components/cart-modal.js","webpack://wc.[modulename]/./client/dashboard/components/connect/index.js","webpack://wc.[modulename]/./client/dashboard/components/settings/general/store-address.js","webpack://wc.[modulename]/./client/lib/in-app-purchase.js","webpack://wc.[modulename]/./client/lib/sanitize-html/index.js","webpack://wc.[modulename]/./client/task-list/index.js","webpack://wc.[modulename]/./client/task-list/tasks.js","webpack://wc.[modulename]/./client/task-list/tasks/appearance.js","webpack://wc.[modulename]/./client/task-list/tasks/payments/index.js","webpack://wc.[modulename]/./client/task-list/tasks/products.js","webpack://wc.[modulename]/./client/task-list/tasks/shipping/index.js","webpack://wc.[modulename]/./client/task-list/tasks/shipping/rates.js","webpack://wc.[modulename]/./client/task-list/tasks/steps/location.js","webpack://wc.[modulename]/./client/task-list/tasks/tax.js"],"names":["CartModal","props","state","purchaseNowButtonBusy","purchaseLaterButtonBusy","productIds","onClickPurchaseNow","setState","length","recordEvent","product_ids","purchase_install","url","getInAppPurchaseUrl","join","window","location","onClickPurchaseLater","onClose","getSetting","productTypes","themes","listItems","forEach","productId","productInfo","find","productType","product","push","title","label","content","description","themeInfo","theme","id","sprintf","__","decodeEntities","price","sanitizeHTML","excerpt","renderProducts","Component","compose","withSelect","select","PLUGINS_STORE_NAME","getInstalledPlugins","ONBOARDING_STORE_NAME","getProfileItems","profileItems","installedPlugins","getProductIdsForCart","Connect","isConnecting","connectJetpack","bind","setIsPending","prevProps","createNotice","error","isRequesting","onError","jetpackConnectUrl","onConnect","hasErrors","onSkip","skipText","reload","propTypes","PropTypes","func","isRequired","string","bool","redirectUrl","defaultProps","getJetpackConnectUrl","isPluginsRequesting","getPluginsError","queryArgs","redirect_url","href","withDispatch","dispatch","countries","validateStoreAddress","values","errors","addressLine1","countryState","city","postCode","getCountryStateOptions","countryStateOptions","reduce","acc","country","states","key","code","name","countryStates","map","useGetCountryStateAutofill","options","setValue","useState","autofillCountry","setAutofillCountry","autofillState","setAutofillState","useEffect","filteredOptions","countrySearch","RegExp","escapeRegExp","filter","option","test","stateSearch","replace","countryKeyOptions","stateKeyOptions","event","target","value","StoreAddress","getInputProps","useMemo","countryStateAutofill","className","pathname","search","connectNonce","addQueryArgs","ALLOWED_TAGS","ALLOWED_ATTR","html","__html","sanitize","TaskDashboard","isCartModalOpen","document","body","classList","add","recordTaskView","recordTaskListView","possiblyCompleteTaskList","possiblyTrackCompletedTasks","query","prevQuery","prevTask","task","documentElement","scrollTop","isTaskListComplete","updateOptions","getIncompleteTasks","woocommerce_task_list_complete","getVisibleTasks","completed","getAllTasks","visible","trackedCompletedTasks","completedTaskKeys","getCompletedTaskKeys","xor","woocommerce_task_list_tracked_completed_tasks","dismissedTasks","actions","onClick","undoDismissTask","task_name","woocommerce_task_list_dismissed_tasks","updatedDismissedTasks","remove","countryCode","taskListPayments","activePlugins","installAndActivatePlugins","isJetpackConnected","toggleCartModal","includes","taskName","recordTaskViewEvent","getCurrentTask","tasks","number_tasks","store_connected","wccom_connected","action","woocommerce_task_list_prompt_shown","woocommerce_task_list_hidden","currentTask","s","hideTaskCard","listTasks","classNames","before","check","time","after","isDismissable","stopPropagation","dismissTask","chevronRight","updateQueryString","progressBarClass","cloneElement","container","renderMenu","OPTIONS_STORE_NAME","getOption","SETTINGS_STORE_NAME","getSettings","getActivePlugins","payments","general","generalSettings","getCountryCode","woocommerce_default_country","wcs_installed","wcs_active","jetpack_installed","jetpack_active","jetpack_connected","hasPhysicalProducts","hasProducts","isAppearanceComplete","isTaxComplete","shippingZonesCount","groupedProducts","getCategorizedOnboardingProducts","products","remainingProducts","uniqueItemsList","paymentsCompleted","Boolean","paymentsSkipped","skipped","woocommercePaymentsInstalled","indexOf","profilerCompleted","product_types","purchaseAndInstallText","itemName","itemType","type","purchaseAndInstallFormat","getHistory","getNewPath","Promise","resolve","reject","installActivateAndConnectWcpay","wcAdminFeatures","wcpay","applyFilters","Appearance","hasHomepage","stepVisibility","homepage","import","isDirty","isPending","logo","stepIndex","isUpdatingLogo","isUpdatingNotice","storeNoticeText","demoStoreNotice","completeStep","createHomepage","importProducts","updateLogo","updateNotice","themeMods","custom_logo","wp","media","attachment","fetch","then","logoUrl","get","nextStep","getSteps","apiFetch","path","WC_ADMIN_NAMESPACE","method","result","failed","setSetting","catch","message","create_homepage","response","status","edit_post_link","queueRecordEvent","stylesheet","updatedThemeMods","update","success","added_text","woocommerce_task_list_appearance_complete","woocommerce_demo_store","woocommerce_demo_store_notice","steps","image","step","currentStep","Payments","arguments","methods","enabledMethods","isEnabled","busyMethod","recommendedMethod","getRecommendedMethod","completeTask","markConfigured","skipTask","m","woocommerce_task_list_payments","timestamp","Math","floor","Date","now","configured","isConfigured","payment_method","currentMethod","getCurrentMethod","plugins","pluginsToInstall","pluginNamesString","pluginSlug","pluginNames","isComplete","enabled","optionName","selected","requesting","hasEnabledMethods","Object","keys","installStep","getInstallStep","hasCbdIndustry","classes","classnames","isRecommended","showRecommendedRibbon","showRecommendedPill","handleClick","toggleMethod","e","isOptionsUpdating","optionNames","getPaymentMethods","subTasks","getAdminLink","Products","Shipping","initialState","shippingZones","reset","countryName","zones","hasCountryZone","all","zone","toggleable","locations","countryLocation","data","reverse","prevState","settings","storeAddress","woocommerce_store_address","defaultCountry","storePostCode","woocommerce_store_postcode","fetchShippingZones","isCompleteAddress","currentStepIndex","findIndex","difference","pluginsToActivate","getPluginsToActivate","requiresJetpackConnection","interpolateComponents","mixedString","components","link","install","isUpdateSettingsRequesting","c","updateAndPersistSettingsForGroup","ShippingRates","updateShippingZones","Array","isArray","method_id","instance_id","restOfTheWorld","shippingCost","parseFloat","shippingMethods","getShippingMethods","methodType","shippingMethod","disableShippingMethods","methodsToDisable","cost","shipping_cost","rest_world","onComplete","context","getCurrencyConfig","symbolPosition","symbol","rate","formatDecimalString","currencyString","getFormattedRate","rates","field","endsWith","buttonText","getInitialValues","validate","handleSubmit","setTouched","renderInputPrefix","renderInputSuffix","array","contextType","CurrencyContext","StoreLocation","onSubmit","isSettingsError","woocommerce_store_address_2","addressLine2","woocommerce_store_city","storeAddress2","storeCity","storePostcode","isSettingsRequesting","Tax","hasCompleteAddress","cachedPluginsToActivate","isTaxJarSupported","automatedTaxSupportedCountries","taxJarActivated","woocommerce_calc_taxes","redirectToTaxSettings","createNoticesFromResponse","isEnabling","taxSettings","tax","wc_connect_taxes_enabled","tosAccepted","install_extensions","woocommerce_setup_jetpack_opted_in","manuallyConfigureTaxRates","connect","isResolving","shouldShowSuccessScreen","strong","setup_automatically","updateAutomatedTax","connectOptions","tos_accepted"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;AAGA;AACA;AACA;AAEA;;;;AAGA;AACA;AACA;AACA;;IAEMA,S;;;;;AACL,qBAAaC,KAAb,EAAqB;AAAA;;AAAA;;AACpB,8BAAOA,KAAP;AACA,UAAKC,KAAL,GAAa;AACZC,2BAAqB,EAAE,KADX;AAEZC,6BAAuB,EAAE;AAFb,KAAb;AAFoB;AAMpB;;;;yCAEoB;AAAA,wBACuB,KAAKH,KAD5B;AAAA,UACZI,UADY,eACZA,UADY;AAAA,UACAC,kBADA,eACAA,kBADA;AAEpB,WAAKC,QAAL,CAAe;AAAEJ,6BAAqB,EAAE;AAAzB,OAAf;;AACA,UAAK,CAAEE,UAAU,CAACG,MAAlB,EAA2B;AAC1B;AACA;;AAEDC,qEAAW,CAAE,iCAAF,EAAqC;AAC/CC,mBAAW,EAAEL,UADkC;AAE/CM,wBAAgB,EAAE;AAF6B,OAArC,CAAX;AAKA,UAAMC,GAAG,GAAGC,gFAAmB,CAAE,8BAAF,EAAkC;AAChE,8BAAsBR,UAAU,CAACS,IAAX,CAAiB,GAAjB;AAD0C,OAAlC,CAA/B;;AAIA,UAAKR,kBAAL,EAA0B;AACzBA,0BAAkB,CAAEM,GAAF,CAAlB;AACA;AACA;;AAEDG,YAAM,CAACC,QAAP,GAAkBJ,GAAlB;AACA;;;2CAEsB;AAAA,UACdP,UADc,GACC,KAAKJ,KADN,CACdI,UADc;AAGtBI,qEAAW,CAAE,iCAAF,EAAqC;AAC/CC,mBAAW,EAAEL,UADkC;AAE/CM,wBAAgB,EAAE;AAF6B,OAArC,CAAX;AAKA,WAAKJ,QAAL,CAAe;AAAEH,+BAAuB,EAAE;AAA3B,OAAf;AACA,WAAKH,KAAL,CAAWgB,oBAAX;AACA;;;8BAES;AAAA,yBACuB,KAAKhB,KAD5B;AAAA,UACDiB,OADC,gBACDA,OADC;AAAA,UACQb,UADR,gBACQA,UADR;AAGTI,qEAAW,CAAE,iCAAF,EAAqC;AAC/CC,mBAAW,EAAEL,UADkC;AAE/CM,wBAAgB,EAAE;AAF6B,OAArC,CAAX;AAKAO,aAAO;AACP;;;qCAEgB;AAAA,UACRb,UADQ,GACO,KAAKJ,KADZ,CACRI,UADQ;;AAAA,wBAE2Bc,kFAAU,CACpD,YADoD,EAEpD,EAFoD,CAFrC;AAAA,8CAERC,YAFQ;AAAA,UAERA,YAFQ,sCAEO,EAFP;AAAA,2CAEWC,MAFX;AAAA,UAEWA,MAFX,mCAEoB,EAFpB;;AAMhB,UAAMC,SAAS,GAAG,EAAlB;AAEAjB,gBAAU,CAACkB,OAAX,CAAoB,UAAEC,SAAF,EAAiB;AACpC,YAAMC,WAAW,GAAGC,mDAAI,CAAEN,YAAF,EAAgB,UAAEO,WAAF,EAAmB;AAC1D,iBAAOA,WAAW,CAACC,OAAZ,KAAwBJ,SAA/B;AACA,SAFuB,CAAxB;;AAIA,YAAKC,WAAL,EAAmB;AAClBH,mBAAS,CAACO,IAAV,CAAgB;AACfC,iBAAK,EAAEL,WAAW,CAACM,KADJ;AAEfC,mBAAO,EAAEP,WAAW,CAACQ;AAFN,WAAhB;AAIA;;AAED,YAAMC,SAAS,GAAGR,mDAAI,CAAEL,MAAF,EAAU,UAAEc,KAAF,EAAa;AAC5C,iBAAOA,KAAK,CAACC,EAAN,KAAaZ,SAApB;AACA,SAFqB,CAAtB;;AAIA,YAAKU,SAAL,EAAiB;AAChBZ,mBAAS,CAACO,IAAV,CAAgB;AACfC,iBAAK,EAAEO,+DAAO,CACbC,0DAAE,CAAE,kBAAF,EAAsB,mBAAtB,CADW,EAEbJ,SAAS,CAACJ,KAFG,EAGbS,gFAAc,CAAEL,SAAS,CAACM,KAAZ,CAHD,CADC;AAMfR,mBAAO,EACN;AACC,qCAAuB,EAAGS,kEAAY,CACrCP,SAAS,CAACQ,OAD2B;AADvC;AAPc,WAAhB;AAcA;AACD,OAhCD;AAkCA,aAAO,yEAAC,6DAAD;AAAM,aAAK,EAAGpB;AAAd,QAAP;AACA;;;6BAEQ;AAAA;;AAAA,wBACmD,KAAKpB,KADxD;AAAA,UACAC,qBADA,eACAA,qBADA;AAAA,UACuBC,uBADvB,eACuBA,uBADvB;AAER,aACC,yEAAC,2DAAD;AACC,aAAK,EAAGkC,0DAAE,CACT,oEADS,EAET,mBAFS,CADX;AAKC,sBAAc,EAAG;AAAA,iBAAM,MAAI,CAACpB,OAAL,EAAN;AAAA,SALlB;AAMC,iBAAS,EAAC;AANX,SAQG,KAAKyB,cAAL,EARH,EAUC;AAAG,iBAAS,EAAC;AAAb,SACGL,0DAAE,CACH,qGADG,EAEH,mBAFG,CADL,CAVD,EAiBC;AAAK,iBAAS,EAAC;AAAf,SACC,yEAAC,4DAAD;AACC,cAAM,MADP;AAEC,cAAM,EAAGlC,uBAFV;AAGC,eAAO,EAAG;AAAA,iBAAM,MAAI,CAACa,oBAAL,EAAN;AAAA;AAHX,SAKGqB,0DAAE,CAAE,kBAAF,EAAsB,mBAAtB,CALL,CADD,EASC,yEAAC,4DAAD;AACC,iBAAS,MADV;AAEC,cAAM,EAAGnC,qBAFV;AAGC,eAAO,EAAG;AAAA,iBAAM,MAAI,CAACG,kBAAL,EAAN;AAAA;AAHX,SAKGgC,0DAAE,CAAE,wBAAF,EAA4B,mBAA5B,CALL,CATD,CAjBD,CADD;AAqCA;;;;EA5IsBM,4D;;AA+ITC,iIAAO,CACrBC,mEAAU,CAAE,UAAEC,MAAF,EAAc;AAAA,gBACOA,MAAM,CAAEC,qEAAF,CADb;AAAA,MACjBC,mBADiB,WACjBA,mBADiB;;AAAA,iBAEGF,MAAM,CAAEG,wEAAF,CAFT;AAAA,MAEjBC,eAFiB,YAEjBA,eAFiB;;AAGzB,MAAMC,YAAY,GAAGD,eAAe,EAApC;AACA,MAAME,gBAAgB,GAAGJ,mBAAmB,EAA5C;AACA,MAAM5C,UAAU,GAAGiD,6EAAoB,CACtCF,YADsC,EAEtC,KAFsC,EAGtCC,gBAHsC,CAAvC;AAMA,SAAO;AAAED,gBAAY,EAAZA,YAAF;AAAgB/C,cAAU,EAAVA;AAAhB,GAAP;AACA,CAZS,CADW,CAAP,CAcZL,SAdY,CAAf,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzKA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;AAGA;;IAEMuD,O;;;;;AACL,mBAAatD,KAAb,EAAqB;AAAA;;AAAA;;AACpB,8BAAOA,KAAP;AACA,UAAKC,KAAL,GAAa;AACZsD,kBAAY,EAAE;AADF,KAAb;AAIA,UAAKC,cAAL,GAAsB,MAAKA,cAAL,CAAoBC,IAApB,4FAAtB;AACAzD,SAAK,CAAC0D,YAAN,CAAoB,IAApB;AAPoB;AAQpB;;;;uCAEmBC,S,EAAY;AAAA,wBAO3B,KAAK3D,KAPsB;AAAA,UAE9B4D,YAF8B,eAE9BA,YAF8B;AAAA,UAG9BC,KAH8B,eAG9BA,KAH8B;AAAA,UAI9BC,YAJ8B,eAI9BA,YAJ8B;AAAA,UAK9BC,OAL8B,eAK9BA,OAL8B;AAAA,UAM9BL,YAN8B,eAM9BA,YAN8B;;AAS/B,UAAKC,SAAS,CAACG,YAAV,IAA0B,CAAEA,YAAjC,EAAgD;AAC/CJ,oBAAY,CAAE,KAAF,CAAZ;AACA;;AAED,UAAKG,KAAK,IAAIA,KAAK,KAAKF,SAAS,CAACE,KAAlC,EAA0C;AACzC,YAAKE,OAAL,EAAe;AACdA,iBAAO;AACP;;AACDH,oBAAY,CAAE,OAAF,EAAWC,KAAX,CAAZ;AACA;AACD;;;;;;;;;;;+BAGyC,KAAK7D,K,EAAtCgE,iB,gBAAAA,iB,EAAmBC,S,gBAAAA,S;AAE3B,qBAAK3D,QAAL,CACC;AACCiD,8BAAY,EAAE;AADf,iBADD,EAIC,YAAM;AACL,sBAAKU,SAAL,EAAiB;AAChBA,6BAAS;AACT;;AACDnD,wBAAM,CAACC,QAAP,GAAkBiD,iBAAlB;AACA,iBATF;;;;;;;;;;;;;;;;;;6BAaQ;AAAA,yBAC8C,KAAKhE,KADnD;AAAA,UACAkE,SADA,gBACAA,SADA;AAAA,UACWJ,YADX,gBACWA,YADX;AAAA,UACyBK,MADzB,gBACyBA,MADzB;AAAA,UACiCC,QADjC,gBACiCA,QADjC;AAGR,aACC,yEAAC,2DAAD,QACGF,SAAS,GACV,yEAAC,6DAAD;AACC,iBAAS,MADV;AAEC,eAAO,EAAG;AAAA,iBAAMpD,MAAM,CAACC,QAAP,CAAgBsD,MAAhB,EAAN;AAAA;AAFX,SAIGhC,0DAAE,CAAE,OAAF,EAAW,mBAAX,CAJL,CADU,GAQV,yEAAC,6DAAD;AACC,gBAAQ,EAAGyB,YADZ;AAEC,cAAM,EAAG,KAAK7D,KAAL,CAAWsD,YAFrB;AAGC,iBAAS,MAHV;AAIC,eAAO,EAAG,KAAKC;AAJhB,SAMGnB,0DAAE,CAAE,SAAF,EAAa,mBAAb,CANL,CATF,EAkBG8B,MAAM,IACP,yEAAC,6DAAD;AAAQ,eAAO,EAAGA;AAAlB,SACGC,QAAQ,IAAI/B,0DAAE,CAAE,WAAF,EAAe,mBAAf,CADjB,CAnBF,CADD;AA0BA;;;;EA7EoBM,4D;;AAgFtBW,OAAO,CAACgB,SAAR,GAAoB;AACnB;;;AAGAV,cAAY,EAAEW,kDAAS,CAACC,IAAV,CAAeC,UAJV;;AAKnB;;;AAGAZ,OAAK,EAAEU,kDAAS,CAACG,MARE;;AASnB;;;AAGAR,WAAS,EAAEK,kDAAS,CAACI,IAZF;;AAanB;;;AAGAb,cAAY,EAAES,kDAAS,CAACI,IAhBL;;AAiBnB;;;AAGAX,mBAAiB,EAAEO,kDAAS,CAACG,MApBV;;AAqBnB;;;AAGAT,WAAS,EAAEM,kDAAS,CAACC,IAxBF;;AAyBnB;;;AAGAT,SAAO,EAAEQ,kDAAS,CAACC,IA5BA;;AA6BnB;;;AAGAL,QAAM,EAAEI,kDAAS,CAACC,IAhCC;;AAiCnB;;;AAGAI,aAAW,EAAEL,kDAAS,CAACG,MApCJ;;AAqCnB;;;AAGAN,UAAQ,EAAEG,kDAAS,CAACG,MAxCD;;AAyCnB;;;AAGAhB,cAAY,EAAEa,kDAAS,CAACC;AA5CL,CAApB;AA+CAlB,OAAO,CAACuB,YAAR,GAAuB;AACtBnB,cAAY,EAAE,wBAAM,CAAE;AADA,CAAvB;AAIed,kIAAO,CACrBC,mEAAU,CAAE,UAAEC,MAAF,EAAU9C,KAAV,EAAqB;AAAA,gBAK5B8C,MAAM,CAAEC,qEAAF,CALsB;AAAA,MAE/B+B,oBAF+B,WAE/BA,oBAF+B;AAAA,MAG/BC,mBAH+B,WAG/BA,mBAH+B;AAAA,MAI/BC,eAJ+B,WAI/BA,eAJ+B;;AAOhC,MAAMC,SAAS,GAAG;AACjBC,gBAAY,EAAElF,KAAK,CAAC4E,WAAN,IAAqB9D,MAAM,CAACC,QAAP,CAAgBoE;AADlC,GAAlB;AAGA,MAAMrB,YAAY,GAAGiB,mBAAmB,CAAE,sBAAF,CAAxC;AACA,MAAMlB,KAAK,GAAGmB,eAAe,CAAE,sBAAF,CAAf,IAA6C,EAA3D;AACA,MAAMhB,iBAAiB,GAAGc,oBAAoB,CAAEG,SAAF,CAA9C;AAEA,SAAO;AACNpB,SAAK,EAALA,KADM;AAENC,gBAAY,EAAZA,YAFM;AAGNE,qBAAiB,EAAjBA;AAHM,GAAP;AAKA,CAnBS,CADW,EAqBrBoB,qEAAY,CAAE,UAAEC,QAAF,EAAgB;AAAA,kBACJA,QAAQ,CAAE,cAAF,CADJ;AAAA,MACrBzB,YADqB,aACrBA,YADqB;;AAG7B,SAAO;AACNA,gBAAY,EAAZA;AADM,GAAP;AAGA,CANW,CArBS,CAAP,CA4BZN,OA5BY,CAAf,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClJA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;AAGA;;kBAEsBpC,iFAAU,CAAE,eAAF,EAAmB;AAAEoE,WAAS,EAAE;AAAb,CAAnB,C;IAAxBA,S,eAAAA,S;AACR;;;;;;;;AAMO,SAASC,oBAAT,CAA+BC,MAA/B,EAAwC;AAC9C,MAAMC,MAAM,GAAG,EAAf;;AAEA,MAAK,CAAED,MAAM,CAACE,YAAP,CAAoBnF,MAA3B,EAAoC;AACnCkF,UAAM,CAACC,YAAP,GAAsBrD,0DAAE,CACvB,uBADuB,EAEvB,mBAFuB,CAAxB;AAIA;;AACD,MAAK,CAAEmD,MAAM,CAACG,YAAP,CAAoBpF,MAA3B,EAAoC;AACnCkF,UAAM,CAACE,YAAP,GAAsBtD,0DAAE,CACvB,kCADuB,EAEvB,mBAFuB,CAAxB;AAIA;;AACD,MAAK,CAAEmD,MAAM,CAACI,IAAP,CAAYrF,MAAnB,EAA4B;AAC3BkF,UAAM,CAACG,IAAP,GAAcvD,0DAAE,CAAE,mBAAF,EAAuB,mBAAvB,CAAhB;AACA;;AACD,MAAK,CAAEmD,MAAM,CAACK,QAAP,CAAgBtF,MAAvB,EAAgC;AAC/BkF,UAAM,CAACI,QAAP,GAAkBxD,0DAAE,CAAE,wBAAF,EAA4B,mBAA5B,CAApB;AACA;;AAED,SAAOoD,MAAP;AACA;AAED;;;;;;AAKO,SAASK,sBAAT,GAAkC;AACxC,MAAMC,mBAAmB,GAAGT,SAAS,CAACU,MAAV,CAAkB,UAAEC,GAAF,EAAOC,OAAP,EAAoB;AACjE,QAAK,CAAEA,OAAO,CAACC,MAAR,CAAe5F,MAAtB,EAA+B;AAC9B0F,SAAG,CAACrE,IAAJ,CAAU;AACTwE,WAAG,EAAEF,OAAO,CAACG,IADJ;AAETvE,aAAK,EAAEQ,+EAAc,CAAE4D,OAAO,CAACI,IAAV;AAFZ,OAAV;AAKA,aAAOL,GAAP;AACA;;AAED,QAAMM,aAAa,GAAGL,OAAO,CAACC,MAAR,CAAeK,GAAf,CAAoB,UAAEvG,KAAF,EAAa;AACtD,aAAO;AACNmG,WAAG,EAAEF,OAAO,CAACG,IAAR,GAAe,GAAf,GAAqBpG,KAAK,CAACoG,IAD1B;AAENvE,aAAK,EACJQ,+EAAc,CAAE4D,OAAO,CAACI,IAAV,CAAd,GACA,KADA,GAEAhE,+EAAc,CAAErC,KAAK,CAACqG,IAAR;AALT,OAAP;AAOA,KARqB,CAAtB;AAUAL,OAAG,CAACrE,IAAJ,OAAAqE,GAAG,kFAAUM,aAAV,EAAH;AAEA,WAAON,GAAP;AACA,GAvB2B,EAuBzB,EAvByB,CAA5B;AAyBA,SAAOF,mBAAP;AACA;AAED;;;;;;;;;AAQO,SAASU,0BAAT,CAAqCC,OAArC,EAA8Cf,YAA9C,EAA4DgB,QAA5D,EAAuE;AAAA,kBAC7BC,sDAAQ,CAAE,EAAF,CADqB;AAAA;AAAA,MACrEC,eADqE;AAAA,MACpDC,kBADoD;;AAAA,mBAEjCF,sDAAQ,CAAE,EAAF,CAFyB;AAAA;AAAA,MAErEG,aAFqE;AAAA,MAEtDC,gBAFsD;;AAI7EC,yDAAS,CAAE,YAAM;AAChB,QAAIC,eAAe,GAAG,EAAtB;AACA,QAAMC,aAAa,GAAG,IAAIC,MAAJ,CACrBC,2DAAY,CAAER,eAAF,CADS,EAErB,GAFqB,CAAtB;;AAIA,QAAKE,aAAa,CAACxG,MAAd,IAAwBsG,eAAe,CAACtG,MAA7C,EAAsD;AACrD2G,qBAAe,GAAGR,OAAO,CAACY,MAAR,CAAgB,UAAEC,MAAF;AAAA,eACjCJ,aAAa,CAACK,IAAd,CAAoBD,MAAM,CAACzF,KAA3B,CADiC;AAAA,OAAhB,CAAlB;AAGA;;AACD,QAAK+E,eAAe,CAACtG,MAAhB,IAA0BwG,aAAa,CAACxG,MAA7C,EAAsD;AACrD,UAAMkH,WAAW,GAAG,IAAIL,MAAJ,CACnBC,2DAAY,CAAEN,aAAa,CAACW,OAAd,CAAuB,KAAvB,EAA8B,EAA9B,CAAF,CADO,EAEnB,GAFmB,CAApB;AAIAR,qBAAe,GAAGA,eAAe,CAACI,MAAhB,CAAwB,UAAEC,MAAF;AAAA,eACzCE,WAAW,CAACD,IAAZ,CACCD,MAAM,CAACzF,KAAP,CAAa4F,OAAb,CAAsB,GAAtB,EAA2B,EAA3B,EAAgCA,OAAhC,CAAyC,KAAzC,EAAgD,EAAhD,CADD,CADyC;AAAA,OAAxB,CAAlB;;AAMA,UAAKR,eAAe,CAAC3G,MAAhB,GAAyB,CAA9B,EAAkC;AACjC,YAAIoH,iBAAiB,GAAG,EAAxB;AACAA,yBAAiB,GAAGT,eAAe,CAACI,MAAhB,CAAwB,UAAEC,MAAF;AAAA,iBAC3CJ,aAAa,CAACK,IAAd,CAAoBD,MAAM,CAACnB,GAA3B,CAD2C;AAAA,SAAxB,CAApB;;AAIA,YAAKuB,iBAAiB,CAACpH,MAAlB,GAA2B,CAAhC,EAAoC;AACnC2G,yBAAe,GAAGS,iBAAlB;AACA;AACD;;AAED,UAAKT,eAAe,CAAC3G,MAAhB,GAAyB,CAA9B,EAAkC;AACjC,YAAIqH,eAAe,GAAG,EAAtB;AACAA,uBAAe,GAAGV,eAAe,CAACI,MAAhB,CAAwB,UAAEC,MAAF;AAAA,iBACzCE,WAAW,CAACD,IAAZ,CAAkBD,MAAM,CAACnB,GAAzB,CADyC;AAAA,SAAxB,CAAlB;;AAIA,YAAKwB,eAAe,CAACrH,MAAhB,KAA2B,CAAhC,EAAoC;AACnC2G,yBAAe,GAAGU,eAAlB;AACA;AACD;AACD;;AAED,QACCV,eAAe,CAAC3G,MAAhB,KAA2B,CAA3B,IACAoF,YAAY,KAAKuB,eAAe,CAAE,CAAF,CAAf,CAAqBd,GAFvC,EAGE;AACDO,cAAQ,CAAE,cAAF,EAAkBO,eAAe,CAAE,CAAF,CAAf,CAAqBd,GAAvC,CAAR;AACA;AACD,GAnDQ,EAmDN,CAAES,eAAF,EAAmBE,aAAnB,CAnDM,CAAT;AAqDA,SACC,yEAAC,2DAAD,QACC;AACC,YAAQ,EAAG,kBAAEc,KAAF;AAAA,aACVf,kBAAkB,CAAEe,KAAK,CAACC,MAAN,CAAaC,KAAf,CADR;AAAA,KADZ;AAIC,SAAK,EAAGlB,eAJT;AAKC,QAAI,EAAC,SALN;AAMC,QAAI,EAAC,MANN;AAOC,aAAS,EAAC,4CAPX;AAQC,YAAQ,EAAC,IARV;AASC,gBAAY,EAAC;AATd,IADD,EAaC;AACC,YAAQ,EAAG,kBAAEgB,KAAF;AAAA,aAAab,gBAAgB,CAAEa,KAAK,CAACC,MAAN,CAAaC,KAAf,CAA7B;AAAA,KADZ;AAEC,SAAK,EAAGhB,aAFT;AAGC,QAAI,EAAC,OAHN;AAIC,QAAI,EAAC,MAJN;AAKC,aAAS,EAAC,4CALX;AAMC,YAAQ,EAAC,IANV;AAOC,gBAAY,EAAC;AAPd,IAbD,CADD;AAyBA;AAED;;;;;;;AAMO,SAASiB,YAAT,CAAuBhI,KAAvB,EAA+B;AAAA,MAC7BiI,aAD6B,GACDjI,KADC,CAC7BiI,aAD6B;AAAA,MACdtB,QADc,GACD3G,KADC,CACd2G,QADc;AAErC,MAAMZ,mBAAmB,GAAGmC,qDAAO,CAAE;AAAA,WAAMpC,sBAAsB,EAA5B;AAAA,GAAF,EAAkC,EAAlC,CAAnC;AACA,MAAMqC,oBAAoB,GAAG1B,0BAA0B,CACtDV,mBADsD,EAEtDkC,aAAa,CAAE,cAAF,CAAb,CAAgCF,KAFsB,EAGtDpB,QAHsD,CAAvD;AAMA,SACC;AAAK,aAAS,EAAC;AAAf,KACC,yEAAC,mEAAD;AACC,SAAK,EAAGtE,0DAAE,CAAE,gBAAF,EAAoB,mBAApB,CADX;AAEC,YAAQ,MAFT;AAGC,gBAAY,EAAC;AAHd,KAIM4F,aAAa,CAAE,cAAF,CAJnB,EADD,EAQC,yEAAC,mEAAD;AACC,SAAK,EAAG5F,0DAAE,CAAE,2BAAF,EAA+B,mBAA/B,CADX;AAEC,YAAQ,MAFT;AAGC,gBAAY,EAAC;AAHd,KAIM4F,aAAa,CAAE,cAAF,CAJnB,EARD,EAeC,yEAAC,qEAAD;AACC,SAAK,EAAG5F,0DAAE,CAAE,kBAAF,EAAsB,mBAAtB,CADX;AAEC,YAAQ,MAFT;AAGC,WAAO,EAAG0D,mBAHX;AAIC,0BAAsB,EAAG,KAJ1B;AAKC,kBAAc,MALf;AAMC,gBAAY;AANb,KAOMkC,aAAa,CAAE,cAAF,CAPnB;AAQC,oBAAgB,EAAGA,aAAa,CAAE,cAAF,CAAb,CAAgCG;AARpD,MAUGD,oBAVH,CAfD,EA4BC,yEAAC,mEAAD;AACC,SAAK,EAAG9F,0DAAE,CAAE,MAAF,EAAU,mBAAV,CADX;AAEC,YAAQ;AAFT,KAGM4F,aAAa,CAAE,MAAF,CAHnB;AAIC,gBAAY,EAAC;AAJd,KA5BD,EAmCC,yEAAC,mEAAD;AACC,SAAK,EAAG5F,0DAAE,CAAE,WAAF,EAAe,mBAAf,CADX;AAEC,YAAQ,MAFT;AAGC,gBAAY,EAAC;AAHd,KAIM4F,aAAa,CAAE,UAAF,CAJnB,EAnCD,CADD;AA4CA,C;;;;;;;;;;;;;;;;;;;;;;;;;ACxOD;;;AAGA;AAEA;;;;AAGA;AAEA;;;;;;;;AAOO,IAAMrH,mBAAmB,GAAG,SAAtBA,mBAAsB,CAAED,GAAF,EAA2B;AAAA,MAApBsE,SAAoB,uEAAR,EAAQ;AAAA,yBAChCnE,MAAM,CAACC,QADyB;AAAA,MACrDsH,QADqD,oBACrDA,QADqD;AAAA,MAC3CC,MAD2C,oBAC3CA,MAD2C;AAE7D,MAAMC,YAAY,GAAGrH,iFAAU,CAAE,cAAF,EAAkB,EAAlB,CAA/B;AACA+D,WAAS;AACR,kBAAc/D,iFAAU,CAAE,SAAF,CADhB;AAER;AACA,kBAAcmH,QAAQ,GAAGC,MAHjB;AAIR,yBAAqBpH,iFAAU,CAAE,WAAF,CAJvB;AAKR,2BAAuBqH;AALf,KAMLtD,SANK,CAAT;AASA,SAAOuD,mEAAY,CAAE7H,GAAF,EAAOsE,SAAP,CAAnB;AACA,CAbM,C;;;;;;;;;;;;ACjBP;AAAA;AAAA;AAAA;AAAA;AAAA;;;AAGA;AAEO,IAAMwD,YAAY,GAAG,CAAE,GAAF,EAAO,GAAP,EAAY,IAAZ,EAAkB,GAAlB,EAAuB,QAAvB,EAAiC,GAAjC,CAArB;AACA,IAAMC,YAAY,GAAG,CAAE,QAAF,EAAY,MAAZ,EAAoB,KAApB,EAA2B,MAA3B,EAAmC,UAAnC,CAArB;AAEQ,yEAAEC,IAAF,EAAY;AAC1B,SAAO;AACNC,UAAM,EAAEC,0DAAQ,CAAEF,IAAF,EAAQ;AAAEF,kBAAY,EAAZA,YAAF;AAAgBC,kBAAY,EAAZA;AAAhB,KAAR;AADV,GAAP;AAGA,CAJD,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACRA;;;AAGA;AACA;AACA;AACA;AACA;AAOA;AACA;AACA;AAEA;;;;AAGA;AACA;AACA;AAOA;;;;AAGA;AACA;AACA;AACA;AACA;;IAEMI,a;;;;;AACL,yBAAa9I,KAAb,EAAqB;AAAA;;AAAA;;AACpB,8BAAOA,KAAP;AACA,UAAKC,KAAL,GAAa;AACZ8I,qBAAe,EAAE;AADL,KAAb;AAFoB;AAKpB;;;;wCAEmB;AACnBC,cAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBC,GAAxB,CAA6B,wBAA7B;AACAH,cAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBC,GAAxB,CAA6B,kCAA7B;AAEA,WAAKC,cAAL;AACA,WAAKC,kBAAL;AACA,WAAKC,wBAAL;AACA,WAAKC,2BAAL;AACA;;;uCAEmB5F,S,EAAY;AAAA,UACvB6F,KADuB,GACb,KAAKxJ,KADQ,CACvBwJ,KADuB;AAAA,UAEhBC,SAFgB,GAEF9F,SAFE,CAEvB6F,KAFuB;AAAA,UAGjBE,QAHiB,GAGJD,SAHI,CAGvBE,IAHuB;AAAA,UAIvBA,IAJuB,GAIdH,KAJc,CAIvBG,IAJuB;;AAM/B,UAAKD,QAAQ,KAAKC,IAAlB,EAAyB;AACxB7I,cAAM,CAACkI,QAAP,CAAgBY,eAAhB,CAAgCC,SAAhC,GAA4C,CAA5C;AACA,aAAKT,cAAL;AACA;;AAED,WAAKE,wBAAL;AACA,WAAKC,2BAAL;AACA;;;+CAE0B;AAAA,wBACoB,KAAKvJ,KADzB;AAAA,UAClB8J,kBADkB,eAClBA,kBADkB;AAAA,UACEC,aADF,eACEA,aADF;;AAG1B,UAAK,CAAE,KAAKC,kBAAL,GAA0BzJ,MAA5B,IAAsC,CAAEuJ,kBAA7C,EAAkE;AACjEC,qBAAa,CAAE;AACdE,wCAA8B,EAAE;AADlB,SAAF,CAAb;AAGA;AACD;;;2CAEsB;AACtB,aAAO,KAAKC,eAAL,GACL5C,MADK,CACG,UAAEqC,IAAF;AAAA,eAAYA,IAAI,CAACQ,SAAjB;AAAA,OADH,EAEL3D,GAFK,CAEA,UAAEmD,IAAF;AAAA,eAAYA,IAAI,CAACvD,GAAjB;AAAA,OAFA,CAAP;AAGA;;;yCAEoB;AACpB,aAAO,KAAKgE,WAAL,GAAmB9C,MAAnB,CACN,UAAEqC,IAAF;AAAA,eAAYA,IAAI,CAACU,OAAL,IAAgB,CAAEV,IAAI,CAACQ,SAAnC;AAAA,OADM,CAAP;AAGA;;;kDAE6B;AAAA,yBACoB,KAAKnK,KADzB;AAAA,UACrBsK,qBADqB,gBACrBA,qBADqB;AAAA,UACEP,aADF,gBACEA,aADF;AAE7B,UAAMQ,iBAAiB,GAAG,KAAKC,oBAAL,EAA1B;;AAEA,UAAKC,mDAAG,CAAEH,qBAAF,EAAyBC,iBAAzB,CAAH,CAAgDhK,MAAhD,KAA2D,CAAhE,EAAoE;AACnEwJ,qBAAa,CAAE;AACdW,uDAA6C,EAAEH;AADjC,SAAF,CAAb;AAGA;AACD;;;gCAEYnE,G,EAAM;AAAA;;AAAA,yBACsC,KAAKpG,KAD3C;AAAA,UACV4D,YADU,gBACVA,YADU;AAAA,UACI+G,cADJ,gBACIA,cADJ;AAAA,UACoBZ,aADpB,gBACoBA,aADpB;AAGlBnG,kBAAY,CAAE,SAAF,EAAavB,0DAAE,CAAE,gBAAF,CAAf,EAAqC;AAChDuI,eAAO,EAAE,CACR;AACC9I,eAAK,EAAEO,0DAAE,CAAE,MAAF,EAAU,mBAAV,CADV;AAECwI,iBAAO,EAAE;AAAA,mBAAM,MAAI,CAACC,eAAL,CAAsB1E,GAAtB,CAAN;AAAA;AAFV,SADQ;AADuC,OAArC,CAAZ;AASA5F,qEAAW,CAAE,uBAAF,EAA2B;AAAEuK,iBAAS,EAAE3E;AAAb,OAA3B,CAAX;AAEA2D,mBAAa,CAAE;AACdiB,6CAAqC,4FAAOL,cAAP,IAAuBvE,GAAvB;AADvB,OAAF,CAAb;AAGA;;;oCAEgBA,G,EAAM;AAAA,yBACoB,KAAKpG,KADzB;AAAA,UACd2K,cADc,gBACdA,cADc;AAAA,UACEZ,aADF,gBACEA,aADF;AAGtB,UAAMkB,qBAAqB,GAAGN,cAAc,CAACrD,MAAf,CAC7B,UAAEqC,IAAF;AAAA,eAAYA,IAAI,KAAKvD,GAArB;AAAA,OAD6B,CAA9B;AAIA2D,mBAAa,CAAE;AACdiB,6CAAqC,EAAEC;AADzB,OAAF,CAAb;AAGA;;;2CAEsB;AACtBjC,cAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBgC,MAAxB,CAAgC,wBAAhC;AACAlC,cAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBgC,MAAxB,CAAgC,kCAAhC;AACA;;;kCAEa;AAAA,yBAWT,KAAKlL,KAXI;AAAA,UAEZmL,WAFY,gBAEZA,WAFY;AAAA,UAGZhI,YAHY,gBAGZA,YAHY;AAAA,UAIZqG,KAJY,gBAIZA,KAJY;AAAA,UAKZ4B,gBALY,gBAKZA,gBALY;AAAA,UAMZC,aANY,gBAMZA,aANY;AAAA,UAOZjI,gBAPY,gBAOZA,gBAPY;AAAA,UAQZkI,yBARY,gBAQZA,yBARY;AAAA,UASZ1H,YATY,gBASZA,YATY;AAAA,UAUZ2H,kBAVY,gBAUZA,kBAVY;AAab,aAAOnB,2DAAW,CAAE;AACnBe,mBAAW,EAAXA,WADmB;AAEnBhI,oBAAY,EAAZA,YAFmB;AAGnBiI,wBAAgB,EAAhBA,gBAHmB;AAInB5B,aAAK,EAALA,KAJmB;AAKnBgC,uBAAe,EAAE,KAAKA,eAAL,CAAqB/H,IAArB,CAA2B,IAA3B,CALE;AAMnB4H,qBAAa,EAAbA,aANmB;AAOnBjI,wBAAgB,EAAhBA,gBAPmB;AAQnBkI,iCAAyB,EAAzBA,yBARmB;AASnB1H,oBAAY,EAAZA,YATmB;AAUnB2H,0BAAkB,EAAlBA;AAVmB,OAAF,CAAlB;AAYA;;;sCAEiB;AAAA,UACTZ,cADS,GACU,KAAK3K,KADf,CACT2K,cADS;AAGjB,aAAO,KAAKP,WAAL,GAAmB9C,MAAnB,CACN,UAAEqC,IAAF;AAAA,eAAYA,IAAI,CAACU,OAAL,IAAgB,CAAEM,cAAc,CAACc,QAAf,CAAyB9B,IAAI,CAACvD,GAA9B,CAA9B;AAAA,OADM,CAAP;AAGA;;;qCAEgB;AAAA,yBAMZ,KAAKpG,KANO;AAAA,UAEfuL,kBAFe,gBAEfA,kBAFe;AAAA,UAGfF,aAHe,gBAGfA,aAHe;AAAA,UAIfjI,gBAJe,gBAIfA,gBAJe;AAAA,UAKfoG,KALe,gBAKfA,KALe;AAAA,UAOFkC,QAPE,GAOWlC,KAPX,CAORG,IAPQ;;AAShB,UAAK,CAAE+B,QAAP,EAAkB;AACjB;AACA;;AAEDC,yEAAmB,CAClBD,QADkB,EAElBH,kBAFkB,EAGlBF,aAHkB,EAIlBjI,gBAJkB,CAAnB;AAMA;;;yCAEoB;AACpB,UAAK,KAAKwI,cAAL,EAAL,EAA6B;AAC5B;AACA;;AAHmB,UAKZzI,YALY,GAKK,KAAKnD,KALV,CAKZmD,YALY;AAMpB,UAAM0I,KAAK,GAAG,KAAK3B,eAAL,EAAd;AAEA1J,qEAAW,CAAE,eAAF,EAAmB;AAC7BsL,oBAAY,EAAED,KAAK,CAACtL,MADS;AAE7BwL,uBAAe,EAAE5I,YAAY,CAAC6I;AAFD,OAAnB,CAAX;AAIA;;;mCAEc;AACdxL,qEAAW,CAAE,oBAAF,EAAwB;AAClCyL,cAAM,EAAE;AAD0B,OAAxB,CAAX;AAIA,WAAKjM,KAAL,CAAW+J,aAAX,CAA0B;AACzBmC,0CAAkC,EAAE;AADX,OAA1B;AAGA;;;iCAEaD,M,EAAS;AACtBzL,qEAAW,CAAE,oBAAF,EAAwB;AAClCyL,cAAM,EAANA;AADkC,OAAxB,CAAX;AAGA,WAAKjM,KAAL,CAAW+J,aAAX,CAA0B;AACzBoC,oCAA4B,EAAE,KADL;AAEzBD,0CAAkC,EAAE;AAFX,OAA1B;AAIA;;;qCAEgB;AAAA,UACR1C,KADQ,GACE,KAAKxJ,KADP,CACRwJ,KADQ;AAAA,UAERG,IAFQ,GAECH,KAFD,CAERG,IAFQ;AAGhB,UAAMyC,WAAW,GAAG,KAAKhC,WAAL,GAAmB3I,IAAnB,CAAyB,UAAE4K,CAAF;AAAA,eAASA,CAAC,CAACjG,GAAF,KAAUuD,IAAnB;AAAA,OAAzB,CAApB;;AAEA,UAAK,CAAEyC,WAAP,EAAqB;AACpB,eAAO,IAAP;AACA;;AAED,aAAOA,WAAP;AACA;;;iCAEY;AAAA;;AACZ,aACC;AAAK,iBAAS,EAAC;AAAf,SACC,yEAAC,qEAAD;AACC,aAAK,EAAG/J,0DAAE,CAAE,mBAAF,EAAuB,mBAAvB,CADX;AAEC,qBAAa,EAAG;AAAA,iBACf;AAAK,qBAAS,EAAC;AAAf,aACC,yEAAC,6DAAD;AACC,mBAAO,EAAG;AAAA,qBACT,MAAI,CAACiK,YAAL,CAAmB,aAAnB,CADS;AAAA;AADX,aAKGjK,0DAAE,CAAE,WAAF,EAAe,mBAAf,CALL,CADD,CADe;AAAA;AAFjB,QADD,CADD;AAkBA;;;sCAEiB;AAAA,UACT0G,eADS,GACW,KAAK9I,KADhB,CACT8I,eADS;;AAGjB,UAAK,CAAEA,eAAP,EAAyB;AACxBvI,uEAAW,CAAE,8BAAF,CAAX;AACA;;AAED,WAAKF,QAAL,CAAe;AAAEyI,uBAAe,EAAE,CAAEA;AAArB,OAAf;AACA;;;6BAEQ;AAAA;;AAAA,UACAS,KADA,GACU,KAAKxJ,KADf,CACAwJ,KADA;AAAA,UAEAT,eAFA,GAEoB,KAAK9I,KAFzB,CAEA8I,eAFA;AAGR,UAAMqD,WAAW,GAAG,KAAKR,cAAL,EAApB;AACA,UAAMW,SAAS,GAAG,KAAKrC,eAAL,GAAuB1D,GAAvB,CAA4B,UAAEmD,IAAF,EAAY;AACzDA,YAAI,CAACvB,SAAL,GAAiBoE,iDAAU,CAC1B7C,IAAI,CAACQ,SAAL,GAAiB,aAAjB,GAAiC,IADP,EAE1BR,IAAI,CAACvB,SAFqB,CAA3B;AAIAuB,YAAI,CAAC8C,MAAL,GACC;AAAK,mBAAS,EAAC;AAAf,WACG9C,IAAI,CAACQ,SAAL,IAAkB,yEAAC,sDAAD;AAAM,cAAI,EAAGuC,uDAAKA;AAAlB,UADrB,CADD;AAMA/C,YAAI,CAAC9H,KAAL,GACC,yEAAC,yEAAD;AACC,YAAE,EAAC,KADJ;AAEC,iBAAO,EAAG8H,IAAI,CAACQ,SAAL,GAAiB,YAAjB,GAAgC;AAF3C,WAIGR,IAAI,CAAC9H,KAJR,EAKG8H,IAAI,CAACgD,IAAL,IAAa,CAAEhD,IAAI,CAACQ,SAApB,IACD;AAAM,mBAAS,EAAC;AAAhB,WACGR,IAAI,CAACgD,IADR,CANF,CADD;;AAcA,YAAK,CAAEhD,IAAI,CAACQ,SAAZ,EAAwB;AACvBR,cAAI,CAACiD,KAAL,GAAajD,IAAI,CAACkD,aAAL,GACZ,yEAAC,6DAAD;AACC,sBAAU,MADX;AAEC,mBAAO,EAAG,iBAAEhF,KAAF,EAAa;AACtBA,mBAAK,CAACiF,eAAN;;AACA,oBAAI,CAACC,WAAL,CAAkBpD,IAAI,CAACvD,GAAvB;AACA;AALF,aAOG/D,0DAAE,CAAE,SAAF,EAAa,mBAAb,CAPL,CADY,GAWZ,yEAAC,sDAAD;AAAM,gBAAI,EAAG2K,8DAAYA;AAAzB,YAXD;AAaA;;AAED,YAAK,CAAErD,IAAI,CAACkB,OAAZ,EAAsB;AACrBlB,cAAI,CAACkB,OAAL,GAAe;AAAA,mBAAMoC,kFAAiB,CAAE;AAAEtD,kBAAI,EAAEA,IAAI,CAACvD;AAAb,aAAF,CAAvB;AAAA,WAAf;AACA;;AAED,eAAOuD,IAAP;AACA,OA9CiB,CAAlB;AA+CA,UAAMuD,gBAAgB,GAAGV,iDAAU,CAClC,qCADkC,EAElC;AACCrC,iBAAS,EACRoC,SAAS,CAAChM,MAAV,KAAqB,KAAKiK,oBAAL,GAA4BjK;AAFnD,OAFkC,CAAnC;AAQA,aACC,yEAAC,2DAAD,QACC;AAAK,iBAAS,EAAC;AAAf,SACG6L,WAAW,GACZe,uEAAY,CAAEf,WAAW,CAACgB,SAAd,EAAyB;AACpC5D,aAAK,EAALA;AADoC,OAAzB,CADA,GAKZ,yEAAC,2DAAD,QACC,yEAAC,2DAAD;AACC,YAAI,EAAC,OADN;AAEC,iBAAS,EAAC;AAFX,SAIC;AACC,iBAAS,EAAG0D,gBADb;AAEC,WAAG,EAAGX,SAAS,CAAChM,MAFjB;AAGC,aAAK,EAAG,KAAKiK,oBAAL,GAA4BjK;AAHrC,QAJD,EASC,yEAAC,iEAAD;AAAY,YAAI,EAAC;AAAjB,SACC,yEAAC,yEAAD;AAAM,eAAO,EAAC;AAAd,SACG8B,0DAAE,CACH,cADG,EAEH,mBAFG,CADL,CADD,EAOG,KAAKgL,UAAL,EAPH,CATD,EAkBC,yEAAC,+DAAD,QACC,yEAAC,6DAAD;AAAM,aAAK,EAAGd;AAAd,QADD,CAlBD,CADD,CANF,CADD,EAiCGxD,eAAe,IAChB,yEAAC,wEAAD;AACC,eAAO,EAAG;AAAA,iBAAM,MAAI,CAACyC,eAAL,EAAN;AAAA,SADX;AAEC,4BAAoB,EAAG;AAAA,iBAAM,MAAI,CAACA,eAAL,EAAN;AAAA;AAFxB,QAlCF,CADD;AA0CA;;;;EAhV0B7I,4D;;AAmVbC,iIAAO,CACrBC,mEAAU,CAAE,UAAEC,MAAF,EAAc;AAAA,gBACGA,MAAM,CAAEG,wEAAF,CADT;AAAA,MACjBC,eADiB,WACjBA,eADiB;;AAAA,iBAEHJ,MAAM,CAAEwK,qEAAF,CAFH;AAAA,MAEjBC,SAFiB,YAEjBA,SAFiB;;AAAA,iBAGDzK,MAAM,CAAE0K,sEAAF,CAHL;AAAA,MAGjBC,WAHiB,YAGjBA,WAHiB;;AAAA,iBAQrB3K,MAAM,CAAEC,qEAAF,CARe;AAAA,MAKxB2K,gBALwB,YAKxBA,gBALwB;AAAA,MAMxB1K,mBANwB,YAMxBA,mBANwB;AAAA,MAOxBuI,kBAPwB,YAOxBA,kBAPwB;;AASzB,MAAMpI,YAAY,GAAGD,eAAe,EAApC;AAEA,MAAM4G,kBAAkB,GACvByD,SAAS,CAAE,gCAAF,CAAT,IAAiD,KADlD;AAEA,MAAMnC,gBAAgB,GAAGmC,SAAS,CAAE,gCAAF,CAAlC;AACA,MAAMjD,qBAAqB,GAC1BiD,SAAS,CAAE,+CAAF,CAAT,IAAgE,EADjE;AAGA,MAAMI,QAAQ,GAAGJ,SAAS,CAAE,gCAAF,CAA1B;AACA,MAAM5C,cAAc,GACnB4C,SAAS,CAAE,uCAAF,CAAT,IAAwD,EADzD;;AAlByB,qBAqBiBE,WAAW,CAAE,SAAF,CArB5B;AAAA,0CAqBjBG,OArBiB;AAAA,MAqBRC,eArBQ,qCAqBU,EArBV;;AAsBzB,MAAM1C,WAAW,GAAG2C,uEAAc,CACjCD,eAAe,CAACE,2BADiB,CAAlC;AAIA,MAAM1C,aAAa,GAAGqC,gBAAgB,EAAtC;AACA,MAAMtK,gBAAgB,GAAGJ,mBAAmB,EAA5C;AAEA,SAAO;AACNqI,iBAAa,EAAbA,aADM;AAENF,eAAW,EAAXA,WAFM;AAGNR,kBAAc,EAAdA,cAHM;AAINY,sBAAkB,EAAEA,kBAAkB,EAJhC;AAKNnI,oBAAgB,EAAhBA,gBALM;AAMN0G,sBAAkB,EAAlBA,kBANM;AAON6D,YAAQ,EAARA,QAPM;AAQNxK,gBAAY,EAAZA,YARM;AASNiI,oBAAgB,EAAhBA,gBATM;AAUNd,yBAAqB,EAArBA;AAVM,GAAP;AAYA,CAzCS,CADW,EA2CrBlF,qEAAY,CAAE,UAAEC,QAAF,EAAgB;AAAA,kBACJA,QAAQ,CAAE,cAAF,CADJ;AAAA,MACrBzB,YADqB,aACrBA,YADqB;;AAAA,mBAEHyB,QAAQ,CAAEiI,qEAAF,CAFL;AAAA,MAErBvD,aAFqB,cAErBA,aAFqB;;AAAA,mBAGS1E,QAAQ,CAAEtC,qEAAF,CAHjB;AAAA,MAGrBuI,yBAHqB,cAGrBA,yBAHqB;;AAK7B,SAAO;AACN1H,gBAAY,EAAZA,YADM;AAEN0H,6BAAyB,EAAzBA,yBAFM;AAGNvB,iBAAa,EAAbA;AAHM,GAAP;AAKA,CAVW,CA3CS,CAAP,CAsDZjB,aAtDY,CAAf,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1XA;;;AAIA;AACA;AAEA;;;;AAGA;AACA;AAKA;AAEA;;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEO,SAAS6C,mBAAT,CACND,QADM,EAENH,kBAFM,EAGNF,aAHM,EAINjI,gBAJM,EAKL;AACD5C,iEAAW,CAAE,WAAF,EAAe;AACzBuK,aAAS,EAAEW,QADc;AAEzBsC,iBAAa,EAAE5K,gBAAgB,CAACqI,QAAjB,CAA2B,sBAA3B,CAFU;AAGzBwC,cAAU,EAAE5C,aAAa,CAACI,QAAd,CAAwB,sBAAxB,CAHa;AAIzByC,qBAAiB,EAAE9K,gBAAgB,CAACqI,QAAjB,CAA2B,SAA3B,CAJM;AAKzB0C,kBAAc,EAAE9C,aAAa,CAACI,QAAd,CAAwB,SAAxB,CALS;AAMzB2C,qBAAiB,EAAE7C;AANM,GAAf,CAAX;AAQA;AAEM,SAASnB,WAAT,OAWH;AAAA,MAVHe,WAUG,QAVHA,WAUG;AAAA,MATHhI,YASG,QATHA,YASG;AAAA,MARHiI,gBAQG,QARHA,gBAQG;AAAA,MAPH5B,KAOG,QAPHA,KAOG;AAAA,MANHgC,eAMG,QANHA,eAMG;AAAA,MALHH,aAKG,QALHA,aAKG;AAAA,MAJHjI,gBAIG,QAJHA,gBAIG;AAAA,MAHHkI,yBAGG,QAHHA,yBAGG;AAAA,MAFH1H,YAEG,QAFHA,YAEG;AAAA,MADH2H,kBACG,QADHA,kBACG;;AAAA,oBAOCrK,iFAAU,CAAE,YAAF,EAAgB;AAC7BmN,uBAAmB,EAAE,KADQ;AAE7BC,eAAW,EAAE,KAFgB;AAG7BC,wBAAoB,EAAE,KAHO;AAI7BC,iBAAa,EAAE,KAJc;AAK7BC,sBAAkB,EAAE;AALS,GAAhB,CAPX;AAAA,MAEFJ,mBAFE,eAEFA,mBAFE;AAAA,MAGFC,WAHE,eAGFA,WAHE;AAAA,MAIFC,oBAJE,eAIFA,oBAJE;AAAA,MAKFC,aALE,eAKFA,aALE;AAAA,MAMFC,kBANE,eAMFA,kBANE;;AAeH,MAAMC,eAAe,GAAGC,wFAAgC,CACvDxL,YADuD,EAEvDC,gBAFuD,CAAxD;AAfG,MAoBKwL,QApBL,GAoBsDF,eApBtD,CAoBKE,QApBL;AAAA,MAoBeC,iBApBf,GAoBsDH,eApBtD,CAoBeG,iBApBf;AAAA,MAoBkCC,eApBlC,GAoBsDJ,eApBtD,CAoBkCI,eApBlC;AAsBH,MAAMC,iBAAiB,GAAGC,OAAO,CAChC5D,gBAAgB,IAAIA,gBAAgB,CAACjB,SADL,CAAjC;AAGA,MAAM8E,eAAe,GAAGD,OAAO,CAC9B5D,gBAAgB,IAAIA,gBAAgB,CAAC8D,OADP,CAA/B;AAIA,MAAMC,4BAA4B,GACjC/L,gBAAgB,CAACgM,OAAjB,CAA0B,sBAA1B,MAAuD,CAAC,CADzD;AA7BG,MAgCSC,iBAhCT,GAkCClM,YAlCD,CAgCFgH,SAhCE;AAAA,MAiCahJ,YAjCb,GAkCCgC,YAlCD,CAiCFmM,aAjCE;;AAoCH,MAAIC,sBAAsB,GAAGlN,0DAAE,CAAE,+BAAF,CAA/B;;AAEA,MAAKyM,eAAe,CAACvO,MAAhB,KAA2B,CAAhC,EAAoC;AAAA,4BACQuO,eAAe,CAAE,CAAF,CADvB;AAAA,QACrBU,QADqB,qBAC3BlJ,IAD2B;AAAA,QACLmJ,QADK,qBACXC,IADW;AAEnC,QAAMC,wBAAwB,GAC7BF,QAAQ,KAAK,OAAb,GACGpN,0DAAE,CAAE,6BAAF,EAAiC,mBAAjC,CADL,GAEGA,0DAAE,CAAE,iCAAF,EAAqC,mBAArC,CAHN;AAIAkN,0BAAsB,GAAGnN,+DAAO,CAAEuN,wBAAF,EAA4BH,QAA5B,CAAhC;AACA;;AAED,MAAM3D,KAAK,GAAG,CACb;AACCzF,OAAG,EAAE,eADN;AAECvE,SAAK,EAAEQ,0DAAE,CAAE,eAAF,EAAmB,mBAAnB,CAFV;AAGC+K,aAAS,EAAE,IAHZ;AAICvC,WAAO,EAAE,mBAAM;AACdrK,qEAAW,CAAE,gBAAF,EAAoB;AAC9BuK,iBAAS,EAAE;AADmB,OAApB,CAAX;AAGA6E,gFAAU,GAAGhO,IAAb,CAAmBiO,0EAAU,CAAE,EAAF,eAAmB,EAAnB,CAA7B;AACA,KATF;AAUC1F,aAAS,EAAEkF,iBAVZ;AAWChF,WAAO,EAAE,IAXV;AAYCsC,QAAI,EAAEtK,0DAAE,CAAE,WAAF,EAAe,mBAAf;AAZT,GADa,EAeb;AACC+D,OAAG,EAAE,UADN;AAECvE,SAAK,EAAE0N,sBAFR;AAGCnC,aAAS,EAAE,IAHZ;AAICvC,WAAO,EAAE,mBAAM;AACdrK,qEAAW,CAAE,gBAAF,EAAoB;AAC9BuK,iBAAS,EAAE;AADmB,OAApB,CAAX;AAGA,aAAO8D,iBAAiB,CAACtO,MAAlB,GAA2BiL,eAAe,EAA1C,GAA+C,IAAtD;AACA,KATF;AAUCnB,WAAO,EAAEuE,QAAQ,CAACrO,MAVnB;AAWC4J,aAAS,EAAEyE,QAAQ,CAACrO,MAAT,IAAmB,CAAEsO,iBAAiB,CAACtO,MAXnD;AAYCoM,QAAI,EAAEtK,0DAAE,CAAE,WAAF,EAAe,mBAAf,CAZT;AAaCwK,iBAAa,EAAE;AAbhB,GAfa,EA8Bb;AACCzG,OAAG,EAAE,UADN;AAECvE,SAAK,EAAEQ,0DAAE,CAAE,iBAAF,EAAqB,mBAArB,CAFV;AAGC+K,aAAS,EAAE,yEAAC,uDAAD,OAHZ;AAICvC,WAAO,EAAE,mBAAM;AACdrK,qEAAW,CAAE,gBAAF,EAAoB;AAC9BuK,iBAAS,EAAE;AADmB,OAApB,CAAX;AAGAkC,uFAAiB,CAAE;AAAEtD,YAAI,EAAE;AAAR,OAAF,CAAjB;AACA,KATF;AAUCQ,aAAS,EAAEmE,WAVZ;AAWCjE,WAAO,EAAE,IAXV;AAYCsC,QAAI,EAAEtK,0DAAE,CAAE,sBAAF,EAA0B,mBAA1B;AAZT,GA9Ba,EA4Cb;AACC+D,OAAG,EAAE,sBADN;AAECvE,SAAK,EAAEQ,0DAAE,CAAE,6BAAF,EAAiC,mBAAjC,CAFV;AAGC+K,aAAS,EAAE,yEAAC,2DAAD,OAHZ;AAICjD,aAAS,EAAE4E,iBAAiB,IAAIE,eAJjC;AAKCpE,WAAO;AAAA,yLAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACF,IAAIiF,OAAJ,CAAa,UAAEC,OAAF,EAAWC,MAAX,EAAuB;AACzC;AACA;AACA;AACArE,qCAAmB,CAClB,OADkB,EAElBJ,kBAFkB,EAGlBF,aAHkB,EAIlBjI,gBAJkB,CAAnB;AAMA5C,iFAAW,CAAE,gBAAF,EAAoB;AAC9BuK,6BAAS,EAAE;AADmB,mBAApB,CAAX;AAGA,yBAAOkF,+FAA8B,CACpCF,OADoC,EAEpCC,MAFoC,EAGpCpM,YAHoC,EAIpC0H,yBAJoC,CAArC;AAMA,iBAnBK,CADE;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,OALR;AA2BCjB,WAAO,EACNvJ,MAAM,CAACoP,eAAP,CAAuBC,KAAvB,IACAhB,4BADA,IAEAhE,WAAW,KAAK,IA9BlB;AA+BCwB,QAAI,EAAEtK,0DAAE,CAAE,WAAF,EAAe,mBAAf;AA/BT,GA5Ca,EA6Eb;AACC+D,OAAG,EAAE,UADN;AAECvE,SAAK,EAAEQ,0DAAE,CAAE,iBAAF,EAAqB,mBAArB,CAFV;AAGC+K,aAAS,EAAE,yEAAC,wDAAD,OAHZ;AAICjD,aAAS,EAAE4E,iBAAiB,IAAIE,eAJjC;AAKCpE,WAAO,EAAE,mBAAM;AACdrK,qEAAW,CAAE,gBAAF,EAAoB;AAC9BuK,iBAAS,EAAE;AADmB,OAApB,CAAX;AAGAkC,uFAAiB,CAAE;AAAEtD,YAAI,EAAE;AAAR,OAAF,CAAjB;AACA,KAVF;AAWCU,WAAO,EAAE,CAAE8E,4BAXZ;AAYCxC,QAAI,EAAEtK,0DAAE,CAAE,WAAF,EAAe,mBAAf;AAZT,GA7Ea,EA2Fb;AACC+D,OAAG,EAAE,KADN;AAECvE,SAAK,EAAEQ,0DAAE,CAAE,YAAF,EAAgB,mBAAhB,CAFV;AAGC+K,aAAS,EAAE,yEAAC,mDAAD,OAHZ;AAICvC,WAAO,EAAE,mBAAM;AACdrK,qEAAW,CAAE,gBAAF,EAAoB;AAC9BuK,iBAAS,EAAE;AADmB,OAApB,CAAX;AAGAkC,uFAAiB,CAAE;AAAEtD,YAAI,EAAE;AAAR,OAAF,CAAjB;AACA,KATF;AAUCQ,aAAS,EAAEqE,aAVZ;AAWCnE,WAAO,EAAE,IAXV;AAYCsC,QAAI,EAAEtK,0DAAE,CAAE,UAAF,EAAc,mBAAd;AAZT,GA3Fa,EAyGb;AACC+D,OAAG,EAAE,UADN;AAECvE,SAAK,EAAEQ,0DAAE,CAAE,iBAAF,EAAqB,mBAArB,CAFV;AAGC+K,aAAS,EAAE,yEAAC,wDAAD,OAHZ;AAICvC,WAAO,EAAE,mBAAM;AACdrK,qEAAW,CAAE,gBAAF,EAAoB;AAC9BuK,iBAAS,EAAE;AADmB,OAApB,CAAX;AAGAkC,uFAAiB,CAAE;AAAEtD,YAAI,EAAE;AAAR,OAAF,CAAjB;AACA,KATF;AAUCQ,aAAS,EAAEsE,kBAAkB,GAAG,CAVjC;AAWCpE,WAAO,EACJlJ,YAAY,IAAIA,YAAY,CAACsK,QAAb,CAAuB,UAAvB,CAAlB,IACA4C,mBAbF;AAcC1B,QAAI,EAAEtK,0DAAE,CAAE,UAAF,EAAc,mBAAd;AAdT,GAzGa,EAyHb;AACC+D,OAAG,EAAE,YADN;AAECvE,SAAK,EAAEQ,0DAAE,CAAE,sBAAF,EAA0B,mBAA1B,CAFV;AAGC+K,aAAS,EAAE,yEAAC,yDAAD,OAHZ;AAICvC,WAAO,EAAE,mBAAM;AACdrK,qEAAW,CAAE,gBAAF,EAAoB;AAC9BuK,iBAAS,EAAE;AADmB,OAApB,CAAX;AAGAkC,uFAAiB,CAAE;AAAEtD,YAAI,EAAE;AAAR,OAAF,CAAjB;AACA,KATF;AAUCQ,aAAS,EAAEoE,oBAVZ;AAWClE,WAAO,EAAE,IAXV;AAYCsC,QAAI,EAAEtK,0DAAE,CAAE,WAAF,EAAe,mBAAf;AAZT,GAzHa,CAAd;AAyIA,SAAO+N,qEAAY,CAClB,wCADkB,EAElBvE,KAFkB,EAGlBrC,KAHkB,CAAnB;AAKA,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtPD;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;AAGA;AAMA;AACA;AACA;AAEA;;;;AAGA;AACA;;IAEM6G,U;;;;;AACL,sBAAarQ,KAAb,EAAqB;AAAA;;AAAA;;AACpB,8BAAOA,KAAP;;AADoB,sBAEiBkB,kFAAU,CAAE,YAAF,EAAgB,EAAhB,CAF3B;AAAA,QAEZoP,WAFY,eAEZA,WAFY;AAAA,QAEChC,WAFD,eAECA,WAFD;;AAIpB,UAAKiC,cAAL,GAAsB;AACrBC,cAAQ,EAAE,CAAEF,WADS;AAErBG,YAAM,EAAE,CAAEnC;AAFW,KAAtB;AAKA,UAAKrO,KAAL,GAAa;AACZyQ,aAAO,EAAE,KADG;AAEZC,eAAS,EAAE,KAFC;AAGZC,UAAI,EAAE,IAHM;AAIZC,eAAS,EAAE,CAJC;AAKZC,oBAAc,EAAE,KALJ;AAMZC,sBAAgB,EAAE,KANN;AAOZC,qBAAe,EAAEhR,KAAK,CAACiR,eAAN,IAAyB;AAP9B,KAAb;AAUA,UAAKC,YAAL,GAAoB,MAAKA,YAAL,CAAkBzN,IAAlB,4FAApB;AACA,UAAK0N,cAAL,GAAsB,MAAKA,cAAL,CAAoB1N,IAApB,4FAAtB;AACA,UAAK2N,cAAL,GAAsB,MAAKA,cAAL,CAAoB3N,IAApB,4FAAtB;AACA,UAAK4N,UAAL,GAAkB,MAAKA,UAAL,CAAgB5N,IAAhB,4FAAlB;AACA,UAAK6N,YAAL,GAAoB,MAAKA,YAAL,CAAkB7N,IAAlB,4FAApB;AAvBoB;AAwBpB;;;;wCAEmB;AAAA,yBACGvC,kFAAU,CAAE,YAAF,EAAgB,EAAhB,CADb;AAAA,UACXqQ,SADW,gBACXA,SADW;;AAGnB,UAAKA,SAAS,CAACC,WAAf,EAA6B;AAC5B;AACA,aAAKlR,QAAL,CAAe;AAAEsQ,cAAI,EAAE;AAAEzO,cAAE,EAAEoP,SAAS,CAACC;AAAhB;AAAR,SAAf;AACA;AACA;AACD;;;uCAEmB7N,S,EAAY;AAAA;;AAAA,wBACH,KAAK1D,KADF;AAAA,UACvB0Q,SADuB,eACvBA,SADuB;AAAA,UACZC,IADY,eACZA,IADY;AAAA,UAEvBK,eAFuB,GAEH,KAAKjR,KAFF,CAEvBiR,eAFuB;;AAI/B,UAAKL,IAAI,IAAI,CAAEA,IAAI,CAACjQ,GAAf,IAAsB,CAAEgQ,SAA7B,EAAyC;AACxC;AACA,aAAKrQ,QAAL,CAAe;AAAEqQ,mBAAS,EAAE;AAAb,SAAf;AACAc,UAAE,CAACC,KAAH,CACEC,UADF,CACcf,IAAI,CAACzO,EADnB,EAEEyP,KAFF,GAGEC,IAHF,CAGQ,YAAM;AACZ,cAAMC,OAAO,GAAGL,EAAE,CAACC,KAAH,CAASC,UAAT,CAAqBf,IAAI,CAACzO,EAA1B,EAA+B4P,GAA/B,CAAoC,KAApC,CAAhB;;AACA,gBAAI,CAACzR,QAAL,CAAe;AACdqQ,qBAAS,EAAE,KADG;AAEdC,gBAAI,EAAE;AAAEzO,gBAAE,EAAEyO,IAAI,CAACzO,EAAX;AAAexB,iBAAG,EAAEmR;AAApB;AAFQ,WAAf;AAIA,SATF;AAUA;AACA;;AAED,UACCb,eAAe,IACftN,SAAS,CAACsN,eAAV,KAA8BA,eAF/B,EAGE;AACD;AACA,aAAK3Q,QAAL,CAAe;AACd0Q,yBAAe,EAAEC;AADH,SAAf;AAGA;AACA;AACD;;;mCAEc;AAAA,UACNJ,SADM,GACQ,KAAK5Q,KADb,CACN4Q,SADM;AAEd,UAAMmB,QAAQ,GAAG,KAAKC,QAAL,GAAiBpB,SAAS,GAAG,CAA7B,CAAjB;;AAEA,UAAKmB,QAAL,EAAgB;AACf,aAAK1R,QAAL,CAAe;AAAEuQ,mBAAS,EAAEA,SAAS,GAAG;AAAzB,SAAf;AACA,OAFD,MAEO;AACNjB,mFAAU,GAAGhO,IAAb,CAAmBiO,2EAAU,CAAE,EAAF,EAAM,GAAN,EAAW,EAAX,CAA7B;AACA;AACD;;;qCAEgB;AAAA;;AAAA,UACRjM,YADQ,GACS,KAAK5D,KADd,CACR4D,YADQ;AAEhB,WAAKtD,QAAL,CAAe;AAAEqQ,iBAAS,EAAE;AAAb,OAAf;AAEAnQ,qEAAW,CAAE,iCAAF,EAAqC,EAArC,CAAX;AAEA0R,kEAAQ,CAAE;AACTC,YAAI,YAAMC,oEAAN,6CADK;AAETC,cAAM,EAAE;AAFC,OAAF,CAAR,CAIER,IAJF,CAIQ,UAAES,MAAF,EAAc;AACpB,YAAKA,MAAM,CAACC,MAAP,IAAiBD,MAAM,CAACC,MAAP,CAAchS,MAApC,EAA6C;AAC5CqD,sBAAY,CACX,OADW,EAEXvB,2DAAE,CACD,2DADC,EAED,mBAFC,CAFS,CAAZ;AAOA,SARD,MAQO;AACNuB,sBAAY,CACX,SADW,EAEXvB,2DAAE,CACD,yCADC,EAED,mBAFC,CAFS,CAAZ;AAOAmQ,4FAAU,CAAE,YAAF,kCACNtR,kFAAU,CAAE,YAAF,EAAgB,EAAhB,CADJ;AAEToN,uBAAW,EAAE;AAFJ,aAAV;AAIA;;AAED,cAAI,CAAChO,QAAL,CAAe;AAAEqQ,mBAAS,EAAE;AAAb,SAAf;;AACA,cAAI,CAACO,YAAL;AACA,OA7BF,EA8BEuB,KA9BF,CA8BS,UAAE5O,KAAF,EAAa;AACpBD,oBAAY,CAAE,OAAF,EAAWC,KAAK,CAAC6O,OAAjB,CAAZ;;AACA,cAAI,CAACpS,QAAL,CAAe;AAAEqQ,mBAAS,EAAE;AAAb,SAAf;AACA,OAjCF;AAkCA;;;qCAEgB;AAAA;;AAAA,UACR/M,YADQ,GACS,KAAK5D,KADd,CACR4D,YADQ;AAEhB,WAAKtD,QAAL,CAAe;AAAEqQ,iBAAS,EAAE;AAAb,OAAf;AAEAnQ,qEAAW,CAAE,qCAAF,EAAyC;AACnDmS,uBAAe,EAAE;AADkC,OAAzC,CAAX;AAIAT,kEAAQ,CAAE;AACTC,YAAI,EAAE,4CADG;AAETE,cAAM,EAAE;AAFC,OAAF,CAAR,CAIER,IAJF,CAIQ,UAAEe,QAAF,EAAgB;AACtBhP,oBAAY,CAAEgP,QAAQ,CAACC,MAAX,EAAmBD,QAAQ,CAACF,OAA5B,EAAqC;AAChD9H,iBAAO,EAAEgI,QAAQ,CAACE,cAAT,GACN,CACA;AACChR,iBAAK,EAAEO,2DAAE,CACR,WADQ,EAER,mBAFQ,CADV;AAKCwI,mBAAO,EAAE,mBAAM;AACdkI,kFAAgB,CACf,wCADe,EAEf,EAFe,CAAhB;AAIAjS,oBAAM,CAACC,QAAP,aAAsB6R,QAAQ,CAACE,cAA/B;AACA;AAXF,WADA,CADM,GAgBN;AAjB6C,SAArC,CAAZ;;AAoBA,cAAI,CAACxS,QAAL,CAAe;AAAEqQ,mBAAS,EAAE;AAAb,SAAf;;AACA,cAAI,CAACO,YAAL;AACA,OA3BF,EA4BEuB,KA5BF,CA4BS,UAAE5O,KAAF,EAAa;AACpBD,oBAAY,CAAE,OAAF,EAAWC,KAAK,CAAC6O,OAAjB,CAAZ;;AACA,cAAI,CAACpS,QAAL,CAAe;AAAEqQ,mBAAS,EAAE;AAAb,SAAf;AACA,OA/BF;AAgCA;;;;;;;;;;;8BAGwC,KAAK3Q,K,EAArC+J,a,eAAAA,a,EAAenG,Y,eAAAA,Y;AACfgN,oB,GAAS,KAAK3Q,K,CAAd2Q,I;+BAC0B1P,kFAAU,CAAE,YAAF,EAAgB,EAAhB,C,EAApC8R,U,gBAAAA,U,EAAYzB,S,gBAAAA,S;AACd0B,gC,mCACF1B,S;AACHC,6BAAW,EAAEZ,IAAI,GAAGA,IAAI,CAACzO,EAAR,GAAa;;AAG/B3B,+EAAW,CAAE,iCAAF,CAAX;AAEAgS,kGAAU,CAAE,YAAF,kCACNtR,kFAAU,CAAE,YAAF,EAAgB,EAAhB,CADJ;AAETqQ,2BAAS,EAAE0B;AAFF,mBAAV;AAKA,qBAAK3S,QAAL,CAAe;AAAEwQ,gCAAc,EAAE;AAAlB,iBAAf;;uBACqB/G,aAAa,CAAC,sGACjBiJ,UADgB,GACCC,gBADD,E;;;AAA5BC,sB;;AAIN,oBAAKA,MAAM,CAACC,OAAZ,EAAsB;AACrB,uBAAK7S,QAAL,CAAe;AAAEwQ,kCAAc,EAAE;AAAlB,mBAAf;AACAlN,8BAAY,CACX,SADW,EAEXvB,2DAAE,CAAE,iCAAF,EAAqC,mBAArC,CAFS,CAAZ;AAIA,uBAAK6O,YAAL;AACA,iBAPD,MAOO;AACNtN,8BAAY,CAAE,OAAF,EAAWsP,MAAM,CAACR,OAAlB,CAAZ;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;+BAIuC,KAAK1S,K,EAArC+J,a,gBAAAA,a,EAAenG,Y,gBAAAA,Y;AACfoN,+B,GAAoB,KAAK/Q,K,CAAzB+Q,e;AAERxQ,+EAAW,CAAE,sCAAF,EAA0C;AACpD4S,4BAAU,EAAEpE,OAAO,CAAEgC,eAAe,CAACzQ,MAAlB;AADiC,iBAA1C,CAAX;AAIAiS,kGAAU,CAAE,YAAF,kCACNtR,kFAAU,CAAE,YAAF,EAAgB,EAAhB,CADJ;AAETqN,sCAAoB,EAAE;AAFb,mBAAV;AAKA,qBAAKjO,QAAL,CAAe;AAAEyQ,kCAAgB,EAAE;AAApB,iBAAf;;uBACqBhH,aAAa,CAAE;AACnCsJ,2DAAyC,EAAE,IADR;AAEnCC,wCAAsB,EAAEtC,eAAe,CAACzQ,MAAhB,GAAyB,KAAzB,GAAiC,IAFtB;AAGnCgT,+CAA6B,EAAEvC;AAHI,iBAAF,C;;;AAA5BkC,sB;;AAMN,oBAAKA,MAAM,CAACC,OAAZ,EAAsB;AACrB,uBAAK7S,QAAL,CAAe;AAAEyQ,oCAAgB,EAAE;AAApB,mBAAf;AACAnN,8BAAY,CACX,SADW,EAEXvB,2DAAE,CACD,4EADC,EAED,mBAFC,CAFS,CAAZ;AAOA,uBAAK6O,YAAL;AACA,iBAVD,MAUO;AACNtN,8BAAY,CAAE,OAAF,EAAWsP,MAAM,CAACR,OAAlB,CAAZ;AACA;;;;;;;;;;;;;;;;;;+BAGS;AAAA;;AAAA,yBAON,KAAKzS,KAPC;AAAA,UAETyQ,OAFS,gBAETA,OAFS;AAAA,UAGTC,SAHS,gBAGTA,SAHS;AAAA,UAITC,IAJS,gBAITA,IAJS;AAAA,UAKTI,eALS,gBAKTA,eALS;AAAA,UAMTF,cANS,gBAMTA,cANS;AASV,UAAM0C,KAAK,GAAG,CACb;AACCpN,WAAG,EAAE,QADN;AAECtE,aAAK,EAAEO,2DAAE,CAAE,wBAAF,EAA4B,mBAA5B,CAFV;AAGCL,mBAAW,EAAEK,2DAAE,CACd,oFADc,EAEd,mBAFc,CAHhB;AAOCN,eAAO,EACN,yEAAC,2DAAD,QACC,yEAAC,6DAAD;AACC,iBAAO,EAAG,KAAKqP,cADhB;AAEC,gBAAM,EAAGT,SAFV;AAGC,mBAAS;AAHV,WAKGtO,2DAAE,CAAE,iBAAF,EAAqB,mBAArB,CALL,CADD,EAQC,yEAAC,6DAAD;AAAQ,iBAAO,EAAG;AAAA,mBAAM,MAAI,CAAC6O,YAAL,EAAN;AAAA;AAAlB,WACG7O,2DAAE,CAAE,MAAF,EAAU,mBAAV,CADL,CARD,CARF;AAqBCgI,eAAO,EAAE,KAAKkG,cAAL,CAAoBE;AArB9B,OADa,EAwBb;AACCrK,WAAG,EAAE,UADN;AAECtE,aAAK,EAAEO,2DAAE,CAAE,0BAAF,EAA8B,mBAA9B,CAFV;AAGCL,mBAAW,EAAEK,2DAAE,CACd,2DADc,EAEd,mBAFc,CAHhB;AAOCN,eAAO,EACN,yEAAC,2DAAD,QACC,yEAAC,6DAAD;AACC,mBAAS,MADV;AAEC,gBAAM,EAAG4O,SAFV;AAGC,iBAAO,EAAG,KAAKQ;AAHhB,WAKG9O,2DAAE,CAAE,iBAAF,EAAqB,mBAArB,CALL,CADD,EAQC,yEAAC,6DAAD;AACC,iBAAO,EAAG,mBAAM;AACf7B,2EAAW,CACV,qCADU,EAEV;AAAEmS,6BAAe,EAAE;AAAnB,aAFU,CAAX;;AAIA,kBAAI,CAACzB,YAAL;AACA;AAPF,WASG7O,2DAAE,CAAE,MAAF,EAAU,mBAAV,CATL,CARD,CARF;AA6BCgI,eAAO,EAAE,KAAKkG,cAAL,CAAoBC;AA7B9B,OAxBa,EAuDb;AACCpK,WAAG,EAAE,MADN;AAECtE,aAAK,EAAEO,2DAAE,CAAE,eAAF,EAAmB,mBAAnB,CAFV;AAGCL,mBAAW,EAAEK,2DAAE,CACd,mDADc,EAEd,mBAFc,CAHhB;AAOCN,eAAO,EAAE4O,SAAS,GAAG,IAAH,GACjB,yEAAC,2DAAD,QACC,yEAAC,oEAAD;AACC,eAAK,EAAGC,IADT;AAEC,kBAAQ,EAAG,kBAAE6C,KAAF;AAAA,mBACV,MAAI,CAACnT,QAAL,CAAe;AAAEoQ,qBAAO,EAAE,IAAX;AAAiBE,kBAAI,EAAE6C;AAAvB,aAAf,CADU;AAAA;AAFZ,UADD,EAOC,yEAAC,6DAAD;AACC,kBAAQ,EAAG,CAAE7C,IAAF,IAAU,CAAEF,OADxB;AAEC,iBAAO,EAAG,KAAKW,UAFhB;AAGC,gBAAM,EAAGP,cAHV;AAIC,mBAAS;AAJV,WAMGzO,2DAAE,CAAE,SAAF,EAAa,mBAAb,CANL,CAPD,EAeC,yEAAC,6DAAD;AACC,oBAAU,MADX;AAEC,iBAAO,EAAG;AAAA,mBAAM,MAAI,CAAC6O,YAAL,EAAN;AAAA;AAFX,WAIG7O,2DAAE,CAAE,MAAF,EAAU,mBAAV,CAJL,CAfD,CARF;AA+BCgI,eAAO,EAAE;AA/BV,OAvDa,EAwFb;AACCjE,WAAG,EAAE,QADN;AAECtE,aAAK,EAAEO,2DAAE,CAAE,oBAAF,EAAwB,mBAAxB,CAFV;AAGCL,mBAAW,EAAEK,2DAAE,CACd,sEADc,EAEd,mBAFc,CAHhB;AAOCN,eAAO,EACN,yEAAC,2DAAD,QACC,yEAAC,oEAAD;AACC,eAAK,EAAGM,2DAAE,CACT,mBADS,EAET,mBAFS,CADX;AAKC,qBAAW,EAAGA,2DAAE,CACf,mBADe,EAEf,mBAFe,CALjB;AASC,eAAK,EAAG2O,eATT;AAUC,kBAAQ,EAAG,kBAAEjJ,KAAF;AAAA,mBACV,MAAI,CAACzH,QAAL,CAAe;AAAE0Q,6BAAe,EAAEjJ;AAAnB,aAAf,CADU;AAAA;AAVZ,UADD,EAeC,yEAAC,6DAAD;AAAQ,iBAAO,EAAG,KAAKuJ,YAAvB;AAAsC,mBAAS;AAA/C,WACGjP,2DAAE,CAAE,eAAF,EAAmB,mBAAnB,CADL,CAfD,CARF;AA4BCgI,eAAO,EAAE;AA5BV,OAxFa,CAAd;AAwHA,aAAO/C,sDAAM,CAAEkM,KAAF,EAAS,UAAEE,IAAF;AAAA,eAAYA,IAAI,CAACrJ,OAAjB;AAAA,OAAT,CAAb;AACA;;;6BAEQ;AAAA,yBAMJ,KAAKpK,KAND;AAAA,UAEP0Q,SAFO,gBAEPA,SAFO;AAAA,UAGPE,SAHO,gBAGPA,SAHO;AAAA,UAIPC,cAJO,gBAIPA,cAJO;AAAA,UAKPC,gBALO,gBAKPA,gBALO;AAOR,UAAM4C,WAAW,GAAG,KAAK1B,QAAL,GAAiBpB,SAAjB,EAA6BzK,GAAjD;AAEA,aACC;AAAK,iBAAS,EAAC;AAAf,SACC,yEAAC,6DAAD;AAAM,iBAAS,EAAC;AAAhB,SACC,yEAAC,gEAAD;AACC,iBAAS,EACR2K,gBAAgB,IAAID,cAApB,IAAsCH,SAFxC;AAIC,kBAAU,MAJX;AAKC,mBAAW,EAAGgD,WALf;AAMC,aAAK,EAAG,KAAK1B,QAAL;AANT,QADD,CADD,CADD;AAcA;;;;EAnYuBtP,4D;;AAsYVC,kIAAO,CACrBC,mEAAU,CAAE,UAAEC,MAAF,EAAc;AAAA,gBACHA,MAAM,CAAEwK,qEAAF,CADH;AAAA,MACjBC,SADiB,WACjBA,SADiB;;AAGzB,SAAO;AACN0D,mBAAe,EAAE1D,SAAS,CAAE,+BAAF;AADpB,GAAP;AAGA,CANS,CADW,EAQrBnI,qEAAY,CAAE,UAAEC,QAAF,EAAgB;AAAA,kBACJA,QAAQ,CAAE,cAAF,CADJ;AAAA,MACrBzB,YADqB,aACrBA,YADqB;;AAAA,mBAEHyB,QAAQ,CAAEiI,qEAAF,CAFL;AAAA,MAErBvD,aAFqB,cAErBA,aAFqB;;AAI7B,SAAO;AACNnG,gBAAY,EAAZA,YADM;AAENmG,iBAAa,EAAbA;AAFM,GAAP;AAIA,CARW,CARS,CAAP,CAiBZsG,UAjBY,CAAf,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpaA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;AAGA;AACA;AAKA;AAQA;;;;AAGA;AACA;AACA;AACA;;IAEMuD,Q;;;;;AACL,oBAAa5T,KAAb,EAAqB;AAAA;;AAAA;;AACpB,+BAAU6T,SAAV;AADoB,QAEZC,OAFY,GAEA9T,KAFA,CAEZ8T,OAFY;AAIpB,QAAMC,cAAc,GAAG,EAAvB;AACAD,WAAO,CAACxS,OAAR,CACC,UAAE+Q,MAAF;AAAA,aAAgB0B,cAAc,CAAE1B,MAAM,CAACjM,GAAT,CAAd,GAA+BiM,MAAM,CAAC2B,SAAtD;AAAA,KADD;AAGA,UAAK/T,KAAL,GAAa;AACZgU,gBAAU,EAAE,IADA;AAEZF,oBAAc,EAAdA,cAFY;AAGZG,uBAAiB,EAAE,MAAKC,oBAAL;AAHP,KAAb;AAMA,UAAKC,YAAL,GAAoB,MAAKA,YAAL,CAAkB3Q,IAAlB,4FAApB;AACA,UAAK4Q,cAAL,GAAsB,MAAKA,cAAL,CAAoB5Q,IAApB,4FAAtB;AACA,UAAK6Q,QAAL,GAAgB,MAAKA,QAAL,CAAc7Q,IAAd,4FAAhB;AAhBoB;AAiBpB;;;;yCAEoB;AAAA,UACZyQ,iBADY,GACU,KAAKjU,KADf,CACZiU,iBADY;AAGpB,UAAM7B,MAAM,GAAG,KAAK8B,oBAAL,EAAf;;AACA,UAAKD,iBAAiB,KAAK7B,MAA3B,EAAoC;AACnC,aAAK/R,QAAL,CAAe;AACd4T,2BAAiB,EAAE7B;AADL,SAAf;AAGA;AACD;;;2CAEsB;AAAA,UACdyB,OADc,GACF,KAAK9T,KADH,CACd8T,OADc;AAEtB,aAAOA,OAAO,CAACrS,IAAR,CAAc,UAAE8S,CAAF;AAAA,eAASA,CAAC,CAACnO,GAAF,KAAU,OAAV,IAAqBmO,CAAC,CAAClK,OAAhC;AAAA,OAAd,IACJ,OADI,GAEJ,QAFH;AAGA;;;;;;;;;;;8BAGiD,KAAKrK,K,EAA9C4D,Y,eAAAA,Y,EAAckQ,O,eAAAA,O,EAAS/J,a,eAAAA,a;;uBAEVA,aAAa,CAAE;AACnCyK,gDAA8B,EAAE;AAC/BrK,6BAAS,EAAE,CADoB;AAE/BsK,6BAAS,EAAEC,IAAI,CAACC,KAAL,CAAYC,IAAI,CAACC,GAAL,KAAa,IAAzB;AAFoB;AADG,iBAAF,C;;;AAA5B3B,sB;AAON1S,+EAAW,CAAE,uBAAF,EAA2B;AACrCsU,4BAAU,EAAEhB,OAAO,CACjBxM,MADU,CACF,UAAE+K,MAAF;AAAA,2BAAcA,MAAM,CAAC0C,YAArB;AAAA,mBADE,EAEVvO,GAFU,CAEL,UAAE6L,MAAF;AAAA,2BAAcA,MAAM,CAACjM,GAArB;AAAA,mBAFK;AADyB,iBAA3B,CAAX;;AAMA,oBAAK8M,MAAM,CAACC,OAAZ,EAAsB;AACrBvP,8BAAY,CACX,SADW,EAEXvB,2DAAE,CACD,oDADC,EAED,mBAFC,CAFS,CAAZ;AAQAuN,6FAAU,GAAGhO,IAAb,CAAmBiO,2EAAU,CAAE,EAAF,EAAM,GAAN,EAAW,EAAX,CAA7B;AACA,iBAVD,MAUO;AACNjM,8BAAY,CACX,OADW,EAEXvB,2DAAE,CACD,uCADC,EAED,mBAFC,CAFS,CAAZ;AAOA;;;;;;;;;;;;;;;;;;+BAGS;AAAA,yBACyB,KAAKrC,KAD9B;AAAA,UACF8T,OADE,gBACFA,OADE;AAAA,UACO/J,aADP,gBACOA,aADP;AAGVA,mBAAa,CAAE;AACdyK,sCAA8B,EAAE;AAC/BtF,iBAAO,EAAE,CADsB;AAE/BuF,mBAAS,EAAEC,IAAI,CAACC,KAAL,CAAYC,IAAI,CAACC,GAAL,KAAa,IAAzB;AAFoB;AADlB,OAAF,CAAb;AAOArU,qEAAW,CAAE,4BAAF,EAAgC;AAC1CkG,eAAO,EAAEoN,OAAO,CAACtN,GAAR,CAAa,UAAE6L,MAAF;AAAA,iBAAcA,MAAM,CAACjM,GAArB;AAAA,SAAb;AADiC,OAAhC,CAAX;AAIAwJ,iFAAU,GAAGhO,IAAb,CAAmBiO,2EAAU,CAAE,EAAF,EAAM,GAAN,EAAW,EAAX,CAA7B;AACA;;;mCAEewC,M,EAAS;AAAA,UAChB0B,cADgB,GACG,KAAK9T,KADR,CAChB8T,cADgB;AAGxB,WAAKzT,QAAL,CAAe;AACdyT,sBAAc,kCACVA,cADU,wFAEX1B,MAFW,EAED,IAFC;AADA,OAAf;AAOAzC,iFAAU,GAAGhO,IAAb,CAAmBiO,2EAAU,CAAE;AAAElG,YAAI,EAAE;AAAR,OAAF,EAAwB,GAAxB,EAA6B,EAA7B,CAA7B;AAEAnJ,qEAAW,CAAE,iCAAF,EAAqC;AAC/CwU,sBAAc,EAAE3C;AAD+B,OAArC,CAAX;AAGA;;;uCAEkB;AAAA,yBACS,KAAKrS,KADd;AAAA,UACV8T,OADU,gBACVA,OADU;AAAA,UACDtK,KADC,gBACDA,KADC;;AAGlB,UAAK,CAAEA,KAAK,CAAC6I,MAAb,EAAsB;AACrB;AACA;;AAED,aAAOyB,OAAO,CAACrS,IAAR,CAAc,UAAE4Q,MAAF;AAAA,eAAcA,MAAM,CAACjM,GAAP,KAAeoD,KAAK,CAAC6I,MAAnC;AAAA,OAAd,CAAP;AACA;;;qCAEgB;AAChB,UAAM4C,aAAa,GAAG,KAAKC,gBAAL,EAAtB;;AAEA,UAAK,CAAED,aAAa,CAACE,OAAhB,IAA2B,CAAEF,aAAa,CAACE,OAAd,CAAsB5U,MAAxD,EAAiE;AAChE;AACA;;AALe,UAOR8K,aAPQ,GAOU,KAAKrL,KAPf,CAORqL,aAPQ;AAQhB,UAAM+J,gBAAgB,GAAGH,aAAa,CAACE,OAAd,CAAsB7N,MAAtB,CACxB,UAAE+K,MAAF;AAAA,eAAc,CAAEhH,aAAa,CAACI,QAAd,CAAwB4G,MAAxB,CAAhB;AAAA,OADwB,CAAzB;AAGA,UAAMgD,iBAAiB,GAAGJ,aAAa,CAACE,OAAd,CACxB3O,GADwB,CACnB,UAAE8O,UAAF;AAAA,eAAkBC,8DAAW,CAAED,UAAF,CAA7B;AAAA,OADmB,EAExBzU,IAFwB,CAElB,MAAMwB,2DAAE,CAAE,KAAF,EAAS,mBAAT,CAAR,GAAyC,GAFvB,CAA1B;AAIA,aAAO;AACN+D,WAAG,EAAE,SADC;AAENtE,aAAK,EAAEM,gEAAO,CACbC,2DAAE,CAAE,YAAF,EAAgB,mBAAhB,CADW,EAEbgT,iBAFa,CAFR;AAMNtT,eAAO,EACN,yEAAC,gEAAD;AACC,oBAAU,EAAG,sBAAM;AAClBvB,2EAAW,CAAE,iCAAF,EAAqC;AAC/C2U,qBAAO,EAAEF,aAAa,CAACE;AADwB,aAArC,CAAX;AAGA,WALF;AAMC,qBAAW,MANZ;AAOC,qBAAW,EAAGF,aAAa,CAACE;AAP7B,UAPK;AAiBNK,kBAAU,EAAE,CAAEJ,gBAAgB,CAAC7U;AAjBzB,OAAP;AAmBA;;;iCAEa6F,G,EAAM;AAAA,yBACyB,KAAKpG,KAD9B;AAAA,UACX8T,OADW,gBACXA,OADW;AAAA,UACFpN,OADE,gBACFA,OADE;AAAA,UACOqD,aADP,gBACOA,aADP;AAAA,UAEXgK,cAFW,GAEQ,KAAK9T,KAFb,CAEX8T,cAFW;AAGnB,UAAM1B,MAAM,GAAGyB,OAAO,CAACrS,IAAR,CAAc,UAAE8F,MAAF;AAAA,eAAcA,MAAM,CAACnB,GAAP,KAAeA,GAA7B;AAAA,OAAd,CAAf;AAEA2N,oBAAc,CAAE3N,GAAF,CAAd,GAAwB,CAAE2N,cAAc,CAAE3N,GAAF,CAAxC;AACA,WAAK9F,QAAL,CAAe;AAAEyT,sBAAc,EAAdA;AAAF,OAAf;AAEAvT,qEAAW,CAAE,yBAAF,EAA6B;AACvCiV,eAAO,EAAE,CAAEpD,MAAM,CAAC2B,SADqB;AAEvCgB,sBAAc,EAAE5O;AAFuB,OAA7B,CAAX;AAKA2D,mBAAa,CAAC,iFACXsI,MAAM,CAACqD,UADG,kCAERhP,OAAO,CAAE2L,MAAM,CAACqD,UAAT,CAFC;AAGXD,eAAO,EAAEpD,MAAM,CAAC2B,SAAP,GAAmB,IAAnB,GAA0B;AAHxB,UAAb;AAMA;;;;+MAEkB3B,M;;;;;;;;AACVyB,uB,GAAY,KAAK9T,K,CAAjB8T,O;AACA1N,mB,GAAiBiM,M,CAAjBjM,G,EAAKyE,O,GAAYwH,M,CAAZxH,O;AAEbrK,+EAAW,CAAE,wBAAF,EAA4B;AACtCkG,yBAAO,EAAEoN,OAAO,CAACtN,GAAR,CAAa,UAAEe,MAAF;AAAA,2BAAcA,MAAM,CAACnB,GAArB;AAAA,mBAAb,CAD6B;AAEtCuP,0BAAQ,EAAEvP;AAF4B,iBAA5B,CAAX;;qBAKKyE,O;;;;;AACJ,qBAAKvK,QAAL,CAAe;AAAE2T,4BAAU,EAAE7N;AAAd,iBAAf;;uBACM,IAAI0J,OAAJ,CAAajF,OAAb,EACJgH,IADI,CACE,YAAM;AACZ,wBAAI,CAACvR,QAAL,CAAe;AAAE2T,8BAAU,EAAE;AAAd,mBAAf;AACA,iBAHI,EAIJxB,KAJI,CAIG,YAAM;AACb,wBAAI,CAACnS,QAAL,CAAe;AAAE2T,8BAAU,EAAE;AAAd,mBAAf;AACA,iBANI,C;;;;;;AAWPhH,kGAAiB,CAAE;AAClBoF,wBAAM,EAAEjM;AADU,iBAAF,CAAjB;;;;;;;;;;;;;;;;;;6BAKQ;AAAA;;AACR,UAAM6O,aAAa,GAAG,KAAKC,gBAAL,EAAtB;AADQ,wBAEkD,KAAKjV,KAFvD;AAAA,UAEAgU,UAFA,eAEAA,UAFA;AAAA,UAEYF,cAFZ,eAEYA,cAFZ;AAAA,UAE4BG,iBAF5B,eAE4BA,iBAF5B;AAAA,yBAG+B,KAAKlU,KAHpC;AAAA,UAGA8T,OAHA,gBAGAA,OAHA;AAAA,UAGStK,KAHT,gBAGSA,KAHT;AAAA,UAGgBoM,UAHhB,gBAGgBA,UAHhB;AAIR,UAAMC,iBAAiB,GAAGC,MAAM,CAACC,IAAP,CAAahC,cAAb,EAA8BzM,MAA9B,CACzB,UAAE+K,MAAF;AAAA,eAAc0B,cAAc,CAAE1B,MAAF,CAA5B;AAAA,OADyB,EAExB9R,MAFF;;AAIA,UAAK0U,aAAL,EAAqB;AACpB,eACC,yEAAC,6DAAD;AAAM,mBAAS,EAAC;AAAhB,WACG9H,uEAAY,CAAE8H,aAAa,CAAC7H,SAAhB,EAA2B;AACxC5D,eAAK,EAALA,KADwC;AAExCwM,qBAAW,EAAE,KAAKC,cAAL,EAF2B;AAGxC5B,wBAAc,EAAE,KAAKA,cAHmB;AAIxC6B,wBAAc,EAAEjB,aAAa,CAACiB;AAJU,SAA3B,CADf,CADD;AAUA;;AAED,aACC;AAAK,iBAAS,EAAC;AAAf,SACGpC,OAAO,CAACtN,GAAR,CAAa,UAAE6L,MAAF,EAAc;AAAA,YAE3B5F,MAF2B,GASxB4F,MATwB,CAE3B5F,MAF2B;AAAA,YAG3BW,SAH2B,GASxBiF,MATwB,CAG3BjF,SAH2B;AAAA,YAI3BrL,OAJ2B,GASxBsQ,MATwB,CAI3BtQ,OAJ2B;AAAA,YAK3BgT,YAL2B,GASxB1C,MATwB,CAK3B0C,YAL2B;AAAA,YAM3B3O,GAN2B,GASxBiM,MATwB,CAM3BjM,GAN2B;AAAA,YAO3BvE,KAP2B,GASxBwQ,MATwB,CAO3BxQ,KAP2B;AAAA,YAQ3BwI,OAR2B,GASxBgI,MATwB,CAQ3BhI,OAR2B;;AAW5B,YAAK,CAAEA,OAAP,EAAiB;AAChB,iBAAO,IAAP;AACA;;AAED,YAAM8L,OAAO,GAAGC,kDAAU,CACzB,0BADyB,EAEzB,WAFyB,EAGzB,CAAErB,YAAF,IACC,yCAJwB,EAKzB,8BAA8B3O,GALL,CAA1B;AAQA,YAAMiQ,aAAa,GAClBjQ,GAAG,KAAK8N,iBAAR,IAA6B,CAAEa,YADhC;AAEA,YAAMuB,qBAAqB,GAC1BD,aAAa,IAAIjQ,GAAG,KAAK,OAD1B;AAEA,YAAMmQ,mBAAmB,GACxBF,aAAa,IAAIjQ,GAAG,KAAK,OAD1B;AAGA,eACC,yEAAC,6DAAD;AAAM,aAAG,EAAGA,GAAZ;AAAkB,mBAAS,EAAG+P;AAA9B,WACC;AAAK,mBAAS,EAAC;AAAf,WACGG,qBAAqB,IACtB;AAAK,mBAAS,EAAC;AAAf,WACC,uFACGjU,2DAAE,CACH,aADG,EAEH,mBAFG,CADL,CADD,CAFF,EAWGoK,MAXH,CADD,EAcC;AAAK,mBAAS,EAAC;AAAf,WACC,yEAAC,0DAAD;AAAG,mBAAS,EAAC;AAAb,WACG5K,KADH,EAEG0U,mBAAmB,IACpB;AAAM,mBAAS,EAAC;AAAhB,WACGlU,2DAAE,CACH,aADG,EAEH,mBAFG,CADL,CAHF,CADD,EAYC;AAAK,mBAAS,EAAC;AAAf,WACGN,OADH,CAZD,CAdD,EA8BC;AAAK,mBAAS,EAAC;AAAf,WACGqL,SAAS,IAAI,CAAE2H,YAAf,GACD,yEAAC,6DAAD;AACC,mBAAS,EAAG3O,GAAG,KAAK8N,iBADrB;AAEC,qBAAW,EACV9N,GAAG,KAAK8N,iBAHV;AAKC,gBAAM,EAAGD,UAAU,KAAK7N,GALzB;AAMC,kBAAQ,EAAG6N,UANZ;AAOC,iBAAO,EAAG;AAAA,mBACT,MAAI,CAACuC,WAAL,CAAkBnE,MAAlB,CADS;AAAA;AAPX,WAWGhQ,2DAAE,CAAE,QAAF,EAAY,mBAAZ,CAXL,CADC,GAeD,yEAAC,iEAAD;AACC,iBAAO,EAAG0R,cAAc,CAAE3N,GAAF,CADzB;AAEC,kBAAQ,EAAG;AAAA,mBACV,MAAI,CAACqQ,YAAL,CAAmBrQ,GAAnB,CADU;AAAA,WAFZ;AAKC,iBAAO,EAAG,iBAAEsQ,CAAF;AAAA,mBAASA,CAAC,CAAC5J,eAAF,EAAT;AAAA;AALX,UAhBF,CA9BD,CADD;AA0DA,OAxFC,CADH,EA0FC;AAAK,iBAAS,EAAC;AAAf,SACG,CAAE+I,iBAAF,GACD,yEAAC,6DAAD;AAAQ,cAAM,MAAd;AAAe,eAAO,EAAG,KAAKvB;AAA9B,SACGjS,2DAAE,CACH,gCADG,EAEH,mBAFG,CADL,CADC,GAQD,yEAAC,6DAAD;AACC,iBAAS,MADV;AAEC,cAAM,EAAGuT,UAFV;AAGC,eAAO,EAAG,KAAKxB;AAHhB,SAKG/R,2DAAE,CAAE,MAAF,EAAU,mBAAV,CALL,CATF,CA1FD,CADD;AA+GA;;;;EA/UqBM,4D;;AAkVRC,kIAAO,CACrBwC,qEAAY,CAAE,UAAEC,QAAF,EAAgB;AAAA,kBACJA,QAAQ,CAAE,cAAF,CADJ;AAAA,MACrBzB,YADqB,aACrBA,YADqB;;AAAA,mBAESyB,QAAQ,CAAEtC,qEAAF,CAFjB;AAAA,MAErBuI,yBAFqB,cAErBA,yBAFqB;;AAAA,mBAGHjG,QAAQ,CAAEiI,qEAAF,CAHL;AAAA,MAGrBvD,aAHqB,cAGrBA,aAHqB;;AAI7B,SAAO;AACNnG,gBAAY,EAAZA,YADM;AAEN0H,6BAAyB,EAAzBA,yBAFM;AAGNvB,iBAAa,EAAbA;AAHM,GAAP;AAKA,CATW,CADS,EAWrBlH,mEAAU,CAAE,UAAEC,MAAF,EAAU9C,KAAV,EAAqB;AAAA,MACxB4D,YADwB,GACoB5D,KADpB,CACxB4D,YADwB;AAAA,MACV0H,yBADU,GACoBtL,KADpB,CACVsL,yBADU;;AAAA,gBAEJxI,MAAM,CAAEG,wEAAF,CAFF;AAAA,MAExBC,eAFwB,WAExBA,eAFwB;;AAAA,iBAGSJ,MAAM,CAAEwK,qEAAF,CAHf;AAAA,MAGxBC,SAHwB,YAGxBA,SAHwB;AAAA,MAGboJ,iBAHa,YAGbA,iBAHa;;AAAA,iBAIiB7T,MAAM,CACtDC,qEADsD,CAJvB;AAAA,MAIxB2K,gBAJwB,YAIxBA,gBAJwB;AAAA,MAINnC,kBAJM,YAINA,kBAJM;;AAAA,iBAORzI,MAAM,CAAE0K,sEAAF,CAPE;AAAA,MAOxBC,WAPwB,YAOxBA,WAPwB;;AAAA,qBAQUA,WAAW,CAAE,SAAF,CARrB;AAAA,0CAQxBG,OARwB;AAAA,MAQfC,eARe,qCAQG,EARH;;AAUhC,MAAMxC,aAAa,GAAGqC,gBAAgB,EAAtC;AACA,MAAMvK,YAAY,GAAGD,eAAe,EAApC;AAEA,MAAM0T,WAAW,GAAG,CACnB,2CADmB,EAEnB,6BAFmB,EAGnB,kCAHmB,EAInB,8BAJmB,EAKnB,yCALmB,EAMnB,sCANmB,EAOnB,0BAPmB,EAQnB,0BARmB,EASnB,0BATmB,EAUnB,2BAVmB,EAWnB,2BAXmB,EAYnB,2BAZmB,CAApB;AAeA,MAAMlQ,OAAO,GAAGkQ,WAAW,CAAC5Q,MAAZ,CAAoB,UAAEsM,MAAF,EAAUhM,IAAV,EAAoB;AACvDgM,UAAM,CAAEhM,IAAF,CAAN,GAAiBiH,SAAS,CAAEjH,IAAF,CAA1B;AACA,WAAOgM,MAAP;AACA,GAHe,EAGb,EAHa,CAAhB;AAIA,MAAMnH,WAAW,GAAG2C,uEAAc,CACjCD,eAAe,CAACE,2BADiB,CAAlC;AAIA,MAAM+F,OAAO,GAAG+C,mEAAiB,CAAE;AAClCxL,iBAAa,EAAbA,aADkC;AAElCF,eAAW,EAAXA,WAFkC;AAGlCvH,gBAAY,EAAZA,YAHkC;AAIlC0H,6BAAyB,EAAzBA,yBAJkC;AAKlCC,sBAAkB,EAAEA,kBAAkB,EALJ;AAMlC7E,WAAO,EAAPA,OANkC;AAOlCvD,gBAAY,EAAZA;AAPkC,GAAF,CAAjC;AAUA,MAAMyS,UAAU,GAAGe,iBAAiB,EAApC;AAEA,SAAO;AACNxL,eAAW,EAAXA,WADM;AAENhI,gBAAY,EAAZA,YAFM;AAGNkI,iBAAa,EAAbA,aAHM;AAIN3E,WAAO,EAAPA,OAJM;AAKNoN,WAAO,EAAPA,OALM;AAMN8B,cAAU,EAAVA;AANM,GAAP;AAQA,CAxDS,CAXW,CAAP,CAoEZhC,QApEY,CAAf,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrXA;;;AAGA;AACA;AAEA;;;;AAGA;AACA;AAEA;;;;AAGA;AAEA,IAAMkD,QAAQ,GAAG,CAChB;AACCjV,OAAK,EAAEQ,0DAAE,CAAE,4BAAF,EAAgC,mBAAhC,CADV;AAECN,SAAO,EAAEM,0DAAE,CACV,wDADU,EAEV,mBAFU,CAFZ;AAMCoK,QAAM,EAAE;AAAG,aAAS,EAAC;AAAb,eANT;AAOCG,OAAK,EAAE;AAAG,aAAS,EAAC;AAAb,qBAPR;AAQC/B,SAAO,EAAE;AAAA,WACRrK,8DAAW,CAAE,sBAAF,EAA0B;AAAE6R,YAAM,EAAE;AAAV,KAA1B,CADH;AAAA,GARV;AAUClN,MAAI,EAAE4R,mFAAY,CACjB,iFADiB;AAVnB,CADgB,EAehB;AACClV,OAAK,EAAEQ,0DAAE,CAAE,QAAF,EAAY,mBAAZ,CADV;AAECN,SAAO,EAAEM,0DAAE,CACV,4EADU,EAEV,mBAFU,CAFZ;AAMCoK,QAAM,EAAE;AAAG,aAAS,EAAC;AAAb,qBANT;AAOCG,OAAK,EAAE;AAAG,aAAS,EAAC;AAAb,qBAPR;AAQC/B,SAAO,EAAE;AAAA,WACRrK,8DAAW,CAAE,sBAAF,EAA0B;AAAE6R,YAAM,EAAE;AAAV,KAA1B,CADH;AAAA,GARV;AAUClN,MAAI,EAAE4R,mFAAY,CACjB,2FADiB;AAVnB,CAfgB,EA6BhB;AACClV,OAAK,EAAEQ,0DAAE,CAAE,SAAF,EAAa,mBAAb,CADV;AAECN,SAAO,EAAEM,0DAAE,CACV,qFADU,EAEV,mBAFU,CAFZ;AAMCoK,QAAM,EAAE;AAAG,aAAS,EAAC;AAAb,sBANT;AAOCG,OAAK,EAAE;AAAG,aAAS,EAAC;AAAb,qBAPR;AAQC/B,SAAO,EAAE;AAAA,WACRrK,8DAAW,CAAE,sBAAF,EAA0B;AAAE6R,YAAM,EAAE;AAAV,KAA1B,CADH;AAAA,GARV;AAUC;AACAlN,MAAI,EAAE,6CAXP;AAYC2C,QAAM,EAAE;AAZT,CA7BgB,CAAjB;;IA6CqBkP,Q;;;;;;;;;;;;;6BACX;AACR,aACC,yEAAC,2DAAD,QACC,yEAAC,4DAAD;AAAM,iBAAS,EAAC;AAAhB,SACC,yEAAC,4DAAD;AAAM,aAAK,EAAGF;AAAd,QADD,CADD,CADD;AAOA;;;;EAToCnU,4D;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9DtC;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;AAGA;AACA;AACA;AACA;AAEA;;;;AAGA;AACA;AACA;AACA;AACA;;IAEMsU,Q;;;;;AACL,oBAAajX,KAAb,EAAqB;AAAA;;AAAA;;AACpB,8BAAOA,KAAP;AAEA,UAAKkX,YAAL,GAAoB;AACnBvG,eAAS,EAAE,KADQ;AAEnB+C,UAAI,EAAE,gBAFa;AAGnByD,mBAAa,EAAE;AAHI,KAApB,CAHoB,CASpB;;AACA,UAAK9L,aAAL,GAAqBrL,KAAK,CAACqL,aAA3B;AACA,UAAKpL,KAAL,GAAa,MAAKiX,YAAlB;AACA,UAAKhG,YAAL,GAAoB,MAAKA,YAAL,CAAkBzN,IAAlB,4FAApB;AAZoB;AAapB;;;;wCAEmB;AACnB,WAAK2T,KAAL;AACA;;;4BAEO;AACP,WAAK9W,QAAL,CAAe,KAAK4W,YAApB;AACA;;;;;;;;;;;AAGA,qBAAK5W,QAAL,CAAe;AAAEqQ,2BAAS,EAAE;AAAb,iBAAf;8BACqC,KAAK3Q,K,EAAlCmL,W,eAAAA,W,EAAakM,W,eAAAA,W,EAErB;AACA;;AACMF,6B,GAAgB,E;;uBACFjF,4DAAQ,CAAE;AAAEC,sBAAI,EAAE;AAAR,iBAAF,C;;;AAAtBmF,qB;AACFC,8B,GAAiB,K;;uBAEfzH,OAAO,CAAC0H,GAAR,CACLF,KAAK,CAAC9Q,GAAN;AAAA,iMAAW,iBAAQiR,IAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kCAELA,IAAI,CAACtV,EAAL,KAAY,CAFP;AAAA;AAAA;AAAA;;AAAA;AAAA,mCAGY+P,4DAAQ,CAAE;AAC9BC,kCAAI,kCAA4BsF,IAAI,CAACtV,EAAjC;AAD0B,6BAAF,CAHpB;;AAAA;AAGTsV,gCAAI,CAAC3D,OAHI;AAMT2D,gCAAI,CAACnR,IAAL,GAAYjE,2DAAE,CAAE,mBAAF,EAAuB,mBAAvB,CAAd;AACAoV,gCAAI,CAACC,UAAL,GAAkB,IAAlB;AACAP,yCAAa,CAACvV,IAAd,CAAoB6V,IAApB;AARS;;AAAA;AAAA;AAAA,mCAaavF,4DAAQ,CAAE;AAChCC,kCAAI,kCAA4BsF,IAAI,CAACtV,EAAjC;AAD4B,6BAAF,CAbrB;;AAAA;AAaVsV,gCAAI,CAACE,SAbK;AAgBJC,2CAhBI,GAgBcH,IAAI,CAACE,SAAL,CAAelW,IAAf,CACvB,UAAEV,QAAF;AAAA,qCAAgBoK,WAAW,KAAKpK,QAAQ,CAACsF,IAAzC;AAAA,6BADuB,CAhBd;;AAAA,iCAmBLuR,eAnBK;AAAA;AAAA;AAAA;;AAAA;AAAA,mCAoBY1F,4DAAQ,CAAE;AAC9BC,kCAAI,kCAA4BsF,IAAI,CAACtV,EAAjC;AAD0B,6BAAF,CApBpB;;AAAA;AAoBTsV,gCAAI,CAAC3D,OApBI;AAuBTqD,yCAAa,CAACvV,IAAd,CAAoB6V,IAApB;AACAF,0CAAc,GAAG,IAAjB;;AAxBS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAX;;AAAA;AAAA;AAAA;AAAA,oBADK,C;;;oBA+BCA,c;;;;;;uBACarF,4DAAQ,CAAE;AAC5BG,wBAAM,EAAE,MADoB;AAE5BF,sBAAI,EAAE,uBAFsB;AAG5B0F,sBAAI,EAAE;AAAEvR,wBAAI,EAAE+Q;AAAR;AAHsB,iBAAF,C;;;AAArBI,oB;;uBAKiBvF,4DAAQ,CAAE;AAChCG,wBAAM,EAAE,MADwB;AAEhCF,sBAAI,kCAA4BsF,IAAI,CAACtV,EAAjC,eAF4B;AAGhC0V,sBAAI,EAAE,CAAE;AAAExR,wBAAI,EAAE8E,WAAR;AAAqBuE,wBAAI,EAAE;AAA3B,mBAAF;AAH0B,iBAAF,C;;;AAA/B+H,oBAAI,CAACE,S;AAKLR,6BAAa,CAACvV,IAAd,CAAoB6V,IAApB;;;AAGDN,6BAAa,CAACW,OAAd;AAEA,qBAAKxX,QAAL,CAAe;AAAEqQ,2BAAS,EAAE,KAAb;AAAoBwG,+BAAa,EAAbA;AAApB,iBAAf;;;;;;;;;;;;;;;;;;uCAGmBxT,S,EAAWoU,S,EAAY;AAAA,yBACR,KAAK/X,KADG;AAAA,UAClCmL,WADkC,gBAClCA,WADkC;AAAA,UACrB6M,QADqB,gBACrBA,QADqB;AAAA,UAGdC,YAHc,GAMtCD,QANsC,CAGzCE,yBAHyC;AAAA,UAIZC,cAJY,GAMtCH,QANsC,CAIzCjK,2BAJyC;AAAA,UAKbqK,aALa,GAMtCJ,QANsC,CAKzCK,0BALyC;AAAA,UAOlC3E,IAPkC,GAOzB,KAAKzT,KAPoB,CAOlCyT,IAPkC;;AAS1C,UACCA,IAAI,KAAK,OAAT,KACE/P,SAAS,CAACwH,WAAV,KAA0BA,WAA1B,IACD4M,SAAS,CAACrE,IAAV,KAAmB,OAFpB,CADD,EAIE;AACD,aAAK4E,kBAAL;AACA;;AAED,UAAMC,iBAAiB,GAAGvJ,OAAO,CAChCiJ,YAAY,IAAIE,cAAhB,IAAkCC,aADF,CAAjC;;AAIA,UAAK1E,IAAI,KAAK,gBAAT,IAA6B6E,iBAAlC,EAAsD;AACrD,aAAKrH,YAAL;AACA;AACD;;;mCAEc;AAAA,UACNtN,YADM,GACW,KAAK5D,KADhB,CACN4D,YADM;AAAA,UAEN8P,IAFM,GAEG,KAAKzT,KAFR,CAENyT,IAFM;AAGd,UAAMF,KAAK,GAAG,KAAKvB,QAAL,EAAd;AACA,UAAMuG,gBAAgB,GAAGhF,KAAK,CAACiF,SAAN,CAAiB,UAAEpM,CAAF;AAAA,eAASA,CAAC,CAACjG,GAAF,KAAUsN,IAAnB;AAAA,OAAjB,CAAzB;AACA,UAAM1B,QAAQ,GAAGwB,KAAK,CAAEgF,gBAAgB,GAAG,CAArB,CAAtB;;AAEA,UAAKxG,QAAL,EAAgB;AACf,aAAK1R,QAAL,CAAe;AAAEoT,cAAI,EAAE1B,QAAQ,CAAC5L;AAAjB,SAAf;AACA,OAFD,MAEO;AACNxC,oBAAY,CACX,SADW,EAEXvB,2DAAE,CACD,mEADC,EAED,mBAFC,CAFS,CAAZ;AAOAuN,mFAAU,GAAGhO,IAAb,CAAmBiO,2EAAU,CAAE,EAAF,EAAM,GAAN,EAAW,EAAX,CAA7B;AACA;AACD;;;2CAEsB;AAAA,UACd1E,WADc,GACE,KAAKnL,KADP,CACdmL,WADc;AAGtB,UAAMgK,OAAO,GAAG,EAAhB;;AACA,UAAK,CAAE,IAAF,EAAQ,IAAR,EAAc,IAAd,EAAqB1J,QAArB,CAA+BN,WAA/B,CAAL,EAAoD;AACnDgK,eAAO,CAACvT,IAAR,CAAc,qCAAd;AACA,OAFD,MAEO,IAAKuJ,WAAW,KAAK,IAArB,EAA4B;AAClCgK,eAAO,CAACvT,IAAR,CAAc,sBAAd;AACAuT,eAAO,CAACvT,IAAR,CAAc,SAAd;AACA;;AACD,aAAO8W,0DAAU,CAAEvD,OAAF,EAAW,KAAK9J,aAAhB,CAAjB;AACA;;;+BAEU;AAAA;;AAAA,yBACkC,KAAKrL,KADvC;AAAA,UACFmL,WADE,gBACFA,WADE;AAAA,UACWI,kBADX,gBACWA,kBADX;AAEV,UAAMoN,iBAAiB,GAAG,KAAKC,oBAAL,EAA1B;AACA,UAAMC,yBAAyB,GAC9B,CAAEtN,kBAAF,IAAwBJ,WAAW,KAAK,IADzC;AAGA,UAAMqI,KAAK,GAAG,CACb;AACCpN,WAAG,EAAE,gBADN;AAECtE,aAAK,EAAEO,2DAAE,CAAE,oBAAF,EAAwB,mBAAxB,CAFV;AAGCL,mBAAW,EAAEK,2DAAE,CACd,+CADc,EAEd,mBAFc,CAHhB;AAOCN,eAAO,EACN,yEAAC,wDAAD,4EACM,KAAK/B,KADX;AAEC,oBAAU,EAAG,oBAAEwF,MAAF,EAAc;AAC1B,gBAAMU,OAAO,GAAG4H,uEAAc,CAC7BtI,MAAM,CAACG,YADsB,CAA9B;AAGAnF,2EAAW,CAAE,gCAAF,EAAoC;AAC9C0F,qBAAO,EAAPA;AAD8C,aAApC,CAAX;;AAGA,kBAAI,CAACgL,YAAL;AACA;AAVF,WARF;AAqBC7G,eAAO,EAAE;AArBV,OADa,EAwBb;AACCjE,WAAG,EAAE,OADN;AAECtE,aAAK,EAAEO,2DAAE,CAAE,oBAAF,EAAwB,mBAAxB,CAFV;AAGCL,mBAAW,EAAEK,2DAAE,CACd,iEADc,EAEd,mBAFc,CAHhB;AAOCN,eAAO,EACN,yEAAC,+CAAD;AACC,oBAAU,EACT4W,iBAAiB,CAACpY,MAAlB,IACAsY,yBADA,GAEGxW,2DAAE,CAAE,SAAF,EAAa,mBAAb,CAFL,GAGGA,2DAAE,CAAE,eAAF,EAAmB,mBAAnB,CALP;AAOC,uBAAa,EAAG,KAAKpC,KAAL,CAAWkX,aAP5B;AAQC,oBAAU,EAAG,KAAKjG;AARnB,WASM,KAAKlR,KATX,EARF;AAoBCqK,eAAO,EAAE;AApBV,OAxBa,EA8Cb;AACCjE,WAAG,EAAE,gBADN;AAECtE,aAAK,EAAEO,2DAAE,CACR,gCADQ,EAER,mBAFQ,CAFV;AAMCL,mBAAW,EAAE2W,iBAAiB,CAAClN,QAAlB,CACZ,qCADY,IAGVqN,8DAAqB,CAAE;AACvBC,qBAAW,EAAE1W,2DAAE,CACd,8FACC,gFAFa,EAGd,mBAHc,CADQ;AAMvB2W,oBAAU,EAAE;AACXC,gBAAI,EACH,yEAAC,6DAAD;AACC,kBAAI,EAAC,0DADN;AAEC,oBAAM,EAAC,QAFR;AAGC,kBAAI,EAAC;AAHN;AAFU;AANW,SAAF,CAHX,GAmBV5W,2DAAE,CACF,oEACC,sDAFC,EAGF,mBAHE,CAzBN;AA8BCN,eAAO,EACN,yEAAC,gEAAD;AACC,oBAAU,EAAG,sBAAM;AAClBvB,2EAAW,CAAE,kCAAF,EAAsC;AAChD0Y,qBAAO,EAAE,IADuC;AAEhDP,+BAAiB,EAAjBA;AAFgD,aAAtC,CAAX;;AAIA,kBAAI,CAACzH,YAAL;AACA,WAPF;AAQC,gBAAM,EAAG,kBAAM;AACd1Q,2EAAW,CAAE,kCAAF,EAAsC;AAChD0Y,qBAAO,EAAE,KADuC;AAEhDP,+BAAiB,EAAjBA;AAFgD,aAAtC,CAAX;AAIA/I,uFAAU,GAAGhO,IAAb,CAAmBiO,2EAAU,CAAE,EAAF,EAAM,GAAN,EAAW,EAAX,CAA7B;AACA,WAdF;AAeC,qBAAW,EAAG8I;AAff,WAgBM,KAAK3Y,KAhBX,EA/BF;AAkDCqK,eAAO,EAAEsO,iBAAiB,CAACpY;AAlD5B,OA9Ca,EAkGb;AACC6F,WAAG,EAAE,SADN;AAECtE,aAAK,EAAEO,2DAAE,CAAE,oBAAF,EAAwB,mBAAxB,CAFV;AAGCL,mBAAW,EAAEK,2DAAE,CACd,8DADc,EAEd,mBAFc,CAHhB;AAOCN,eAAO,EACN,yEAAC,qEAAD;AACC,qBAAW,EAAGgV,oFAAY,CACzB,yBADyB,CAD3B;AAIC,sBAAY,EAAG,KAAK7F;AAJrB,WAKM,KAAKlR,KALX;AAMC,mBAAS,EAAG,qBAAM;AACjBQ,2EAAW,CAAE,iCAAF,CAAX;AACA;AARF,WARF;AAmBC6J,eAAO,EAAEwO;AAnBV,OAlGa,CAAd;AAyHA,aAAOvR,sDAAM,CAAEkM,KAAF,EAAS,UAAEE,IAAF;AAAA,eAAYA,IAAI,CAACrJ,OAAjB;AAAA,OAAT,CAAb;AACA;;;6BAEQ;AAAA,wBACoB,KAAKpK,KADzB;AAAA,UACA0Q,SADA,eACAA,SADA;AAAA,UACW+C,IADX,eACWA,IADX;AAAA,UAEAyF,0BAFA,GAE+B,KAAKnZ,KAFpC,CAEAmZ,0BAFA;AAIR,aACC;AAAK,iBAAS,EAAC;AAAf,SACC,yEAAC,6DAAD;AAAM,iBAAS,EAAC;AAAhB,SACC,yEAAC,gEAAD;AACC,iBAAS,EAAGxI,SAAS,IAAIwI,0BAD1B;AAEC,kBAAU,MAFX;AAGC,mBAAW,EAAGzF,IAHf;AAIC,aAAK,EAAG,KAAKzB,QAAL;AAJT,QADD,CADD,CADD;AAYA;;;;EAlSqBtP,4D;;AAqSRC,kIAAO,CACrBC,mEAAU,CAAE,UAAEC,MAAF,EAAc;AAAA,gBAC2BA,MAAM,CACzD0K,sEADyD,CADjC;AAAA,MACjBC,WADiB,WACjBA,WADiB;AAAA,MACJ0L,0BADI,WACJA,0BADI;;AAAA,iBAIwBrW,MAAM,CACtDC,qEADsD,CAJ9B;AAAA,MAIjB2K,gBAJiB,YAIjBA,gBAJiB;AAAA,MAICnC,kBAJD,YAICA,kBAJD;;AAAA,qBAQUkC,WAAW,CAAE,SAAF,CARrB;AAAA,0CAQjBG,OARiB;AAAA,MAQRoK,QARQ,qCAQG,EARH;;AASzB,MAAM7M,WAAW,GAAG2C,uEAAc,CACjCkK,QAAQ,CAACjK,2BADwB,CAAlC;;AATyB,oBAaE7M,kFAAU,CAAE,eAAF,EAAmB,EAAnB,CAbZ;AAAA,0CAajBoE,SAbiB;AAAA,MAajBA,SAbiB,sCAaL,EAbK;;AAczB,MAAMY,OAAO,GAAGiF,WAAW,GACxB7F,SAAS,CAAC7D,IAAV,CAAgB,UAAE2X,CAAF;AAAA,WAASA,CAAC,CAAC/S,IAAF,KAAW8E,WAApB;AAAA,GAAhB,CADwB,GAExB,IAFH;AAGA,MAAMkM,WAAW,GAAGnR,OAAO,GAAGA,OAAO,CAACI,IAAX,GAAkB,IAA7C;AACA,MAAM+E,aAAa,GAAGqC,gBAAgB,EAAtC;AAEA,SAAO;AACNvC,eAAW,EAAXA,WADM;AAENkM,eAAW,EAAXA,WAFM;AAGN8B,8BAA0B,EAAEA,0BAA0B,CAAE,SAAF,CAHhD;AAINnB,YAAQ,EAARA,QAJM;AAKN3M,iBAAa,EAAbA,aALM;AAMNE,sBAAkB,EAAEA,kBAAkB;AANhC,GAAP;AAQA,CA5BS,CADW,EA8BrBnG,qEAAY,CAAE,UAAEC,QAAF,EAAgB;AAAA,kBACJA,QAAQ,CAAE,cAAF,CADJ;AAAA,MACrBzB,YADqB,aACrBA,YADqB;;AAAA,mBAEgByB,QAAQ,CACpDmI,sEADoD,CAFxB;AAAA,MAErB6L,gCAFqB,cAErBA,gCAFqB;;AAM7B,SAAO;AACNzV,gBAAY,EAAZA,YADM;AAENyV,oCAAgC,EAAhCA;AAFM,GAAP;AAIA,CAVW,CA9BS,CAAP,CAyCZpC,QAzCY,CAAf,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjUA;;;AAGA;AACA;AACA;AACA;AACA;AAEA;;;;AAGA;AACA;AAEA;;;;AAGA;AACA;;IAEMqC,a;;;;;AACL,2BAAc;AAAA;;AAAA;;AACb,+BAAUzF,SAAV;AAEA,UAAK0F,mBAAL,GAA2B,MAAKA,mBAAL,CAAyB9V,IAAzB,4FAA3B;AAHa;AAIb;;;;uCAEmBgU,I,EAAoB;AAAA,UAAd/H,IAAc,uEAAP,IAAO;;AACvC;AACA,UAAK,CAAE+H,IAAF,IAAU,CAAEA,IAAI,CAAC3D,OAAjB,IAA4B,CAAE0F,KAAK,CAACC,OAAN,CAAehC,IAAI,CAAC3D,OAApB,CAAnC,EAAmE;AAClE,eAAO,EAAP;AACA;;AAED,UAAK,CAAEpE,IAAP,EAAc;AACb,eAAO+H,IAAI,CAAC3D,OAAZ;AACA;;AAED,aAAO2D,IAAI,CAAC3D,OAAL,GACJ2D,IAAI,CAAC3D,OAAL,CAAaxM,MAAb,CAAqB,UAAE+K,MAAF;AAAA,eAAcA,MAAM,CAACqH,SAAP,KAAqBhK,IAAnC;AAAA,OAArB,CADI,GAEJ,EAFH;AAGA;;;2CAEuB+H,I,EAAM3D,O,EAAU;AACvC,UAAK,CAAEA,OAAO,CAACvT,MAAf,EAAwB;AACvB;AACA;;AAEDuT,aAAO,CAACxS,OAAR,CAAiB,UAAE+Q,MAAF,EAAc;AAC9BH,oEAAQ,CAAE;AACTG,gBAAM,EAAE,MADC;AAETF,cAAI,kCAA4BsF,IAAI,CAACtV,EAAjC,sBAAiDkQ,MAAM,CAACsH,WAAxD,CAFK;AAGT9B,cAAI,EAAE;AACLpC,mBAAO,EAAE;AADJ;AAHG,SAAF,CAAR;AAOA,OARD;AASA;;;;sNAE0BjQ,M;;;;;;;;;8BACc,KAAKxF,K,EAArC4D,Y,eAAAA,Y,EAAcuT,a,eAAAA,a;AAElByC,8B,GAAiB,K;AACjBC,4B,GAAe,K;AACnB1C,6BAAa,CAAC7V,OAAd,CAAuB,UAAEmW,IAAF,EAAY;AAClC,sBAAKA,IAAI,CAACtV,EAAL,KAAY,CAAjB,EAAqB;AACpByX,kCAAc,GACbnC,IAAI,CAACC,UAAL,IAAmBlS,MAAM,WAAMiS,IAAI,CAACtV,EAAX,cAD1B;AAEA,mBAHD,MAGO;AACN0X,gCAAY,GACXrU,MAAM,WAAMiS,IAAI,CAACtV,EAAX,WAAN,KAAkC,EAAlC,IACA2X,UAAU,CAAEtU,MAAM,WAAMiS,IAAI,CAACtV,EAAX,WAAR,CAAV,KACC2X,UAAU,CAAE,CAAF,CAHZ;AAIA;;AAED,sBAAMC,eAAe,GAAG,MAAI,CAACC,kBAAL,CAAyBvC,IAAzB,CAAxB;;AACA,sBAAMwC,UAAU,GACfH,UAAU,CAAEtU,MAAM,WAAMiS,IAAI,CAACtV,EAAX,WAAR,CAAV,KAAgD2X,UAAU,CAAE,CAAF,CAA1D,GACG,eADH,GAEG,WAHJ;AAIA,sBAAMI,cAAc,GAAG,MAAI,CAACF,kBAAL,CAAyBvC,IAAzB,EAA+BwC,UAA/B,EACrB1Z,MADqB,GAEpB,MAAI,CAACyZ,kBAAL,CAAyBvC,IAAzB,EAA+BwC,UAA/B,EAA6C,CAA7C,CAFoB,GAGpB,IAHH;;AAKA,sBAAKxC,IAAI,CAACC,UAAL,IAAmB,CAAElS,MAAM,WAAMiS,IAAI,CAACtV,EAAX,cAAhC,EAA6D;AAC5D;AACA,0BAAI,CAACgY,sBAAL,CAA6B1C,IAA7B,EAAmCsC,eAAnC;;AACA;AACA,mBAJD,MAIO,IAAKG,cAAL,EAAsB;AAC5B;AACA,wBAAME,gBAAgB,GAAGL,eAAe,CAACzS,MAAhB,CACxB,UAAE+K,MAAF;AAAA,6BACCA,MAAM,CAACsH,WAAP,KAAuBO,cAAc,CAACP,WADvC;AAAA,qBADwB,CAAzB;;AAIA,0BAAI,CAACQ,sBAAL,CAA6B1C,IAA7B,EAAmC2C,gBAAnC;AACA;;AAEDlI,8EAAQ,CAAE;AACTG,0BAAM,EAAE,MADC;AAETF,wBAAI,EAAE+H,cAAc,GACjB;AADiB,oDAESzC,IAAI,CAACtV,EAFd,sBAE8B+X,cAAc,CAACP,WAF7C,oCAGSlC,IAAI,CAACtV,EAHd,aAFX;AAMT0V,wBAAI,EAAE;AACL6B,+BAAS,EAAEO,UADN;AAELxE,6BAAO,EAAE,IAFJ;AAGLuC,8BAAQ,EAAE;AAAEqC,4BAAI,EAAE7U,MAAM,WAAMiS,IAAI,CAACtV,EAAX;AAAd;AAHL;AANG,mBAAF,CAAR;AAYA,iBA9CD;AAgDA3B,+EAAW,CAAE,6BAAF,EAAiC;AAC3C8Z,+BAAa,EAAET,YAD4B;AAE3CU,4BAAU,EAAEX;AAF+B,iBAAjC,CAAX,C,CAKA;AACA;;AACApH,kGAAU,CAAE,YAAF,kCACNtR,kFAAU,CAAE,YAAF,EAAgB,EAAhB,CADJ;AAETuN,oCAAkB,EAAE;AAFX,mBAAV;AAKA7K,4BAAY,CACX,SADW,EAEXvB,2DAAE,CAAE,wCAAF,EAA4C,mBAA5C,CAFS,CAAZ;AAKA,qBAAKrC,KAAL,CAAWwa,UAAX;;;;;;;;;;;;;;;;;;wCAGmB;AAAA,kCACgB,KAAKC,OAAL,CAAaC,iBAAb,EADhB;AAAA,UACXC,cADW,yBACXA,cADW;AAAA,UACKC,MADL,yBACKA,MADL;;AAEnB,UAAKD,cAAc,CAACvL,OAAf,CAAwB,OAAxB,MAAsC,CAA3C,EAA+C;AAC9C,eAAO,IAAP;AACA;;AACD,aACC;AAAM,iBAAS,EAAC;AAAhB,SACGwL,MADH,CADD;AAKA;;;sCAEkBC,I,EAAO;AAAA,mCACU,KAAKJ,OAAL,CAAaC,iBAAb,EADV;AAAA,UACjBC,cADiB,0BACjBA,cADiB;AAAA,UACDC,MADC,0BACDA,MADC;;AAEzB,UAAKD,cAAc,CAACvL,OAAf,CAAwB,OAAxB,MAAsC,CAA3C,EAA+C;AAC9C,eACC;AAAM,mBAAS,EAAC;AAAhB,WACGwL,MADH,CADD;AAKA;;AAED,aAAOd,UAAU,CAAEe,IAAF,CAAV,KAAuBf,UAAU,CAAE,CAAF,CAAjC,GACN;AAAM,iBAAS,EAAC;AAAhB,SACGzX,2DAAE,CAAE,eAAF,EAAmB,mBAAnB,CADL,CADM,GAIH,IAJJ;AAKA;;;qCAEiB0F,K,EAAQ;AAAA,UACjB+S,mBADiB,GACO,KAAKL,OADZ,CACjBK,mBADiB;AAEzB,UAAMC,cAAc,GAAGD,mBAAmB,CAAE/S,KAAF,CAA1C;;AACA,UAAK,CAAEA,KAAK,CAACxH,MAAR,IAAkB,CAAEwa,cAAc,CAACxa,MAAxC,EAAiD;AAChD,eAAOua,mBAAmB,CAAE,CAAF,CAA1B;AACA;;AAED,aAAOA,mBAAmB,CAAE/S,KAAF,CAA1B;AACA;;;uCAEkB;AAAA;;AAAA,UACV+S,mBADU,GACc,KAAKL,OADnB,CACVK,mBADU;AAElB,UAAMtV,MAAM,GAAG,EAAf;AAEA,WAAKxF,KAAL,CAAWmX,aAAX,CAAyB7V,OAAzB,CAAkC,UAAEmW,IAAF,EAAY;AAC7C,YAAMsC,eAAe,GAAG,MAAI,CAACC,kBAAL,CAAyBvC,IAAzB,CAAxB;;AACA,YAAMoD,IAAI,GACTd,eAAe,CAACxZ,MAAhB,IAA0BwZ,eAAe,CAAE,CAAF,CAAf,CAAqB/B,QAArB,CAA8BqC,IAAxD,GACG,MAAI,CAACW,gBAAL,CACAjB,eAAe,CAAE,CAAF,CAAf,CAAqB/B,QAArB,CAA8BqC,IAA9B,CAAmCtS,KADnC,CADH,GAIG+S,mBAAmB,CAAE,CAAF,CALvB;AAMAtV,cAAM,WAAMiS,IAAI,CAACtV,EAAX,WAAN,GAAgC0Y,IAAhC;;AAEA,YAAKd,eAAe,CAACxZ,MAAhB,IAA0BwZ,eAAe,CAAE,CAAF,CAAf,CAAqBtE,OAApD,EAA8D;AAC7DjQ,gBAAM,WAAMiS,IAAI,CAACtV,EAAX,cAAN,GAAmC,IAAnC;AACA,SAFD,MAEO;AACNqD,gBAAM,WAAMiS,IAAI,CAACtV,EAAX,cAAN,GAAmC,KAAnC;AACA;AACD,OAfD;AAiBA,aAAOqD,MAAP;AACA;;;6BAESA,M,EAAS;AAClB,UAAMC,MAAM,GAAG,EAAf;AAEA,UAAMwV,KAAK,GAAGnF,MAAM,CAACC,IAAP,CAAavQ,MAAb,EAAsB8B,MAAtB,CAA8B,UAAE4T,KAAF;AAAA,eAC3CA,KAAK,CAACC,QAAN,CAAgB,OAAhB,CAD2C;AAAA,OAA9B,CAAd;AAIAF,WAAK,CAAC3Z,OAAN,CAAe,UAAEuZ,IAAF,EAAY;AAC1B,YAAKrV,MAAM,CAAEqV,IAAF,CAAN,GAAiB,CAAtB,EAA0B;AACzBpV,gBAAM,CAAEoV,IAAF,CAAN,GAAiBxY,2DAAE,CAClB,6CADkB,EAElB,mBAFkB,CAAnB;AAIA;AACD,OAPD;AASA,aAAOoD,MAAP;AACA;;;6BAEQ;AAAA;;AAAA,yBAC8B,KAAKzF,KADnC;AAAA,UACAob,UADA,gBACAA,UADA;AAAA,UACYjE,aADZ,gBACYA,aADZ;;AAGR,UAAK,CAAEA,aAAa,CAAC5W,MAArB,EAA8B;AAC7B,eAAO,IAAP;AACA;;AAED,aACC,0EAAC,6DAAD;AACC,qBAAa,EAAG,KAAK8a,gBAAL,EADjB;AAEC,wBAAgB,EAAG,KAAK9B,mBAFzB;AAGC,gBAAQ,EAAG,KAAK+B;AAHjB,SAKG,gBAMK;AAAA,YALNrT,aAKM,QALNA,aAKM;AAAA,YAJNsT,YAIM,QAJNA,YAIM;AAAA,YAHNC,UAGM,QAHNA,UAGM;AAAA,YAFN7U,QAEM,QAFNA,QAEM;AAAA,YADNnB,MACM,QADNA,MACM;AACN,eACC,0EAAC,4DAAD,QACC;AAAK,mBAAS,EAAC;AAAf,WACG2R,aAAa,CAAC3Q,GAAd,CAAmB,UAAEiR,IAAF;AAAA,iBACpB;AACC,qBAAS,EAAC,2BADX;AAEC,eAAG,EAAGA,IAAI,CAACtV;AAFZ,aAIC;AAAK,qBAAS,EAAC;AAAf,aACGsV,IAAI,CAACE,SAAL,GACDF,IAAI,CAACE,SAAL,CAAenR,GAAf,CACC,UAAEzF,QAAF;AAAA,mBACC,0EAAC,6DAAD;AACC,kBAAI,EAAG,EADR;AAEC,kBAAI,EACHA,QAAQ,CAACsF,IAHX;AAKC,iBAAG,EACFtF,QAAQ,CAACsF;AANX,cADD;AAAA,WADD,CADC,GAeD;AACA;AAAG,qBAAS,EAAC;AAAb,sBAjBF,CAJD,EA0BC;AAAK,qBAAS,EAAC;AAAf,aACGoR,IAAI,CAACC,UAAL,GACD;AACC,mBAAO,8CAAyCD,IAAI,CAACtV,EAA9C,CADR;AAEC,qBAAS,EAAC;AAFX,aAIGsV,IAAI,CAACnR,IAJR,EAKC,0EAAC,iEAAD;AACC,cAAE,8CAAyCmR,IAAI,CAACtV,EAA9C;AADH,aAEM8F,aAAa,WACbwP,IAAI,CAACtV,EADQ,cAFnB,EALD,CADC,GAcD;AAAK,qBAAS,EAAC;AAAf,aACGsV,IAAI,CAACnR,IADR,CAfF,EAmBG,CAAE,CAAEmR,IAAI,CAACC,UAAP,IACHlS,MAAM,WACDiS,IAAI,CAACtV,EADJ,cADL,KAID,0EAAC,+EAAD;AACC,iBAAK,EAAGE,2DAAE,CACT,eADS,EAET,mBAFS,CADX;AAKC,oBAAQ;AALT,aAMM4F,aAAa,WACbwP,IAAI,CAACtV,EADQ,WANnB;AASC,kBAAM,EAAG,kBAAM;AACdqZ,wBAAU,WACL/D,IAAI,CAACtV,EADA,WAAV;AAGAwE,sBAAQ,WACH8Q,IAAI,CAACtV,EADF,YAEP,MAAI,CAAC6Y,gBAAL,CACCxV,MAAM,WACDiS,IAAI,CAACtV,EADJ,WADP,CAFO,CAAR;AAQA,aArBF;AAsBC,kBAAM,EAAG,MAAI,CAACsZ,iBAAL,EAtBV;AAuBC,kBAAM,EAAG,MAAI,CAACC,iBAAL,CACRlW,MAAM,WACDiS,IAAI,CAACtV,EADJ,WADE,CAvBV;AA4BC,qBAAS,EAAC;AA5BX,aAvBF,CA1BD,CADoB;AAAA,SAAnB,CADH,CADD,EAwFC,0EAAC,6DAAD;AAAQ,mBAAS,MAAjB;AAAkB,iBAAO,EAAGoZ;AAA5B,WACGH,UAAU,IACX/Y,2DAAE,CAAE,QAAF,EAAY,mBAAZ,CAFJ,CAxFD,CADD;AA+FA,OA3GF,CADD;AA+GA;;;;EAvT0BM,6D;;AA0T5B2W,aAAa,CAAChV,SAAd,GAA0B;AACzB;;;AAGA8W,YAAU,EAAE7W,kDAAS,CAACG,MAJG;;AAKzB;;;AAGA8V,YAAU,EAAEjW,kDAAS,CAACC,IAAV,CAAeC,UARF;;AASzB;;;AAGAb,cAAY,EAAEW,kDAAS,CAACC,IAAV,CAAeC,UAZJ;;AAazB;;;;AAIA0S,eAAa,EAAE5S,kDAAS,CAACoX;AAjBA,CAA1B;AAoBArC,aAAa,CAACzU,YAAd,GAA6B;AAC5BsS,eAAa,EAAE;AADa,CAA7B;AAIAmC,aAAa,CAACsC,WAAd,GAA4BC,qEAA5B;AAEevC,4EAAf,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzWA;;;AAGA;AACA;AACA;AAEA;;;;AAGA;AAEA;;;;AAGA;;IAKqBwC,a;;;;;AACpB,2BAAc;AAAA;;AAAA;;AACb,+BAAUjI,SAAV;AACA,UAAKkI,QAAL,GAAgB,MAAKA,QAAL,CAActY,IAAd,4FAAhB;AAFa;AAGb;;;;;2MAEe+B,M;;;;;;;8BAOX,KAAKxF,K,EALRwa,U,eAAAA,U,EACA5W,Y,eAAAA,Y,EACAoY,e,eAAAA,e,EACA3C,gC,eAAAA,gC,EACArB,Q,eAAAA,Q;;uBAGKqB,gCAAgC,CAAE,SAAF,EAAa;AAClDzL,yBAAO,kCACHoK,QADG;AAENE,6CAAyB,EAAE1S,MAAM,CAACE,YAF5B;AAGNuW,+CAA2B,EAAEzW,MAAM,CAAC0W,YAH9B;AAINnO,+CAA2B,EAAEvI,MAAM,CAACG,YAJ9B;AAKNwW,0CAAsB,EAAE3W,MAAM,CAACI,IALzB;AAMNyS,8CAA0B,EAAE7S,MAAM,CAACK;AAN7B;AAD2C,iBAAb,C;;;AAWtC,oBAAK,CAAEmW,eAAP,EAAyB;AACxBxB,4BAAU,CAAEhV,MAAF,CAAV;AACA,iBAFD,MAEO;AACN5B,8BAAY,CACX,OADW,EAEXvB,2DAAE,CACD,iDADC,EAED,mBAFC,CAFS,CAAZ;AAOA;;;;;;;;;;;;;;;;;;uCAGiB;AAAA,UACV2V,QADU,GACG,KAAKhY,KADR,CACVgY,QADU;AAAA,UAIUC,YAJV,GASdD,QATc,CAIjBE,yBAJiB;AAAA,UAKYkE,aALZ,GASdpE,QATc,CAKjBiE,2BALiB;AAAA,UAMOI,SANP,GASdrE,QATc,CAMjBmE,sBANiB;AAAA,UAOYhE,cAPZ,GASdH,QATc,CAOjBjK,2BAPiB;AAAA,UAQWuO,aARX,GASdtE,QATc,CAQjBK,0BARiB;AAWlB,aAAO;AACN3S,oBAAY,EAAEuS,YAAY,IAAI,EADxB;AAENiE,oBAAY,EAAEE,aAAa,IAAI,EAFzB;AAGNxW,YAAI,EAAEyW,SAAS,IAAI,EAHb;AAIN1W,oBAAY,EAAEwS,cAAc,IAAI,EAJ1B;AAKNtS,gBAAQ,EAAEyW,aAAa,IAAI;AALrB,OAAP;AAOA;;;6BAEQ;AAAA,UACAC,oBADA,GACyB,KAAKvc,KAD9B,CACAuc,oBADA;;AAGR,UAAKA,oBAAL,EAA4B;AAC3B,eAAO,IAAP;AACA;;AAED,aACC,yEAAC,6DAAD;AACC,qBAAa,EAAG,KAAKlB,gBAAL,EADjB;AAEC,wBAAgB,EAAG,KAAKU,QAFzB;AAGC,gBAAQ,EAAGxW,yGAAoBA;AAHhC,SAKG;AAAA,YAAI0C,aAAJ,QAAIA,aAAJ;AAAA,YAAmBsT,YAAnB,QAAmBA,YAAnB;AAAA,YAAiC5U,QAAjC,QAAiCA,QAAjC;AAAA,eACD,yEAAC,2DAAD,QACC,yEAAC,iGAAD;AACC,uBAAa,EAAGsB,aADjB;AAEC,kBAAQ,EAAGtB;AAFZ,UADD,EAKC,yEAAC,6DAAD;AAAQ,mBAAS,MAAjB;AAAkB,iBAAO,EAAG4U;AAA5B,WACGlZ,2DAAE,CAAE,UAAF,EAAc,mBAAd,CADL,CALD,CADC;AAAA,OALH,CADD;AAmBA;;;;EArFyCM,4D;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpB3C;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;AAGA;AACA;AACA;AAKA;AAMA;;;;AAGA;AACA;AACA;AACA;AACA;;IAEM6Z,G;;;;;AACL,eAAaxc,KAAb,EAAqB;AAAA;;AAAA;;AACpB,8BAAOA,KAAP;AADoB,QAEZyc,kBAFY,GAE8Bzc,KAF9B,CAEZyc,kBAFY;AAAA,QAEQ9D,iBAFR,GAE8B3Y,KAF9B,CAEQ2Y,iBAFR;AAIpB,UAAKzB,YAAL,GAAoB;AACnBvG,eAAS,EAAE,KADQ;AAEnBE,eAAS,EAAE4L,kBAAkB,GAAG,CAAH,GAAO,CAFjB;AAGnB;AACA;AACAC,6BAAuB,EAAE/D;AALN,KAApB;AAOA,UAAK1Y,KAAL,GAAa,MAAKiX,YAAlB;AAEA,UAAKhG,YAAL,GAAoB,MAAKA,YAAL,CAAkBzN,IAAlB,4FAApB;AAboB;AAcpB;;;;wCAEmB;AACnB,WAAK2T,KAAL;AACA;;;4BAEO;AACP,WAAK9W,QAAL,CAAe,KAAK4W,YAApB;AACA;;;8CAEyB;AAAA,wBAKrB,KAAKlX,KALgB;AAAA,UAExBuL,kBAFwB,eAExBA,kBAFwB;AAAA,UAGxBkR,kBAHwB,eAGxBA,kBAHwB;AAAA,UAIxB9D,iBAJwB,eAIxBA,iBAJwB;AAOzB,aACC8D,kBAAkB,IAClB,CAAE9D,iBAAiB,CAACpY,MADpB,IAEAgL,kBAFA,IAGA,KAAKoR,iBAAL,EAJD;AAMA;;;wCAEmB;AAAA,UACXxR,WADW,GACK,KAAKnL,KADV,CACXmL,WADW;;AAAA,wBAKfjK,kFAAU,CAAE,YAAF,EAAgB,EAAhB,CALK;AAAA,8CAGlB0b,8BAHkB;AAAA,UAGlBA,8BAHkB,sCAGe,EAHf;AAAA,UAIlBC,eAJkB,eAIlBA,eAJkB;;AAOnB,aACC,CAAEA,eAAF,IAAqB;AACrBD,oCAA8B,CAACnR,QAA/B,CAAyCN,WAAzC,CAFD;AAIA;;;mCAEc;AAAA,UACN0F,SADM,GACQ,KAAK5Q,KADb,CACN4Q,SADM;AAEd,UAAM2C,KAAK,GAAG,KAAKvB,QAAL,EAAd;AACA,UAAMD,QAAQ,GAAGwB,KAAK,CAAE3C,SAAS,GAAG,CAAd,CAAtB;;AAEA,UAAKmB,QAAL,EAAgB;AACf,aAAK1R,QAAL,CAAe;AAAEuQ,mBAAS,EAAEA,SAAS,GAAG;AAAzB,SAAf;AACA;AACD;;;;;;;;;;;;;+BAMI,KAAK7Q,K,EAFR6N,e,gBAAAA,e,EACAwL,gC,gBAAAA,gC;;AAGD,oBAAKxL,eAAe,CAACiP,sBAAhB,KAA2C,KAAhD,EAAwD;AACvD,uBAAKxc,QAAL,CAAe;AAAEqQ,6BAAS,EAAE;AAAb,mBAAf;AACA0I,kDAAgC,CAAE,SAAF,EAAa;AAC5CzL,2BAAO,kCACHC,eADG;AAENiP,4CAAsB,EAAE;AAFlB;AADqC,mBAAb,CAAhC,CAMEjL,IANF,CAMQ;AAAA,2BAAM,MAAI,CAACkL,qBAAL,EAAN;AAAA,mBANR,EAOEtK,KAPF,CAOS,UAAE5O,KAAF;AAAA,2BAAamZ,8EAAyB,CAAEnZ,KAAF,CAAtC;AAAA,mBAPT;AAQA,iBAVD,MAUO;AACN,uBAAKkZ,qBAAL;AACA;;;;;;;;;;;;;;;;;;uCAGkBE,U,EAAa;AAAA;;AAAA,yBAM5B,KAAKjd,KANuB;AAAA,UAE/B4D,YAF+B,gBAE/BA,YAF+B;AAAA,UAG/ByV,gCAH+B,gBAG/BA,gCAH+B;AAAA,UAI/BxL,eAJ+B,gBAI/BA,eAJ+B;AAAA,UAK/BqP,WAL+B,gBAK/BA,WAL+B;AAQhCpN,aAAO,CAAC0H,GAAR,CAAa,CACZ6B,gCAAgC,CAAE,KAAF,EAAS;AACxC8D,WAAG,kCACCD,WADD;AAEFE,kCAAwB,EAAEH,UAAU,GAAG,KAAH,GAAW;AAF7C;AADqC,OAAT,CADpB,EAOZ5D,gCAAgC,CAAE,SAAF,EAAa;AAC5CzL,eAAO,kCACHC,eADG;AAENiP,gCAAsB,EAAE;AAFlB;AADqC,OAAb,CAPpB,CAAb,EAcEjL,IAdF,CAcQ,YAAM;AACZ;AACA;AACAW,0FAAU,CAAE,YAAF,kCACNtR,kFAAU,CAAE,YAAF,EAAgB,EAAhB,CADJ;AAETsN,uBAAa,EAAE;AAFN,WAAV;;AAIA,YAAKyO,UAAL,EAAkB;AACjBrZ,sBAAY,CACX,SADW,EAEXvB,2DAAE,CACD,oDADC,EAED,mBAFC,CAFS,CAAZ;AAOAuN,qFAAU,GAAGhO,IAAb,CAAmBiO,2EAAU,CAAE,EAAF,EAAM,GAAN,EAAW,EAAX,CAA7B;AACA,SATD,MASO;AACN,gBAAI,CAACkN,qBAAL;AACA;AACD,OAjCF,EAkCEtK,KAlCF,CAkCS,YAAM;AACb7O,oBAAY,CACX,OADW,EAEXvB,2DAAE,CACD,iDADC,EAED,mBAFC,CAFS,CAAZ;AAOA,OA1CF;AA2CA;;;4CAEuB;AACvBvB,YAAM,CAACC,QAAP,GAAkBgW,oFAAY,CAC7B,mFAD6B,CAA9B;AAGA;;;+BAEU;AAAA;;AAAA,yBAON,KAAK/W,KAPC;AAAA,UAET6N,eAFS,gBAETA,eAFS;AAAA,UAGTtC,kBAHS,gBAGTA,kBAHS;AAAA,UAIToF,SAJS,gBAITA,SAJS;AAAA,UAKT0M,WALS,gBAKTA,WALS;AAAA,UAMTtT,aANS,gBAMTA,aANS;AAAA,UAQF2S,uBARE,GAQ0B,KAAKzc,KAR/B,CAQFyc,uBARE;AAUV,UAAMlJ,KAAK,GAAG,CACb;AACCpN,WAAG,EAAE,gBADN;AAECtE,aAAK,EAAEO,2DAAE,CAAE,oBAAF,EAAwB,mBAAxB,CAFV;AAGCL,mBAAW,EAAEK,2DAAE,CACd,+CADc,EAEd,mBAFc,CAHhB;AAOCN,eAAO,EACN,0EAAC,wDAAD,4EACM,KAAK/B,KADX;AAEC,oBAAU,EAAG,oBAAEwF,MAAF,EAAc;AAC1B,gBAAMU,OAAO,GAAG4H,uEAAc,CAC7BtI,MAAM,CAACG,YADsB,CAA9B;AAGAnF,2EAAW,CAAE,2BAAF,EAA+B;AACzC0F,qBAAO,EAAPA;AADyC,aAA/B,CAAX;;AAGA,kBAAI,CAACgL,YAAL;AACA,WAVF;AAWC,8BAAoB,EAAG,KAXxB;AAYC,kBAAQ,EAAGrD;AAZZ,WARF;AAuBCxD,eAAO,EAAE;AAvBV,OADa,EA0Bb;AACCjE,WAAG,EAAE,SADN;AAECtE,aAAK,EAAEO,2DAAE,CACR,0CADQ,EAER,mBAFQ,CAFV;AAMCL,mBAAW,EAAEK,2DAAE,CACd,+EADc,EAEd,mBAFc,CANhB;AAUCN,eAAO,EACN,0EAAC,4DAAD,QACC,0EAAC,gEAAD;AACC,oBAAU,EAAG,sBAAM;AAClBvB,2EAAW,CACV,iCADU,EAEV;AACC8c,gCAAkB,EAAE;AADrB,aAFU,CAAX;AAMAvT,yBAAa,CAAE;AACdwT,gDAAkC,EAAE;AADtB,aAAF,CAAb;;AAGA,kBAAI,CAACrM,YAAL;AACA,WAZF;AAaC,gBAAM,EAAG,kBAAM;AACd6B,gFAAgB,CACf,iCADe,EAEf;AACCuK,gCAAkB,EAAE;AADrB,aAFe,CAAhB;;AAMA,kBAAI,CAACE,yBAAL;AACA,WArBF;AAsBC,kBAAQ,EAAGnb,2DAAE,CACZ,2BADY,EAEZ,mBAFY;AAtBd,UADD,EA4BG,CAAEgb,WAAF,IACD,0EAAC,yEAAD;AACC,iBAAO,EAAC,SADT;AAEC,mBAAS,EAAC;AAFX,WAIGvE,8DAAqB,CAAE;AACxBC,qBAAW,EAAE1W,2DAAE,CACd,oGADc,EAEd,mBAFc,CADS;AAKxB2W,oBAAU,EAAE;AACXC,gBAAI,EACH,0EAAC,6DAAD;AACC,kBAAI,EACH,4BAFF;AAIC,oBAAM,EAAC,QAJR;AAKC,kBAAI,EAAC;AALN;AAFU;AALY,SAAF,CAJxB,CA7BF,CAXF;AAiEC5O,eAAO,EACN,CAAEqS,uBAAuB,CAACnc,MAAxB,IAAkC,CAAE8c,WAAtC,KACA,KAAKV,iBAAL;AAnEF,OA1Ba,EA+Fb;AACCvW,WAAG,EAAE,SADN;AAECtE,aAAK,EAAEO,2DAAE,CAAE,oBAAF,EAAwB,mBAAxB,CAFV;AAGCL,mBAAW,EAAEK,2DAAE,CACd,gFADc,EAEd,mBAFc,CAHhB;AAOCN,eAAO,EACN,0EAAC,qEAAD,4EACM,KAAK/B,KADX;AAEC,mBAAS,EAAG,qBAAM;AACjBQ,2EAAW,CAAE,4BAAF,EAAgC;AAC1Cid,qBAAO,EAAE;AADiC,aAAhC,CAAX;AAGA,WANF;AAOC,gBAAM,EAAG,kBAAM;AACd1K,gFAAgB,CAAE,4BAAF,EAAgC;AAC/C0K,qBAAO,EAAE;AADsC,aAAhC,CAAhB;;AAGA,kBAAI,CAACD,yBAAL;AACA,WAZF;AAaC,kBAAQ,EAAGnb,2DAAE,CACZ,2BADY,EAEZ,mBAFY;AAbd,WARF;AA2BCgI,eAAO,EAAE,CAAEkB,kBAAF,IAAwB,KAAKoR,iBAAL;AA3BlC,OA/Fa,EA4Hb;AACCvW,WAAG,EAAE,sBADN;AAECtE,aAAK,EAAEO,2DAAE,CAAE,qBAAF,EAAyB,mBAAzB,CAFV;AAGCL,mBAAW,EAAEK,2DAAE,CACd,uEADc,EAEd,mBAFc,CAHhB;AAOCN,eAAO,EACN,0EAAC,4DAAD,QACC,0EAAC,6DAAD;AACC,kBAAQ,EAAG4O,SADZ;AAEC,mBAAS,MAFV;AAGC,gBAAM,EAAGA,SAHV;AAIC,iBAAO,EAAG,mBAAM;AACfnQ,2EAAW,CAAE,2BAAF,CAAX;;AACA,kBAAI,CAACgd,yBAAL;AACA;AAPF,WASGnb,2DAAE,CAAE,WAAF,EAAe,mBAAf,CATL,CADD,EAYC,qFACGwL,eAAe,CAACiP,sBAAhB,KACD,KADC,IAEDhE,8DAAqB,CAAE;AACtBC,qBAAW,EAAE1W,2DAAE;AACd;AACA,iHAFc;AAGd;AACA,6BAJc,CADO;AAOtB2W,oBAAU,EAAE;AACXC,gBAAI,EACH,0EAAC,6DAAD;AACC,kBAAI,EAAC,kFADN;AAEC,oBAAM,EAAC,QAFR;AAGC,kBAAI,EAAC;AAHN;AAFU;AAPU,SAAF,CAHvB,CAZD,CARF;AA2CC5O,eAAO,EAAE,CAAE,KAAKsS,iBAAL;AA3CZ,OA5Ha,CAAd;AA2KA,aAAOrV,sDAAM,CAAEkM,KAAF,EAAS,UAAEE,IAAF;AAAA,eAAYA,IAAI,CAACrJ,OAAjB;AAAA,OAAT,CAAb;AACA;;;6BAEQ;AAAA;;AAAA,UACAwG,SADA,GACc,KAAK5Q,KADnB,CACA4Q,SADA;AAAA,yBAE2B,KAAK7Q,KAFhC;AAAA,UAEA2Q,SAFA,gBAEAA,SAFA;AAAA,UAEW+M,WAFX,gBAEWA,WAFX;AAGR,UAAMhK,IAAI,GAAG,KAAKzB,QAAL,GAAiBpB,SAAjB,CAAb;AAEA,aACC;AAAK,iBAAS,EAAC;AAAf,SACC,0EAAC,6DAAD;AAAM,iBAAS,EAAC;AAAhB,SACG,KAAK8M,uBAAL,KACD;AAAK,iBAAS,EAAC;AAAf,SACC;AACC,iBAAS,EAAC,oCADX;AAEC,YAAI,EAAC,KAFN;AAGC,2BAAgB;AAHjB,wBADD,EAQC,0EAAC,0DAAD;AAAG,UAAE,EAAC;AAAN,SACGtb,2DAAE,CAAE,YAAF,EAAgB,mBAAhB,CADL,CARD,EAWC,qFACGyW,8DAAqB,CAAE;AACxBC,mBAAW,EAAE1W,2DAAE,CACd,gFACC,mDAFa,EAGd,mBAHc,CADS;AAMxB2W,kBAAU,EAAE;AACX4E,gBAAM,EAAE;AADG;AANY,OAAF,CADxB,CAXD,EAuBC,0EAAC,6DAAD;AACC,gBAAQ,EAAGjN,SADZ;AAEC,iBAAS,MAFV;AAGC,cAAM,EAAGA,SAHV;AAIC,eAAO,EAAG,mBAAM;AACfnQ,yEAAW,CACV,sCADU,EAEV;AACCqd,+BAAmB,EAAE;AADtB,WAFU,CAAX;;AAMA,gBAAI,CAACC,kBAAL,CAAyB,IAAzB;AACA;AAZF,SAcGzb,2DAAE,CAAE,YAAF,EAAgB,mBAAhB,CAdL,CAvBD,EAuCC,0EAAC,6DAAD;AACC,gBAAQ,EAAGsO,SADZ;AAEC,cAAM,EAAGA,SAFV;AAGC,eAAO,EAAG,mBAAM;AACfnQ,yEAAW,CACV,sCADU,EAEV;AACCqd,+BAAmB,EAAE;AADtB,WAFU,CAAX;;AAMA,gBAAI,CAACC,kBAAL,CAAyB,KAAzB;AACA;AAXF,SAaGzb,2DAAE,CACH,0CADG,EAEH,mBAFG,CAbL,CAvCD,CADC,GA4DD,0EAAC,gEAAD;AACC,iBAAS,EAAGsO,SAAS,IAAI+M,WAD1B;AAEC,kBAAU,EAAG,IAFd;AAGC,mBAAW,EAAGhK,IAAI,CAACtN,GAHpB;AAIC,aAAK,EAAG,KAAK6L,QAAL;AAJT,QA7DF,CADD,CADD;AAyEA;;;;EArZgBtP,6D;;AAwZHC,kIAAO,CACrBC,mEAAU,CAAE,UAAEC,MAAF,EAAc;AAAA,gBAC2BA,MAAM,CACzD0K,sEADyD,CADjC;AAAA,MACjBC,WADiB,WACjBA,WADiB;AAAA,MACJ0L,0BADI,WACJA,0BADI;;AAAA,iBAIHrW,MAAM,CAAEwK,qEAAF,CAJH;AAAA,MAIjBC,SAJiB,YAIjBA,SAJiB;;AAAA,iBASrBzK,MAAM,CAAEC,qEAAF,CATe;AAAA,MAMxB2K,gBANwB,YAMxBA,gBANwB;AAAA,MAOxBnC,kBAPwB,YAOxBA,kBAPwB;AAAA,MAQxBxG,mBARwB,YAQxBA,mBARwB;;AAAA,qBAWiB0I,WAAW,CAAE,SAAF,CAX5B;AAAA,0CAWjBG,OAXiB;AAAA,MAWRC,eAXQ,qCAWU,EAXV;;AAYzB,MAAM1C,WAAW,GAAG2C,uEAAc,CACjCD,eAAe,CAACE,2BADiB,CAAlC;AAZyB,MAgBGkK,YAhBH,GAmBrBpK,eAnBqB,CAgBxBqK,yBAhBwB;AAAA,MAiBKC,cAjBL,GAmBrBtK,eAnBqB,CAiBxBE,2BAjBwB;AAAA,MAkBIqK,aAlBJ,GAmBrBvK,eAnBqB,CAkBxBwK,0BAlBwB;AAoBzB,MAAMoE,kBAAkB,GAAGzN,OAAO,CACjCiJ,YAAY,IAAIE,cAAhB,IAAkCC,aADD,CAAlC;;AApByB,sBAwBS3K,WAAW,CAAE,KAAF,CAxBpB;AAAA,wCAwBjB0P,GAxBiB;AAAA,MAwBZD,WAxBY,kCAwBE,EAxBF;;AAyBzB,MAAM7R,aAAa,GAAGqC,gBAAgB,EAAtC;AACA,MAAMiL,iBAAiB,GAAGD,0DAAU,CACnC,CAAE,SAAF,EAAa,sBAAb,CADmC,EAEnCrN,aAFmC,CAApC;AAIA,MAAM0S,cAAc,GAAGxQ,SAAS,CAAE,oBAAF,CAAT,IAAqC,EAA5D;AACA,MAAM8P,WAAW,GAChBU,cAAc,CAACC,YAAf,IACAzQ,SAAS,CAAE,oCAAF,CAFV;AAIA,MAAMoD,SAAS,GACdwI,0BAA0B,CAAE,KAAF,CAA1B,IACAA,0BAA0B,CAAE,SAAF,CAF3B;AAGA,MAAMuE,WAAW,GAAG3Y,mBAAmB,CAAE,sBAAF,CAAvC;AAEA,SAAO;AACNoG,eAAW,EAAXA,WADM;AAEN0C,mBAAe,EAAfA,eAFM;AAGN4O,sBAAkB,EAAlBA,kBAHM;AAINlR,sBAAkB,EAAEA,kBAAkB,EAJhC;AAKNoF,aAAS,EAATA,SALM;AAMN+M,eAAW,EAAXA,WANM;AAON/E,qBAAiB,EAAjBA,iBAPM;AAQNuE,eAAW,EAAXA,WARM;AASNG,eAAW,EAAXA;AATM,GAAP;AAWA,CAnDS,CADW,EAqDrBjY,qEAAY,CAAE,UAAEC,QAAF,EAAgB;AAAA,kBACJA,QAAQ,CAAE,cAAF,CADJ;AAAA,MACrBzB,YADqB,aACrBA,YADqB;;AAAA,mBAEHyB,QAAQ,CAAEiI,qEAAF,CAFL;AAAA,MAErBvD,aAFqB,cAErBA,aAFqB;;AAAA,mBAGgB1E,QAAQ,CACpDmI,sEADoD,CAHxB;AAAA,MAGrB6L,gCAHqB,cAGrBA,gCAHqB;;AAO7B,SAAO;AACNzV,gBAAY,EAAZA,YADM;AAENyV,oCAAgC,EAAhCA,gCAFM;AAGNtP,iBAAa,EAAbA;AAHM,GAAP;AAKA,CAZW,CArDS,CAAP,CAkEZyS,GAlEY,CAAf,E","file":"chunks/task-list.1e0e9839d6e9bce3818d.min.js","sourcesContent":["/**\n * External dependencies\n */\nimport { __, sprintf } from '@wordpress/i18n';\nimport { Component } from '@wordpress/element';\nimport { compose } from '@wordpress/compose';\nimport { Button, Modal } from '@wordpress/components';\nimport { find } from 'lodash';\nimport { decodeEntities } from '@wordpress/html-entities';\nimport { withSelect } from '@wordpress/data';\n\n/**\n * WooCommerce dependencies\n */\nimport { getSetting } from '@woocommerce/wc-admin-settings';\nimport { List } from '@woocommerce/components';\nimport { ONBOARDING_STORE_NAME, PLUGINS_STORE_NAME } from '@woocommerce/data';\n\n/**\n * Internal dependencies\n */\nimport { getProductIdsForCart } from 'dashboard/utils';\nimport sanitizeHTML from 'lib/sanitize-html';\nimport { recordEvent } from 'lib/tracks';\nimport { getInAppPurchaseUrl } from 'lib/in-app-purchase';\n\nclass CartModal extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\t\tthis.state = {\n\t\t\tpurchaseNowButtonBusy: false,\n\t\t\tpurchaseLaterButtonBusy: false,\n\t\t};\n\t}\n\n\tonClickPurchaseNow() {\n\t\tconst { productIds, onClickPurchaseNow } = this.props;\n\t\tthis.setState( { purchaseNowButtonBusy: true } );\n\t\tif ( ! productIds.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\trecordEvent( 'tasklist_modal_proceed_checkout', {\n\t\t\tproduct_ids: productIds,\n\t\t\tpurchase_install: true,\n\t\t} );\n\n\t\tconst url = getInAppPurchaseUrl( 'https://woocommerce.com/cart', {\n\t\t\t'wccom-replace-with': productIds.join( ',' ),\n\t\t} );\n\n\t\tif ( onClickPurchaseNow ) {\n\t\t\tonClickPurchaseNow( url );\n\t\t\treturn;\n\t\t}\n\n\t\twindow.location = url;\n\t}\n\n\tonClickPurchaseLater() {\n\t\tconst { productIds } = this.props;\n\n\t\trecordEvent( 'tasklist_modal_proceed_checkout', {\n\t\t\tproduct_ids: productIds,\n\t\t\tpurchase_install: false,\n\t\t} );\n\n\t\tthis.setState( { purchaseLaterButtonBusy: true } );\n\t\tthis.props.onClickPurchaseLater();\n\t}\n\n\tonClose() {\n\t\tconst { onClose, productIds } = this.props;\n\n\t\trecordEvent( 'tasklist_modal_proceed_checkout', {\n\t\t\tproduct_ids: productIds,\n\t\t\tpurchase_install: false,\n\t\t} );\n\n\t\tonClose();\n\t}\n\n\trenderProducts() {\n\t\tconst { productIds } = this.props;\n\t\tconst { productTypes = {}, themes = [] } = getSetting(\n\t\t\t'onboarding',\n\t\t\t{}\n\t\t);\n\t\tconst listItems = [];\n\n\t\tproductIds.forEach( ( productId ) => {\n\t\t\tconst productInfo = find( productTypes, ( productType ) => {\n\t\t\t\treturn productType.product === productId;\n\t\t\t} );\n\n\t\t\tif ( productInfo ) {\n\t\t\t\tlistItems.push( {\n\t\t\t\t\ttitle: productInfo.label,\n\t\t\t\t\tcontent: productInfo.description,\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\tconst themeInfo = find( themes, ( theme ) => {\n\t\t\t\treturn theme.id === productId;\n\t\t\t} );\n\n\t\t\tif ( themeInfo ) {\n\t\t\t\tlistItems.push( {\n\t\t\t\t\ttitle: sprintf(\n\t\t\t\t\t\t__( '%s — %s per year', 'woocommerce-admin' ),\n\t\t\t\t\t\tthemeInfo.title,\n\t\t\t\t\t\tdecodeEntities( themeInfo.price )\n\t\t\t\t\t),\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tdangerouslySetInnerHTML={ sanitizeHTML(\n\t\t\t\t\t\t\t\tthemeInfo.excerpt\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t/>\n\t\t\t\t\t),\n\t\t\t\t} );\n\t\t\t}\n\t\t} );\n\n\t\treturn <List items={ listItems } />;\n\t}\n\n\trender() {\n\t\tconst { purchaseNowButtonBusy, purchaseLaterButtonBusy } = this.state;\n\t\treturn (\n\t\t\t<Modal\n\t\t\t\ttitle={ __(\n\t\t\t\t\t'Would you like to purchase and install the following features now?',\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t) }\n\t\t\t\tonRequestClose={ () => this.onClose() }\n\t\t\t\tclassName=\"woocommerce-cart-modal\"\n\t\t\t>\n\t\t\t\t{ this.renderProducts() }\n\n\t\t\t\t<p className=\"woocommerce-cart-modal__help-text\">\n\t\t\t\t\t{ __(\n\t\t\t\t\t\t\"You won't have access to this functionality until the extensions have been purchased and installed.\",\n\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t) }\n\t\t\t\t</p>\n\n\t\t\t\t<div className=\"woocommerce-cart-modal__actions\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\tisLink\n\t\t\t\t\t\tisBusy={ purchaseLaterButtonBusy }\n\t\t\t\t\t\tonClick={ () => this.onClickPurchaseLater() }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( \"I'll do it later\", 'woocommerce-admin' ) }\n\t\t\t\t\t</Button>\n\n\t\t\t\t\t<Button\n\t\t\t\t\t\tisPrimary\n\t\t\t\t\t\tisBusy={ purchaseNowButtonBusy }\n\t\t\t\t\t\tonClick={ () => this.onClickPurchaseNow() }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Purchase & install now', 'woocommerce-admin' ) }\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t</Modal>\n\t\t);\n\t}\n}\n\nexport default compose(\n\twithSelect( ( select ) => {\n\t\tconst { getInstalledPlugins } = select( PLUGINS_STORE_NAME );\n\t\tconst { getProfileItems } = select( ONBOARDING_STORE_NAME );\n\t\tconst profileItems = getProfileItems();\n\t\tconst installedPlugins = getInstalledPlugins();\n\t\tconst productIds = getProductIdsForCart(\n\t\t\tprofileItems,\n\t\t\tfalse,\n\t\t\tinstalledPlugins\n\t\t);\n\n\t\treturn { profileItems, productIds };\n\t} )\n)( CartModal );\n","/**\n * External dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Button } from '@wordpress/components';\nimport { Component, Fragment } from '@wordpress/element';\nimport { compose } from '@wordpress/compose';\nimport PropTypes from 'prop-types';\nimport { withDispatch, withSelect } from '@wordpress/data';\n\n/**\n * WooCommerce dependencies\n */\nimport { PLUGINS_STORE_NAME } from '@woocommerce/data';\n\nclass Connect extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\t\tthis.state = {\n\t\t\tisConnecting: false,\n\t\t};\n\n\t\tthis.connectJetpack = this.connectJetpack.bind( this );\n\t\tprops.setIsPending( true );\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tconst {\n\t\t\tcreateNotice,\n\t\t\terror,\n\t\t\tisRequesting,\n\t\t\tonError,\n\t\t\tsetIsPending,\n\t\t} = this.props;\n\n\t\tif ( prevProps.isRequesting && ! isRequesting ) {\n\t\t\tsetIsPending( false );\n\t\t}\n\n\t\tif ( error && error !== prevProps.error ) {\n\t\t\tif ( onError ) {\n\t\t\t\tonError();\n\t\t\t}\n\t\t\tcreateNotice( 'error', error );\n\t\t}\n\t}\n\n\tasync connectJetpack() {\n\t\tconst { jetpackConnectUrl, onConnect } = this.props;\n\n\t\tthis.setState(\n\t\t\t{\n\t\t\t\tisConnecting: true,\n\t\t\t},\n\t\t\t() => {\n\t\t\t\tif ( onConnect ) {\n\t\t\t\t\tonConnect();\n\t\t\t\t}\n\t\t\t\twindow.location = jetpackConnectUrl;\n\t\t\t}\n\t\t);\n\t}\n\n\trender() {\n\t\tconst { hasErrors, isRequesting, onSkip, skipText } = this.props;\n\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t{ hasErrors ? (\n\t\t\t\t\t<Button\n\t\t\t\t\t\tisPrimary\n\t\t\t\t\t\tonClick={ () => window.location.reload() }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Retry', 'woocommerce-admin' ) }\n\t\t\t\t\t</Button>\n\t\t\t\t) : (\n\t\t\t\t\t<Button\n\t\t\t\t\t\tdisabled={ isRequesting }\n\t\t\t\t\t\tisBusy={ this.state.isConnecting }\n\t\t\t\t\t\tisPrimary\n\t\t\t\t\t\tonClick={ this.connectJetpack }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Connect', 'woocommerce-admin' ) }\n\t\t\t\t\t</Button>\n\t\t\t\t) }\n\t\t\t\t{ onSkip && (\n\t\t\t\t\t<Button onClick={ onSkip }>\n\t\t\t\t\t\t{ skipText || __( 'No thanks', 'woocommerce-admin' ) }\n\t\t\t\t\t</Button>\n\t\t\t\t) }\n\t\t\t</Fragment>\n\t\t);\n\t}\n}\n\nConnect.propTypes = {\n\t/**\n\t * Method to create a displayed notice.\n\t */\n\tcreateNotice: PropTypes.func.isRequired,\n\t/**\n\t * Human readable error message.\n\t */\n\terror: PropTypes.string,\n\t/**\n\t * Bool to determine if the \"Retry\" button should be displayed.\n\t */\n\thasErrors: PropTypes.bool,\n\t/**\n\t * Bool to check if the connection URL is still being requested.\n\t */\n\tisRequesting: PropTypes.bool,\n\t/**\n\t * Generated Jetpack connection URL.\n\t */\n\tjetpackConnectUrl: PropTypes.string,\n\t/**\n\t * Called before the redirect to Jetpack.\n\t */\n\tonConnect: PropTypes.func,\n\t/**\n\t * Called when the plugin has an error retrieving the jetpackConnectUrl.\n\t */\n\tonError: PropTypes.func,\n\t/**\n\t * Called when the plugin connection is skipped.\n\t */\n\tonSkip: PropTypes.func,\n\t/**\n\t * Redirect URL to encode as a URL param for the connection path.\n\t */\n\tredirectUrl: PropTypes.string,\n\t/**\n\t * Text used for the skip connection button.\n\t */\n\tskipText: PropTypes.string,\n\t/**\n\t * Control the `isPending` logic of the parent containing the Stepper.\n\t */\n\tsetIsPending: PropTypes.func,\n};\n\nConnect.defaultProps = {\n\tsetIsPending: () => {},\n};\n\nexport default compose(\n\twithSelect( ( select, props ) => {\n\t\tconst {\n\t\t\tgetJetpackConnectUrl,\n\t\t\tisPluginsRequesting,\n\t\t\tgetPluginsError,\n\t\t} = select( PLUGINS_STORE_NAME );\n\n\t\tconst queryArgs = {\n\t\t\tredirect_url: props.redirectUrl || window.location.href,\n\t\t};\n\t\tconst isRequesting = isPluginsRequesting( 'getJetpackConnectUrl' );\n\t\tconst error = getPluginsError( 'getJetpackConnectUrl' ) || '';\n\t\tconst jetpackConnectUrl = getJetpackConnectUrl( queryArgs );\n\n\t\treturn {\n\t\t\terror,\n\t\t\tisRequesting,\n\t\t\tjetpackConnectUrl,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { createNotice } = dispatch( 'core/notices' );\n\n\t\treturn {\n\t\t\tcreateNotice,\n\t\t};\n\t} )\n)( Connect );\n","/**\n * External dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { decodeEntities } from '@wordpress/html-entities';\nimport { escapeRegExp } from 'lodash';\nimport { Fragment } from '@wordpress/element';\nimport { useEffect, useMemo, useState } from 'react';\nimport { getSetting } from '@woocommerce/wc-admin-settings';\n\n/**\n * Internal dependencies\n */\nimport { SelectControl, TextControl } from '@woocommerce/components';\n\nconst { countries } = getSetting( 'dataEndpoints', { countries: {} } );\n/**\n * Form validation.\n *\n * @param {Object} values Keyed values of all fields in the form.\n * @return {Object} Key value of fields and error messages, { myField: 'This field is required' }\n */\nexport function validateStoreAddress( values ) {\n\tconst errors = {};\n\n\tif ( ! values.addressLine1.length ) {\n\t\terrors.addressLine1 = __(\n\t\t\t'Please add an address',\n\t\t\t'woocommerce-admin'\n\t\t);\n\t}\n\tif ( ! values.countryState.length ) {\n\t\terrors.countryState = __(\n\t\t\t'Please select a country / region',\n\t\t\t'woocommerce-admin'\n\t\t);\n\t}\n\tif ( ! values.city.length ) {\n\t\terrors.city = __( 'Please add a city', 'woocommerce-admin' );\n\t}\n\tif ( ! values.postCode.length ) {\n\t\terrors.postCode = __( 'Please add a post code', 'woocommerce-admin' );\n\t}\n\n\treturn errors;\n}\n\n/**\n * Get all country and state combinations used for select dropdowns.\n *\n * @return {Object} Select options, { value: 'US:GA', label: 'United States - Georgia' }\n */\nexport function getCountryStateOptions() {\n\tconst countryStateOptions = countries.reduce( ( acc, country ) => {\n\t\tif ( ! country.states.length ) {\n\t\t\tacc.push( {\n\t\t\t\tkey: country.code,\n\t\t\t\tlabel: decodeEntities( country.name ),\n\t\t\t} );\n\n\t\t\treturn acc;\n\t\t}\n\n\t\tconst countryStates = country.states.map( ( state ) => {\n\t\t\treturn {\n\t\t\t\tkey: country.code + ':' + state.code,\n\t\t\t\tlabel:\n\t\t\t\t\tdecodeEntities( country.name ) +\n\t\t\t\t\t' — ' +\n\t\t\t\t\tdecodeEntities( state.name ),\n\t\t\t};\n\t\t} );\n\n\t\tacc.push( ...countryStates );\n\n\t\treturn acc;\n\t}, [] );\n\n\treturn countryStateOptions;\n}\n\n/**\n * Get the autofill countryState fields and set value from filtered options.\n *\n * @param {Array} options Array of filterable options.\n * @param {string} countryState The value of the countryState field.\n * @param {Function} setValue Set value of the countryState input.\n * @return {Object} React component.\n */\nexport function useGetCountryStateAutofill( options, countryState, setValue ) {\n\tconst [ autofillCountry, setAutofillCountry ] = useState( '' );\n\tconst [ autofillState, setAutofillState ] = useState( '' );\n\n\tuseEffect( () => {\n\t\tlet filteredOptions = [];\n\t\tconst countrySearch = new RegExp(\n\t\t\tescapeRegExp( autofillCountry ),\n\t\t\t'i'\n\t\t);\n\t\tif ( autofillState.length || autofillCountry.length ) {\n\t\t\tfilteredOptions = options.filter( ( option ) =>\n\t\t\t\tcountrySearch.test( option.label )\n\t\t\t);\n\t\t}\n\t\tif ( autofillCountry.length && autofillState.length ) {\n\t\t\tconst stateSearch = new RegExp(\n\t\t\t\tescapeRegExp( autofillState.replace( /\\s/g, '' ) ),\n\t\t\t\t'i'\n\t\t\t);\n\t\t\tfilteredOptions = filteredOptions.filter( ( option ) =>\n\t\t\t\tstateSearch.test(\n\t\t\t\t\toption.label.replace( '-', '' ).replace( /\\s/g, '' )\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif ( filteredOptions.length > 1 ) {\n\t\t\t\tlet countryKeyOptions = [];\n\t\t\t\tcountryKeyOptions = filteredOptions.filter( ( option ) =>\n\t\t\t\t\tcountrySearch.test( option.key )\n\t\t\t\t);\n\n\t\t\t\tif ( countryKeyOptions.length > 0 ) {\n\t\t\t\t\tfilteredOptions = countryKeyOptions;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( filteredOptions.length > 1 ) {\n\t\t\t\tlet stateKeyOptions = [];\n\t\t\t\tstateKeyOptions = filteredOptions.filter( ( option ) =>\n\t\t\t\t\tstateSearch.test( option.key )\n\t\t\t\t);\n\n\t\t\t\tif ( stateKeyOptions.length === 1 ) {\n\t\t\t\t\tfilteredOptions = stateKeyOptions;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\tfilteredOptions.length === 1 &&\n\t\t\tcountryState !== filteredOptions[ 0 ].key\n\t\t) {\n\t\t\tsetValue( 'countryState', filteredOptions[ 0 ].key );\n\t\t}\n\t}, [ autofillCountry, autofillState ] );\n\n\treturn (\n\t\t<Fragment>\n\t\t\t<input\n\t\t\t\tonChange={ ( event ) =>\n\t\t\t\t\tsetAutofillCountry( event.target.value )\n\t\t\t\t}\n\t\t\t\tvalue={ autofillCountry }\n\t\t\t\tname=\"country\"\n\t\t\t\ttype=\"text\"\n\t\t\t\tclassName=\"woocommerce-select-control__autofill-input\"\n\t\t\t\ttabIndex=\"-1\"\n\t\t\t\tautoComplete=\"country\"\n\t\t\t/>\n\n\t\t\t<input\n\t\t\t\tonChange={ ( event ) => setAutofillState( event.target.value ) }\n\t\t\t\tvalue={ autofillState }\n\t\t\t\tname=\"state\"\n\t\t\t\ttype=\"text\"\n\t\t\t\tclassName=\"woocommerce-select-control__autofill-input\"\n\t\t\t\ttabIndex=\"-1\"\n\t\t\t\tautoComplete=\"address-level1\"\n\t\t\t/>\n\t\t</Fragment>\n\t);\n}\n\n/**\n * Store address fields.\n *\n * @param {Object} props Props for input components.\n * @return {Object} -\n */\nexport function StoreAddress( props ) {\n\tconst { getInputProps, setValue } = props;\n\tconst countryStateOptions = useMemo( () => getCountryStateOptions(), [] );\n\tconst countryStateAutofill = useGetCountryStateAutofill(\n\t\tcountryStateOptions,\n\t\tgetInputProps( 'countryState' ).value,\n\t\tsetValue\n\t);\n\n\treturn (\n\t\t<div className=\"woocommerce-store-address-fields\">\n\t\t\t<TextControl\n\t\t\t\tlabel={ __( 'Address line 1', 'woocommerce-admin' ) }\n\t\t\t\trequired\n\t\t\t\tautoComplete=\"address-line1\"\n\t\t\t\t{ ...getInputProps( 'addressLine1' ) }\n\t\t\t/>\n\n\t\t\t<TextControl\n\t\t\t\tlabel={ __( 'Address line 2 (optional)', 'woocommerce-admin' ) }\n\t\t\t\trequired\n\t\t\t\tautoComplete=\"address-line2\"\n\t\t\t\t{ ...getInputProps( 'addressLine2' ) }\n\t\t\t/>\n\n\t\t\t<SelectControl\n\t\t\t\tlabel={ __( 'Country / Region', 'woocommerce-admin' ) }\n\t\t\t\trequired\n\t\t\t\toptions={ countryStateOptions }\n\t\t\t\texcludeSelectedOptions={ false }\n\t\t\t\tshowAllOnFocus\n\t\t\t\tisSearchable\n\t\t\t\t{ ...getInputProps( 'countryState' ) }\n\t\t\t\tcontrolClassName={ getInputProps( 'countryState' ).className }\n\t\t\t>\n\t\t\t\t{ countryStateAutofill }\n\t\t\t</SelectControl>\n\n\t\t\t<TextControl\n\t\t\t\tlabel={ __( 'City', 'woocommerce-admin' ) }\n\t\t\t\trequired\n\t\t\t\t{ ...getInputProps( 'city' ) }\n\t\t\t\tautoComplete=\"address-level2\"\n\t\t\t/>\n\n\t\t\t<TextControl\n\t\t\t\tlabel={ __( 'Post code', 'woocommerce-admin' ) }\n\t\t\t\trequired\n\t\t\t\tautoComplete=\"postal-code\"\n\t\t\t\t{ ...getInputProps( 'postCode' ) }\n\t\t\t/>\n\t\t</div>\n\t);\n}\n","/**\n * External dependencies\n */\nimport { addQueryArgs } from '@wordpress/url';\n\n/**\n * WooCommerce dependencies\n */\nimport { getSetting } from '@woocommerce/wc-admin-settings';\n\n/**\n * Returns an in-app-purchase URL.\n *\n * @param {string} url\n * @param {Object} queryArgs\n * @return {string} url with in-app-purchase query parameters\n */\nexport const getInAppPurchaseUrl = ( url, queryArgs = {} ) => {\n\tconst { pathname, search } = window.location;\n\tconst connectNonce = getSetting( 'connectNonce', '' );\n\tqueryArgs = {\n\t\t'wccom-site': getSetting( 'siteUrl' ),\n\t\t// If the site is installed in a directory the directory must be included in the back param path.\n\t\t'wccom-back': pathname + search,\n\t\t'wccom-woo-version': getSetting( 'wcVersion' ),\n\t\t'wccom-connect-nonce': connectNonce,\n\t\t...queryArgs,\n\t};\n\n\treturn addQueryArgs( url, queryArgs );\n};\n","/**\n * External dependencies\n */\nimport { sanitize } from 'dompurify';\n\nexport const ALLOWED_TAGS = [ 'a', 'b', 'em', 'i', 'strong', 'p' ];\nexport const ALLOWED_ATTR = [ 'target', 'href', 'rel', 'name', 'download' ];\n\nexport default ( html ) => {\n\treturn {\n\t\t__html: sanitize( html, { ALLOWED_TAGS, ALLOWED_ATTR } ),\n\t};\n};\n","/**\n * External dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Component, cloneElement, Fragment } from '@wordpress/element';\nimport { compose } from '@wordpress/compose';\nimport classNames from 'classnames';\nimport {\n\tButton,\n\tCard,\n\tCardBody,\n\tCardHeader,\n\t__experimentalText as Text,\n} from '@wordpress/components';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { Icon, check, chevronRight } from '@wordpress/icons';\nimport { xor } from 'lodash';\n\n/**\n * WooCommerce dependencies\n */\nimport { List, EllipsisMenu } from '@woocommerce/components';\nimport { updateQueryString } from '@woocommerce/navigation';\nimport {\n\tPLUGINS_STORE_NAME,\n\tOPTIONS_STORE_NAME,\n\tONBOARDING_STORE_NAME,\n\tSETTINGS_STORE_NAME,\n} from '@woocommerce/data';\n\n/**\n * Internal dependencies\n */\nimport './style.scss';\nimport CartModal from 'dashboard/components/cart-modal';\nimport { getAllTasks, recordTaskViewEvent } from './tasks';\nimport { getCountryCode } from 'dashboard/utils';\nimport { recordEvent } from 'lib/tracks';\n\nclass TaskDashboard extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\t\tthis.state = {\n\t\t\tisCartModalOpen: false,\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\tdocument.body.classList.add( 'woocommerce-onboarding' );\n\t\tdocument.body.classList.add( 'woocommerce-task-dashboard__body' );\n\n\t\tthis.recordTaskView();\n\t\tthis.recordTaskListView();\n\t\tthis.possiblyCompleteTaskList();\n\t\tthis.possiblyTrackCompletedTasks();\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tconst { query } = this.props;\n\t\tconst { query: prevQuery } = prevProps;\n\t\tconst { task: prevTask } = prevQuery;\n\t\tconst { task } = query;\n\n\t\tif ( prevTask !== task ) {\n\t\t\twindow.document.documentElement.scrollTop = 0;\n\t\t\tthis.recordTaskView();\n\t\t}\n\n\t\tthis.possiblyCompleteTaskList();\n\t\tthis.possiblyTrackCompletedTasks();\n\t}\n\n\tpossiblyCompleteTaskList() {\n\t\tconst { isTaskListComplete, updateOptions } = this.props;\n\n\t\tif ( ! this.getIncompleteTasks().length && ! isTaskListComplete ) {\n\t\t\tupdateOptions( {\n\t\t\t\twoocommerce_task_list_complete: 'yes',\n\t\t\t} );\n\t\t}\n\t}\n\n\tgetCompletedTaskKeys() {\n\t\treturn this.getVisibleTasks()\n\t\t\t.filter( ( task ) => task.completed )\n\t\t\t.map( ( task ) => task.key );\n\t}\n\n\tgetIncompleteTasks() {\n\t\treturn this.getAllTasks().filter(\n\t\t\t( task ) => task.visible && ! task.completed\n\t\t);\n\t}\n\n\tpossiblyTrackCompletedTasks() {\n\t\tconst { trackedCompletedTasks, updateOptions } = this.props;\n\t\tconst completedTaskKeys = this.getCompletedTaskKeys();\n\n\t\tif ( xor( trackedCompletedTasks, completedTaskKeys ).length !== 0 ) {\n\t\t\tupdateOptions( {\n\t\t\t\twoocommerce_task_list_tracked_completed_tasks: completedTaskKeys,\n\t\t\t} );\n\t\t}\n\t}\n\n\tdismissTask( key ) {\n\t\tconst { createNotice, dismissedTasks, updateOptions } = this.props;\n\n\t\tcreateNotice( 'success', __( 'Task dismissed' ), {\n\t\t\tactions: [\n\t\t\t\t{\n\t\t\t\t\tlabel: __( 'Undo', 'woocommerce-admin' ),\n\t\t\t\t\tonClick: () => this.undoDismissTask( key ),\n\t\t\t\t},\n\t\t\t],\n\t\t} );\n\n\t\trecordEvent( 'tasklist_dismiss_task', { task_name: key } );\n\n\t\tupdateOptions( {\n\t\t\twoocommerce_task_list_dismissed_tasks: [ ...dismissedTasks, key ],\n\t\t} );\n\t}\n\n\tundoDismissTask( key ) {\n\t\tconst { dismissedTasks, updateOptions } = this.props;\n\n\t\tconst updatedDismissedTasks = dismissedTasks.filter(\n\t\t\t( task ) => task !== key\n\t\t);\n\n\t\tupdateOptions( {\n\t\t\twoocommerce_task_list_dismissed_tasks: updatedDismissedTasks,\n\t\t} );\n\t}\n\n\tcomponentWillUnmount() {\n\t\tdocument.body.classList.remove( 'woocommerce-onboarding' );\n\t\tdocument.body.classList.remove( 'woocommerce-task-dashboard__body' );\n\t}\n\n\tgetAllTasks() {\n\t\tconst {\n\t\t\tcountryCode,\n\t\t\tprofileItems,\n\t\t\tquery,\n\t\t\ttaskListPayments,\n\t\t\tactivePlugins,\n\t\t\tinstalledPlugins,\n\t\t\tinstallAndActivatePlugins,\n\t\t\tcreateNotice,\n\t\t\tisJetpackConnected,\n\t\t} = this.props;\n\n\t\treturn getAllTasks( {\n\t\t\tcountryCode,\n\t\t\tprofileItems,\n\t\t\ttaskListPayments,\n\t\t\tquery,\n\t\t\ttoggleCartModal: this.toggleCartModal.bind( this ),\n\t\t\tactivePlugins,\n\t\t\tinstalledPlugins,\n\t\t\tinstallAndActivatePlugins,\n\t\t\tcreateNotice,\n\t\t\tisJetpackConnected,\n\t\t} );\n\t}\n\n\tgetVisibleTasks() {\n\t\tconst { dismissedTasks } = this.props;\n\n\t\treturn this.getAllTasks().filter(\n\t\t\t( task ) => task.visible && ! dismissedTasks.includes( task.key )\n\t\t);\n\t}\n\n\trecordTaskView() {\n\t\tconst {\n\t\t\tisJetpackConnected,\n\t\t\tactivePlugins,\n\t\t\tinstalledPlugins,\n\t\t\tquery,\n\t\t} = this.props;\n\t\tconst { task: taskName } = query;\n\n\t\tif ( ! taskName ) {\n\t\t\treturn;\n\t\t}\n\n\t\trecordTaskViewEvent(\n\t\t\ttaskName,\n\t\t\tisJetpackConnected,\n\t\t\tactivePlugins,\n\t\t\tinstalledPlugins\n\t\t);\n\t}\n\n\trecordTaskListView() {\n\t\tif ( this.getCurrentTask() ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { profileItems } = this.props;\n\t\tconst tasks = this.getVisibleTasks();\n\n\t\trecordEvent( 'tasklist_view', {\n\t\t\tnumber_tasks: tasks.length,\n\t\t\tstore_connected: profileItems.wccom_connected,\n\t\t} );\n\t}\n\n\tkeepTaskCard() {\n\t\trecordEvent( 'tasklist_completed', {\n\t\t\taction: 'keep_card',\n\t\t} );\n\n\t\tthis.props.updateOptions( {\n\t\t\twoocommerce_task_list_prompt_shown: true,\n\t\t} );\n\t}\n\n\thideTaskCard( action ) {\n\t\trecordEvent( 'tasklist_completed', {\n\t\t\taction,\n\t\t} );\n\t\tthis.props.updateOptions( {\n\t\t\twoocommerce_task_list_hidden: 'yes',\n\t\t\twoocommerce_task_list_prompt_shown: true,\n\t\t} );\n\t}\n\n\tgetCurrentTask() {\n\t\tconst { query } = this.props;\n\t\tconst { task } = query;\n\t\tconst currentTask = this.getAllTasks().find( ( s ) => s.key === task );\n\n\t\tif ( ! currentTask ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn currentTask;\n\t}\n\n\trenderMenu() {\n\t\treturn (\n\t\t\t<div className=\"woocommerce-card__menu woocommerce-card__header-item\">\n\t\t\t\t<EllipsisMenu\n\t\t\t\t\tlabel={ __( 'Task List Options', 'woocommerce-admin' ) }\n\t\t\t\t\trenderContent={ () => (\n\t\t\t\t\t\t<div className=\"woocommerce-task-card__section-controls\">\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tonClick={ () =>\n\t\t\t\t\t\t\t\t\tthis.hideTaskCard( 'remove_card' )\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ __( 'Hide this', 'woocommerce-admin' ) }\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) }\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\n\ttoggleCartModal() {\n\t\tconst { isCartModalOpen } = this.state;\n\n\t\tif ( ! isCartModalOpen ) {\n\t\t\trecordEvent( 'tasklist_purchase_extensions' );\n\t\t}\n\n\t\tthis.setState( { isCartModalOpen: ! isCartModalOpen } );\n\t}\n\n\trender() {\n\t\tconst { query } = this.props;\n\t\tconst { isCartModalOpen } = this.state;\n\t\tconst currentTask = this.getCurrentTask();\n\t\tconst listTasks = this.getVisibleTasks().map( ( task ) => {\n\t\t\ttask.className = classNames(\n\t\t\t\ttask.completed ? 'is-complete' : null,\n\t\t\t\ttask.className\n\t\t\t);\n\t\t\ttask.before = (\n\t\t\t\t<div className=\"woocommerce-task__icon\">\n\t\t\t\t\t{ task.completed && <Icon icon={ check } /> }\n\t\t\t\t</div>\n\t\t\t);\n\n\t\t\ttask.title = (\n\t\t\t\t<Text\n\t\t\t\t\tas=\"div\"\n\t\t\t\t\tvariant={ task.completed ? 'body.small' : 'button' }\n\t\t\t\t>\n\t\t\t\t\t{ task.title }\n\t\t\t\t\t{ task.time && ! task.completed && (\n\t\t\t\t\t\t<span className=\"woocommerce-task__estimated-time\">\n\t\t\t\t\t\t\t{ task.time }\n\t\t\t\t\t\t</span>\n\t\t\t\t\t) }\n\t\t\t\t</Text>\n\t\t\t);\n\n\t\t\tif ( ! task.completed ) {\n\t\t\t\ttask.after = task.isDismissable ? (\n\t\t\t\t\t<Button\n\t\t\t\t\t\tisTertiary\n\t\t\t\t\t\tonClick={ ( event ) => {\n\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t\tthis.dismissTask( task.key );\n\t\t\t\t\t\t} }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Dismiss', 'woocommerce-admin' ) }\n\t\t\t\t\t</Button>\n\t\t\t\t) : (\n\t\t\t\t\t<Icon icon={ chevronRight } />\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif ( ! task.onClick ) {\n\t\t\t\ttask.onClick = () => updateQueryString( { task: task.key } );\n\t\t\t}\n\n\t\t\treturn task;\n\t\t} );\n\t\tconst progressBarClass = classNames(\n\t\t\t'woocommerce-task-card__progress-bar',\n\t\t\t{\n\t\t\t\tcompleted:\n\t\t\t\t\tlistTasks.length === this.getCompletedTaskKeys().length,\n\t\t\t}\n\t\t);\n\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t<div className=\"woocommerce-task-dashboard__container\">\n\t\t\t\t\t{ currentTask ? (\n\t\t\t\t\t\tcloneElement( currentTask.container, {\n\t\t\t\t\t\t\tquery,\n\t\t\t\t\t\t} )\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t\t<Card\n\t\t\t\t\t\t\t\tsize=\"large\"\n\t\t\t\t\t\t\t\tclassName=\"woocommerce-task-card woocommerce-dashboard-card\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<progress\n\t\t\t\t\t\t\t\t\tclassName={ progressBarClass }\n\t\t\t\t\t\t\t\t\tmax={ listTasks.length }\n\t\t\t\t\t\t\t\t\tvalue={ this.getCompletedTaskKeys().length }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<CardHeader size=\"medium\">\n\t\t\t\t\t\t\t\t\t<Text variant=\"title.small\">\n\t\t\t\t\t\t\t\t\t\t{ __(\n\t\t\t\t\t\t\t\t\t\t\t'Finish setup',\n\t\t\t\t\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t\t\t{ this.renderMenu() }\n\t\t\t\t\t\t\t\t</CardHeader>\n\t\t\t\t\t\t\t\t<CardBody>\n\t\t\t\t\t\t\t\t\t<List items={ listTasks } />\n\t\t\t\t\t\t\t\t</CardBody>\n\t\t\t\t\t\t\t</Card>\n\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t\t{ isCartModalOpen && (\n\t\t\t\t\t<CartModal\n\t\t\t\t\t\tonClose={ () => this.toggleCartModal() }\n\t\t\t\t\t\tonClickPurchaseLater={ () => this.toggleCartModal() }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</Fragment>\n\t\t);\n\t}\n}\n\nexport default compose(\n\twithSelect( ( select ) => {\n\t\tconst { getProfileItems } = select( ONBOARDING_STORE_NAME );\n\t\tconst { getOption } = select( OPTIONS_STORE_NAME );\n\t\tconst { getSettings } = select( SETTINGS_STORE_NAME );\n\t\tconst {\n\t\t\tgetActivePlugins,\n\t\t\tgetInstalledPlugins,\n\t\t\tisJetpackConnected,\n\t\t} = select( PLUGINS_STORE_NAME );\n\t\tconst profileItems = getProfileItems();\n\n\t\tconst isTaskListComplete =\n\t\t\tgetOption( 'woocommerce_task_list_complete' ) || false;\n\t\tconst taskListPayments = getOption( 'woocommerce_task_list_payments' );\n\t\tconst trackedCompletedTasks =\n\t\t\tgetOption( 'woocommerce_task_list_tracked_completed_tasks' ) || [];\n\n\t\tconst payments = getOption( 'woocommerce_task_list_payments' );\n\t\tconst dismissedTasks =\n\t\t\tgetOption( 'woocommerce_task_list_dismissed_tasks' ) || [];\n\n\t\tconst { general: generalSettings = {} } = getSettings( 'general' );\n\t\tconst countryCode = getCountryCode(\n\t\t\tgeneralSettings.woocommerce_default_country\n\t\t);\n\n\t\tconst activePlugins = getActivePlugins();\n\t\tconst installedPlugins = getInstalledPlugins();\n\n\t\treturn {\n\t\t\tactivePlugins,\n\t\t\tcountryCode,\n\t\t\tdismissedTasks,\n\t\t\tisJetpackConnected: isJetpackConnected(),\n\t\t\tinstalledPlugins,\n\t\t\tisTaskListComplete,\n\t\t\tpayments,\n\t\t\tprofileItems,\n\t\t\ttaskListPayments,\n\t\t\ttrackedCompletedTasks,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { createNotice } = dispatch( 'core/notices' );\n\t\tconst { updateOptions } = dispatch( OPTIONS_STORE_NAME );\n\t\tconst { installAndActivatePlugins } = dispatch( PLUGINS_STORE_NAME );\n\n\t\treturn {\n\t\t\tcreateNotice,\n\t\t\tinstallAndActivatePlugins,\n\t\t\tupdateOptions,\n\t\t};\n\t} )\n)( TaskDashboard );\n","/**\n * External dependencies\n */\n\nimport { __, sprintf } from '@wordpress/i18n';\nimport { applyFilters } from '@wordpress/hooks';\n\n/**\n * WooCommerce dependencies\n */\nimport { getSetting } from '@woocommerce/wc-admin-settings';\nimport {\n\tgetHistory,\n\tgetNewPath,\n\tupdateQueryString,\n} from '@woocommerce/navigation';\nimport { Fragment } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport Appearance from './tasks/appearance';\nimport { getCategorizedOnboardingProducts } from 'dashboard/utils';\nimport Products from './tasks/products';\nimport Shipping from './tasks/shipping';\nimport Tax from './tasks/tax';\nimport Payments from './tasks/payments';\nimport { installActivateAndConnectWcpay } from './tasks/payments/methods';\nimport { recordEvent } from 'lib/tracks';\n\nexport function recordTaskViewEvent(\n\ttaskName,\n\tisJetpackConnected,\n\tactivePlugins,\n\tinstalledPlugins\n) {\n\trecordEvent( 'task_view', {\n\t\ttask_name: taskName,\n\t\twcs_installed: installedPlugins.includes( 'woocommerce-services' ),\n\t\twcs_active: activePlugins.includes( 'woocommerce-services' ),\n\t\tjetpack_installed: installedPlugins.includes( 'jetpack' ),\n\t\tjetpack_active: activePlugins.includes( 'jetpack' ),\n\t\tjetpack_connected: isJetpackConnected,\n\t} );\n}\n\nexport function getAllTasks( {\n\tcountryCode,\n\tprofileItems,\n\ttaskListPayments,\n\tquery,\n\ttoggleCartModal,\n\tactivePlugins,\n\tinstalledPlugins,\n\tinstallAndActivatePlugins,\n\tcreateNotice,\n\tisJetpackConnected,\n} ) {\n\tconst {\n\t\thasPhysicalProducts,\n\t\thasProducts,\n\t\tisAppearanceComplete,\n\t\tisTaxComplete,\n\t\tshippingZonesCount,\n\t} = getSetting( 'onboarding', {\n\t\thasPhysicalProducts: false,\n\t\thasProducts: false,\n\t\tisAppearanceComplete: false,\n\t\tisTaxComplete: false,\n\t\tshippingZonesCount: 0,\n\t} );\n\n\tconst groupedProducts = getCategorizedOnboardingProducts(\n\t\tprofileItems,\n\t\tinstalledPlugins\n\t);\n\n\tconst { products, remainingProducts, uniqueItemsList } = groupedProducts;\n\n\tconst paymentsCompleted = Boolean(\n\t\ttaskListPayments && taskListPayments.completed\n\t);\n\tconst paymentsSkipped = Boolean(\n\t\ttaskListPayments && taskListPayments.skipped\n\t);\n\n\tconst woocommercePaymentsInstalled =\n\t\tinstalledPlugins.indexOf( 'woocommerce-payments' ) !== -1;\n\tconst {\n\t\tcompleted: profilerCompleted,\n\t\tproduct_types: productTypes,\n\t} = profileItems;\n\n\tlet purchaseAndInstallText = __( 'Purchase & install extensions' );\n\n\tif ( uniqueItemsList.length === 1 ) {\n\t\tconst { name: itemName, type: itemType } = uniqueItemsList[ 0 ];\n\t\tconst purchaseAndInstallFormat =\n\t\t\titemType === 'theme'\n\t\t\t\t? __( 'Purchase & install %s theme', 'woocommerce-admin' )\n\t\t\t\t: __( 'Purchase & install %s extension', 'woocommerce-admin' );\n\t\tpurchaseAndInstallText = sprintf( purchaseAndInstallFormat, itemName );\n\t}\n\n\tconst tasks = [\n\t\t{\n\t\t\tkey: 'store_details',\n\t\t\ttitle: __( 'Store details', 'woocommerce-admin' ),\n\t\t\tcontainer: null,\n\t\t\tonClick: () => {\n\t\t\t\trecordEvent( 'tasklist_click', {\n\t\t\t\t\ttask_name: 'store_details',\n\t\t\t\t} );\n\t\t\t\tgetHistory().push( getNewPath( {}, `/profiler`, {} ) );\n\t\t\t},\n\t\t\tcompleted: profilerCompleted,\n\t\t\tvisible: true,\n\t\t\ttime: __( '4 minutes', 'woocommerce-admin' ),\n\t\t},\n\t\t{\n\t\t\tkey: 'purchase',\n\t\t\ttitle: purchaseAndInstallText,\n\t\t\tcontainer: null,\n\t\t\tonClick: () => {\n\t\t\t\trecordEvent( 'tasklist_click', {\n\t\t\t\t\ttask_name: 'purchase',\n\t\t\t\t} );\n\t\t\t\treturn remainingProducts.length ? toggleCartModal() : null;\n\t\t\t},\n\t\t\tvisible: products.length,\n\t\t\tcompleted: products.length && ! remainingProducts.length,\n\t\t\ttime: __( '2 minutes', 'woocommerce-admin' ),\n\t\t\tisDismissable: true,\n\t\t},\n\t\t{\n\t\t\tkey: 'products',\n\t\t\ttitle: __( 'Add my products', 'woocommerce-admin' ),\n\t\t\tcontainer: <Products />,\n\t\t\tonClick: () => {\n\t\t\t\trecordEvent( 'tasklist_click', {\n\t\t\t\t\ttask_name: 'products',\n\t\t\t\t} );\n\t\t\t\tupdateQueryString( { task: 'products' } );\n\t\t\t},\n\t\t\tcompleted: hasProducts,\n\t\t\tvisible: true,\n\t\t\ttime: __( '1 minute per product', 'woocommerce-admin' ),\n\t\t},\n\t\t{\n\t\t\tkey: 'woocommerce-payments',\n\t\t\ttitle: __( 'Set up WooCommerce Payments', 'woocommerce-admin' ),\n\t\t\tcontainer: <Fragment />,\n\t\t\tcompleted: paymentsCompleted || paymentsSkipped,\n\t\t\tonClick: async () => {\n\t\t\t\tawait new Promise( ( resolve, reject ) => {\n\t\t\t\t\t// This task doesn't have a view, so the recordEvent call\n\t\t\t\t\t// in TaskDashboard.recordTaskView() is never called. So\n\t\t\t\t\t// record it here.\n\t\t\t\t\trecordTaskViewEvent(\n\t\t\t\t\t\t'wcpay',\n\t\t\t\t\t\tisJetpackConnected,\n\t\t\t\t\t\tactivePlugins,\n\t\t\t\t\t\tinstalledPlugins\n\t\t\t\t\t);\n\t\t\t\t\trecordEvent( 'tasklist_click', {\n\t\t\t\t\t\ttask_name: 'woocommerce-payments',\n\t\t\t\t\t} );\n\t\t\t\t\treturn installActivateAndConnectWcpay(\n\t\t\t\t\t\tresolve,\n\t\t\t\t\t\treject,\n\t\t\t\t\t\tcreateNotice,\n\t\t\t\t\t\tinstallAndActivatePlugins\n\t\t\t\t\t);\n\t\t\t\t} );\n\t\t\t},\n\t\t\tvisible:\n\t\t\t\twindow.wcAdminFeatures.wcpay &&\n\t\t\t\twoocommercePaymentsInstalled &&\n\t\t\t\tcountryCode === 'US',\n\t\t\ttime: __( '2 minutes', 'woocommerce-admin' ),\n\t\t},\n\t\t{\n\t\t\tkey: 'payments',\n\t\t\ttitle: __( 'Set up payments', 'woocommerce-admin' ),\n\t\t\tcontainer: <Payments />,\n\t\t\tcompleted: paymentsCompleted || paymentsSkipped,\n\t\t\tonClick: () => {\n\t\t\t\trecordEvent( 'tasklist_click', {\n\t\t\t\t\ttask_name: 'payments',\n\t\t\t\t} );\n\t\t\t\tupdateQueryString( { task: 'payments' } );\n\t\t\t},\n\t\t\tvisible: ! woocommercePaymentsInstalled,\n\t\t\ttime: __( '2 minutes', 'woocommerce-admin' ),\n\t\t},\n\t\t{\n\t\t\tkey: 'tax',\n\t\t\ttitle: __( 'Set up tax', 'woocommerce-admin' ),\n\t\t\tcontainer: <Tax />,\n\t\t\tonClick: () => {\n\t\t\t\trecordEvent( 'tasklist_click', {\n\t\t\t\t\ttask_name: 'tax',\n\t\t\t\t} );\n\t\t\t\tupdateQueryString( { task: 'tax' } );\n\t\t\t},\n\t\t\tcompleted: isTaxComplete,\n\t\t\tvisible: true,\n\t\t\ttime: __( '1 minute', 'woocommerce-admin' ),\n\t\t},\n\t\t{\n\t\t\tkey: 'shipping',\n\t\t\ttitle: __( 'Set up shipping', 'woocommerce-admin' ),\n\t\t\tcontainer: <Shipping />,\n\t\t\tonClick: () => {\n\t\t\t\trecordEvent( 'tasklist_click', {\n\t\t\t\t\ttask_name: 'shipping',\n\t\t\t\t} );\n\t\t\t\tupdateQueryString( { task: 'shipping' } );\n\t\t\t},\n\t\t\tcompleted: shippingZonesCount > 0,\n\t\t\tvisible:\n\t\t\t\t( productTypes && productTypes.includes( 'physical' ) ) ||\n\t\t\t\thasPhysicalProducts,\n\t\t\ttime: __( '1 minute', 'woocommerce-admin' ),\n\t\t},\n\t\t{\n\t\t\tkey: 'appearance',\n\t\t\ttitle: __( 'Personalize my store', 'woocommerce-admin' ),\n\t\t\tcontainer: <Appearance />,\n\t\t\tonClick: () => {\n\t\t\t\trecordEvent( 'tasklist_click', {\n\t\t\t\t\ttask_name: 'appearance',\n\t\t\t\t} );\n\t\t\t\tupdateQueryString( { task: 'appearance' } );\n\t\t\t},\n\t\t\tcompleted: isAppearanceComplete,\n\t\t\tvisible: true,\n\t\t\ttime: __( '2 minutes', 'woocommerce-admin' ),\n\t\t},\n\t];\n\n\treturn applyFilters(\n\t\t'woocommerce_admin_onboarding_task_list',\n\t\ttasks,\n\t\tquery\n\t);\n}\n","/**\n * External dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport apiFetch from '@wordpress/api-fetch';\nimport { Button } from '@wordpress/components';\nimport { Component, Fragment } from '@wordpress/element';\nimport { compose } from '@wordpress/compose';\nimport { filter } from 'lodash';\nimport { withDispatch, withSelect } from '@wordpress/data';\n\n/**\n * WooCommerce dependencies\n */\nimport {\n\tCard,\n\tStepper,\n\tTextControl,\n\tImageUpload,\n} from '@woocommerce/components';\nimport { getHistory, getNewPath } from '@woocommerce/navigation';\nimport { getSetting, setSetting } from '@woocommerce/wc-admin-settings';\nimport { OPTIONS_STORE_NAME } from '@woocommerce/data';\n\n/**\n * Internal dependencies\n */\nimport { queueRecordEvent, recordEvent } from 'lib/tracks';\nimport { WC_ADMIN_NAMESPACE } from 'wc-api/constants';\n\nclass Appearance extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\t\tconst { hasHomepage, hasProducts } = getSetting( 'onboarding', {} );\n\n\t\tthis.stepVisibility = {\n\t\t\thomepage: ! hasHomepage,\n\t\t\timport: ! hasProducts,\n\t\t};\n\n\t\tthis.state = {\n\t\t\tisDirty: false,\n\t\t\tisPending: false,\n\t\t\tlogo: null,\n\t\t\tstepIndex: 0,\n\t\t\tisUpdatingLogo: false,\n\t\t\tisUpdatingNotice: false,\n\t\t\tstoreNoticeText: props.demoStoreNotice || '',\n\t\t};\n\n\t\tthis.completeStep = this.completeStep.bind( this );\n\t\tthis.createHomepage = this.createHomepage.bind( this );\n\t\tthis.importProducts = this.importProducts.bind( this );\n\t\tthis.updateLogo = this.updateLogo.bind( this );\n\t\tthis.updateNotice = this.updateNotice.bind( this );\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { themeMods } = getSetting( 'onboarding', {} );\n\n\t\tif ( themeMods.custom_logo ) {\n\t\t\t/* eslint-disable react/no-did-mount-set-state */\n\t\t\tthis.setState( { logo: { id: themeMods.custom_logo } } );\n\t\t\t/* eslint-enable react/no-did-mount-set-state */\n\t\t}\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tconst { isPending, logo } = this.state;\n\t\tconst { demoStoreNotice } = this.props;\n\n\t\tif ( logo && ! logo.url && ! isPending ) {\n\t\t\t/* eslint-disable react/no-did-update-set-state */\n\t\t\tthis.setState( { isPending: true } );\n\t\t\twp.media\n\t\t\t\t.attachment( logo.id )\n\t\t\t\t.fetch()\n\t\t\t\t.then( () => {\n\t\t\t\t\tconst logoUrl = wp.media.attachment( logo.id ).get( 'url' );\n\t\t\t\t\tthis.setState( {\n\t\t\t\t\t\tisPending: false,\n\t\t\t\t\t\tlogo: { id: logo.id, url: logoUrl },\n\t\t\t\t\t} );\n\t\t\t\t} );\n\t\t\t/* eslint-enable react/no-did-update-set-state */\n\t\t}\n\n\t\tif (\n\t\t\tdemoStoreNotice &&\n\t\t\tprevProps.demoStoreNotice !== demoStoreNotice\n\t\t) {\n\t\t\t/* eslint-disable react/no-did-update-set-state */\n\t\t\tthis.setState( {\n\t\t\t\tstoreNoticeText: demoStoreNotice,\n\t\t\t} );\n\t\t\t/* eslint-enable react/no-did-update-set-state */\n\t\t}\n\t}\n\n\tcompleteStep() {\n\t\tconst { stepIndex } = this.state;\n\t\tconst nextStep = this.getSteps()[ stepIndex + 1 ];\n\n\t\tif ( nextStep ) {\n\t\t\tthis.setState( { stepIndex: stepIndex + 1 } );\n\t\t} else {\n\t\t\tgetHistory().push( getNewPath( {}, '/', {} ) );\n\t\t}\n\t}\n\n\timportProducts() {\n\t\tconst { createNotice } = this.props;\n\t\tthis.setState( { isPending: true } );\n\n\t\trecordEvent( 'tasklist_appearance_import_demo', {} );\n\n\t\tapiFetch( {\n\t\t\tpath: `${ WC_ADMIN_NAMESPACE }/onboarding/tasks/import_sample_products`,\n\t\t\tmethod: 'POST',\n\t\t} )\n\t\t\t.then( ( result ) => {\n\t\t\t\tif ( result.failed && result.failed.length ) {\n\t\t\t\t\tcreateNotice(\n\t\t\t\t\t\t'error',\n\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t'There was an error importing some of the sample products.',\n\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tcreateNotice(\n\t\t\t\t\t\t'success',\n\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t'All sample products have been imported.',\n\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t\tsetSetting( 'onboarding', {\n\t\t\t\t\t\t...getSetting( 'onboarding', {} ),\n\t\t\t\t\t\thasProducts: true,\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\tthis.setState( { isPending: false } );\n\t\t\t\tthis.completeStep();\n\t\t\t} )\n\t\t\t.catch( ( error ) => {\n\t\t\t\tcreateNotice( 'error', error.message );\n\t\t\t\tthis.setState( { isPending: false } );\n\t\t\t} );\n\t}\n\n\tcreateHomepage() {\n\t\tconst { createNotice } = this.props;\n\t\tthis.setState( { isPending: true } );\n\n\t\trecordEvent( 'tasklist_appearance_create_homepage', {\n\t\t\tcreate_homepage: true,\n\t\t} );\n\n\t\tapiFetch( {\n\t\t\tpath: '/wc-admin/onboarding/tasks/create_homepage',\n\t\t\tmethod: 'POST',\n\t\t} )\n\t\t\t.then( ( response ) => {\n\t\t\t\tcreateNotice( response.status, response.message, {\n\t\t\t\t\tactions: response.edit_post_link\n\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlabel: __(\n\t\t\t\t\t\t\t\t\t\t'Customize',\n\t\t\t\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\t\t\tqueueRecordEvent(\n\t\t\t\t\t\t\t\t\t\t\t'tasklist_appearance_customize_homepage',\n\t\t\t\t\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\twindow.location = `${ response.edit_post_link }&wc_onboarding_active_task=homepage`;\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t  ]\n\t\t\t\t\t\t: null,\n\t\t\t\t} );\n\n\t\t\t\tthis.setState( { isPending: false } );\n\t\t\t\tthis.completeStep();\n\t\t\t} )\n\t\t\t.catch( ( error ) => {\n\t\t\t\tcreateNotice( 'error', error.message );\n\t\t\t\tthis.setState( { isPending: false } );\n\t\t\t} );\n\t}\n\n\tasync updateLogo() {\n\t\tconst { updateOptions, createNotice } = this.props;\n\t\tconst { logo } = this.state;\n\t\tconst { stylesheet, themeMods } = getSetting( 'onboarding', {} );\n\t\tconst updatedThemeMods = {\n\t\t\t...themeMods,\n\t\t\tcustom_logo: logo ? logo.id : null,\n\t\t};\n\n\t\trecordEvent( 'tasklist_appearance_upload_logo' );\n\n\t\tsetSetting( 'onboarding', {\n\t\t\t...getSetting( 'onboarding', {} ),\n\t\t\tthemeMods: updatedThemeMods,\n\t\t} );\n\n\t\tthis.setState( { isUpdatingLogo: true } );\n\t\tconst update = await updateOptions( {\n\t\t\t[ `theme_mods_${ stylesheet }` ]: updatedThemeMods,\n\t\t} );\n\n\t\tif ( update.success ) {\n\t\t\tthis.setState( { isUpdatingLogo: false } );\n\t\t\tcreateNotice(\n\t\t\t\t'success',\n\t\t\t\t__( 'Store logo updated sucessfully.', 'woocommerce-admin' )\n\t\t\t);\n\t\t\tthis.completeStep();\n\t\t} else {\n\t\t\tcreateNotice( 'error', update.message );\n\t\t}\n\t}\n\n\tasync updateNotice() {\n\t\tconst { updateOptions, createNotice } = this.props;\n\t\tconst { storeNoticeText } = this.state;\n\n\t\trecordEvent( 'tasklist_appearance_set_store_notice', {\n\t\t\tadded_text: Boolean( storeNoticeText.length ),\n\t\t} );\n\n\t\tsetSetting( 'onboarding', {\n\t\t\t...getSetting( 'onboarding', {} ),\n\t\t\tisAppearanceComplete: true,\n\t\t} );\n\n\t\tthis.setState( { isUpdatingNotice: true } );\n\t\tconst update = await updateOptions( {\n\t\t\twoocommerce_task_list_appearance_complete: true,\n\t\t\twoocommerce_demo_store: storeNoticeText.length ? 'yes' : 'no',\n\t\t\twoocommerce_demo_store_notice: storeNoticeText,\n\t\t} );\n\n\t\tif ( update.success ) {\n\t\t\tthis.setState( { isUpdatingNotice: false } );\n\t\t\tcreateNotice(\n\t\t\t\t'success',\n\t\t\t\t__(\n\t\t\t\t\t\"🎨 Your store is looking great! Don't forget to continue personalizing it.\",\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t)\n\t\t\t);\n\t\t\tthis.completeStep();\n\t\t} else {\n\t\t\tcreateNotice( 'error', update.message );\n\t\t}\n\t}\n\n\tgetSteps() {\n\t\tconst {\n\t\t\tisDirty,\n\t\t\tisPending,\n\t\t\tlogo,\n\t\t\tstoreNoticeText,\n\t\t\tisUpdatingLogo,\n\t\t} = this.state;\n\n\t\tconst steps = [\n\t\t\t{\n\t\t\t\tkey: 'import',\n\t\t\t\tlabel: __( 'Import sample products', 'woocommerce-admin' ),\n\t\t\t\tdescription: __(\n\t\t\t\t\t'We’ll add some products that will make it easier to see what your store looks like',\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t),\n\t\t\t\tcontent: (\n\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tonClick={ this.importProducts }\n\t\t\t\t\t\t\tisBusy={ isPending }\n\t\t\t\t\t\t\tisPrimary\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ __( 'Import products', 'woocommerce-admin' ) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button onClick={ () => this.completeStep() }>\n\t\t\t\t\t\t\t{ __( 'Skip', 'woocommerce-admin' ) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</Fragment>\n\t\t\t\t),\n\t\t\t\tvisible: this.stepVisibility.import,\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'homepage',\n\t\t\t\tlabel: __( 'Create a custom homepage', 'woocommerce-admin' ),\n\t\t\t\tdescription: __(\n\t\t\t\t\t'Create a new homepage and customize it to suit your needs',\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t),\n\t\t\t\tcontent: (\n\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tisPrimary\n\t\t\t\t\t\t\tisBusy={ isPending }\n\t\t\t\t\t\t\tonClick={ this.createHomepage }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ __( 'Create homepage', 'woocommerce-admin' ) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\trecordEvent(\n\t\t\t\t\t\t\t\t\t'tasklist_appearance_create_homepage',\n\t\t\t\t\t\t\t\t\t{ create_homepage: false }\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.completeStep();\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ __( 'Skip', 'woocommerce-admin' ) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</Fragment>\n\t\t\t\t),\n\t\t\t\tvisible: this.stepVisibility.homepage,\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'logo',\n\t\t\t\tlabel: __( 'Upload a logo', 'woocommerce-admin' ),\n\t\t\t\tdescription: __(\n\t\t\t\t\t'Ensure your store is on-brand by adding your logo',\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t),\n\t\t\t\tcontent: isPending ? null : (\n\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t<ImageUpload\n\t\t\t\t\t\t\timage={ logo }\n\t\t\t\t\t\t\tonChange={ ( image ) =>\n\t\t\t\t\t\t\t\tthis.setState( { isDirty: true, logo: image } )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tdisabled={ ! logo && ! isDirty }\n\t\t\t\t\t\t\tonClick={ this.updateLogo }\n\t\t\t\t\t\t\tisBusy={ isUpdatingLogo }\n\t\t\t\t\t\t\tisPrimary\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ __( 'Proceed', 'woocommerce-admin' ) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tisTertiary\n\t\t\t\t\t\t\tonClick={ () => this.completeStep() }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ __( 'Skip', 'woocommerce-admin' ) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</Fragment>\n\t\t\t\t),\n\t\t\t\tvisible: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'notice',\n\t\t\t\tlabel: __( 'Set a store notice', 'woocommerce-admin' ),\n\t\t\t\tdescription: __(\n\t\t\t\t\t'Optionally display a prominent notice across all pages of your store',\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t),\n\t\t\t\tcontent: (\n\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t<TextControl\n\t\t\t\t\t\t\tlabel={ __(\n\t\t\t\t\t\t\t\t'Store notice text',\n\t\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\tplaceholder={ __(\n\t\t\t\t\t\t\t\t'Store notice text',\n\t\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\tvalue={ storeNoticeText }\n\t\t\t\t\t\t\tonChange={ ( value ) =>\n\t\t\t\t\t\t\t\tthis.setState( { storeNoticeText: value } )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Button onClick={ this.updateNotice } isPrimary>\n\t\t\t\t\t\t\t{ __( 'Complete task', 'woocommerce-admin' ) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</Fragment>\n\t\t\t\t),\n\t\t\t\tvisible: true,\n\t\t\t},\n\t\t];\n\n\t\treturn filter( steps, ( step ) => step.visible );\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tisPending,\n\t\t\tstepIndex,\n\t\t\tisUpdatingLogo,\n\t\t\tisUpdatingNotice,\n\t\t} = this.state;\n\t\tconst currentStep = this.getSteps()[ stepIndex ].key;\n\n\t\treturn (\n\t\t\t<div className=\"woocommerce-task-appearance\">\n\t\t\t\t<Card className=\"is-narrow\">\n\t\t\t\t\t<Stepper\n\t\t\t\t\t\tisPending={\n\t\t\t\t\t\t\tisUpdatingNotice || isUpdatingLogo || isPending\n\t\t\t\t\t\t}\n\t\t\t\t\t\tisVertical\n\t\t\t\t\t\tcurrentStep={ currentStep }\n\t\t\t\t\t\tsteps={ this.getSteps() }\n\t\t\t\t\t/>\n\t\t\t\t</Card>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default compose(\n\twithSelect( ( select ) => {\n\t\tconst { getOption } = select( OPTIONS_STORE_NAME );\n\n\t\treturn {\n\t\t\tdemoStoreNotice: getOption( 'woocommerce_demo_store_notice' ),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { createNotice } = dispatch( 'core/notices' );\n\t\tconst { updateOptions } = dispatch( OPTIONS_STORE_NAME );\n\n\t\treturn {\n\t\t\tcreateNotice,\n\t\t\tupdateOptions,\n\t\t};\n\t} )\n)( Appearance );\n","/**\n * External dependencies\n */\nimport { __, sprintf } from '@wordpress/i18n';\nimport classnames from 'classnames';\nimport { cloneElement, Component } from '@wordpress/element';\nimport { compose } from '@wordpress/compose';\nimport { Button, FormToggle } from '@wordpress/components';\nimport { withDispatch } from '@wordpress/data';\n\n/**\n * WooCommerce dependencies\n */\nimport { Card, H, Plugins } from '@woocommerce/components';\nimport {\n\tgetHistory,\n\tgetNewPath,\n\tupdateQueryString,\n} from '@woocommerce/navigation';\nimport {\n\tONBOARDING_STORE_NAME,\n\tOPTIONS_STORE_NAME,\n\tPLUGINS_STORE_NAME,\n\tpluginNames,\n\tSETTINGS_STORE_NAME,\n} from '@woocommerce/data';\n\n/**\n * Internal dependencies\n */\nimport { recordEvent } from 'lib/tracks';\nimport { getCountryCode } from 'dashboard/utils';\nimport withSelect from 'wc-api/with-select';\nimport { getPaymentMethods } from './methods';\n\nclass Payments extends Component {\n\tconstructor( props ) {\n\t\tsuper( ...arguments );\n\t\tconst { methods } = props;\n\n\t\tconst enabledMethods = {};\n\t\tmethods.forEach(\n\t\t\t( method ) => ( enabledMethods[ method.key ] = method.isEnabled )\n\t\t);\n\t\tthis.state = {\n\t\t\tbusyMethod: null,\n\t\t\tenabledMethods,\n\t\t\trecommendedMethod: this.getRecommendedMethod(),\n\t\t};\n\n\t\tthis.completeTask = this.completeTask.bind( this );\n\t\tthis.markConfigured = this.markConfigured.bind( this );\n\t\tthis.skipTask = this.skipTask.bind( this );\n\t}\n\n\tcomponentDidUpdate() {\n\t\tconst { recommendedMethod } = this.state;\n\n\t\tconst method = this.getRecommendedMethod();\n\t\tif ( recommendedMethod !== method ) {\n\t\t\tthis.setState( {\n\t\t\t\trecommendedMethod: method,\n\t\t\t} );\n\t\t}\n\t}\n\n\tgetRecommendedMethod() {\n\t\tconst { methods } = this.props;\n\t\treturn methods.find( ( m ) => m.key === 'wcpay' && m.visible )\n\t\t\t? 'wcpay'\n\t\t\t: 'stripe';\n\t}\n\n\tasync completeTask() {\n\t\tconst { createNotice, methods, updateOptions } = this.props;\n\n\t\tconst update = await updateOptions( {\n\t\t\twoocommerce_task_list_payments: {\n\t\t\t\tcompleted: 1,\n\t\t\t\ttimestamp: Math.floor( Date.now() / 1000 ),\n\t\t\t},\n\t\t} );\n\n\t\trecordEvent( 'tasklist_payment_done', {\n\t\t\tconfigured: methods\n\t\t\t\t.filter( ( method ) => method.isConfigured )\n\t\t\t\t.map( ( method ) => method.key ),\n\t\t} );\n\n\t\tif ( update.success ) {\n\t\t\tcreateNotice(\n\t\t\t\t'success',\n\t\t\t\t__(\n\t\t\t\t\t'💰 Ka-ching! Your store can now accept payments 💳',\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tgetHistory().push( getNewPath( {}, '/', {} ) );\n\t\t} else {\n\t\t\tcreateNotice(\n\t\t\t\t'error',\n\t\t\t\t__(\n\t\t\t\t\t'There was a problem updating settings',\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t}\n\n\tskipTask() {\n\t\tconst { methods, updateOptions } = this.props;\n\n\t\tupdateOptions( {\n\t\t\twoocommerce_task_list_payments: {\n\t\t\t\tskipped: 1,\n\t\t\t\ttimestamp: Math.floor( Date.now() / 1000 ),\n\t\t\t},\n\t\t} );\n\n\t\trecordEvent( 'tasklist_payment_skip_task', {\n\t\t\toptions: methods.map( ( method ) => method.key ),\n\t\t} );\n\n\t\tgetHistory().push( getNewPath( {}, '/', {} ) );\n\t}\n\n\tmarkConfigured( method ) {\n\t\tconst { enabledMethods } = this.state;\n\n\t\tthis.setState( {\n\t\t\tenabledMethods: {\n\t\t\t\t...enabledMethods,\n\t\t\t\t[ method ]: true,\n\t\t\t},\n\t\t} );\n\n\t\tgetHistory().push( getNewPath( { task: 'payments' }, '/', {} ) );\n\n\t\trecordEvent( 'tasklist_payment_connect_method', {\n\t\t\tpayment_method: method,\n\t\t} );\n\t}\n\n\tgetCurrentMethod() {\n\t\tconst { methods, query } = this.props;\n\n\t\tif ( ! query.method ) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn methods.find( ( method ) => method.key === query.method );\n\t}\n\n\tgetInstallStep() {\n\t\tconst currentMethod = this.getCurrentMethod();\n\n\t\tif ( ! currentMethod.plugins || ! currentMethod.plugins.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { activePlugins } = this.props;\n\t\tconst pluginsToInstall = currentMethod.plugins.filter(\n\t\t\t( method ) => ! activePlugins.includes( method )\n\t\t);\n\t\tconst pluginNamesString = currentMethod.plugins\n\t\t\t.map( ( pluginSlug ) => pluginNames[ pluginSlug ] )\n\t\t\t.join( ' ' + __( 'and', 'woocommerce-admin' ) + ' ' );\n\n\t\treturn {\n\t\t\tkey: 'install',\n\t\t\tlabel: sprintf(\n\t\t\t\t__( 'Install %s', 'woocommerce-admin' ),\n\t\t\t\tpluginNamesString\n\t\t\t),\n\t\t\tcontent: (\n\t\t\t\t<Plugins\n\t\t\t\t\tonComplete={ () => {\n\t\t\t\t\t\trecordEvent( 'tasklist_payment_install_method', {\n\t\t\t\t\t\t\tplugins: currentMethod.plugins,\n\t\t\t\t\t\t} );\n\t\t\t\t\t} }\n\t\t\t\t\tautoInstall\n\t\t\t\t\tpluginSlugs={ currentMethod.plugins }\n\t\t\t\t/>\n\t\t\t),\n\t\t\tisComplete: ! pluginsToInstall.length,\n\t\t};\n\t}\n\n\ttoggleMethod( key ) {\n\t\tconst { methods, options, updateOptions } = this.props;\n\t\tconst { enabledMethods } = this.state;\n\t\tconst method = methods.find( ( option ) => option.key === key );\n\n\t\tenabledMethods[ key ] = ! enabledMethods[ key ];\n\t\tthis.setState( { enabledMethods } );\n\n\t\trecordEvent( 'tasklist_payment_toggle', {\n\t\t\tenabled: ! method.isEnabled,\n\t\t\tpayment_method: key,\n\t\t} );\n\n\t\tupdateOptions( {\n\t\t\t[ method.optionName ]: {\n\t\t\t\t...options[ method.optionName ],\n\t\t\t\tenabled: method.isEnabled ? 'no' : 'yes',\n\t\t\t},\n\t\t} );\n\t}\n\n\tasync handleClick( method ) {\n\t\tconst { methods } = this.props;\n\t\tconst { key, onClick } = method;\n\n\t\trecordEvent( 'tasklist_payment_setup', {\n\t\t\toptions: methods.map( ( option ) => option.key ),\n\t\t\tselected: key,\n\t\t} );\n\n\t\tif ( onClick ) {\n\t\t\tthis.setState( { busyMethod: key } );\n\t\t\tawait new Promise( onClick )\n\t\t\t\t.then( () => {\n\t\t\t\t\tthis.setState( { busyMethod: null } );\n\t\t\t\t} )\n\t\t\t\t.catch( () => {\n\t\t\t\t\tthis.setState( { busyMethod: null } );\n\t\t\t\t} );\n\n\t\t\treturn;\n\t\t}\n\n\t\tupdateQueryString( {\n\t\t\tmethod: key,\n\t\t} );\n\t}\n\n\trender() {\n\t\tconst currentMethod = this.getCurrentMethod();\n\t\tconst { busyMethod, enabledMethods, recommendedMethod } = this.state;\n\t\tconst { methods, query, requesting } = this.props;\n\t\tconst hasEnabledMethods = Object.keys( enabledMethods ).filter(\n\t\t\t( method ) => enabledMethods[ method ]\n\t\t).length;\n\n\t\tif ( currentMethod ) {\n\t\t\treturn (\n\t\t\t\t<Card className=\"woocommerce-task-payment-method is-narrow\">\n\t\t\t\t\t{ cloneElement( currentMethod.container, {\n\t\t\t\t\t\tquery,\n\t\t\t\t\t\tinstallStep: this.getInstallStep(),\n\t\t\t\t\t\tmarkConfigured: this.markConfigured,\n\t\t\t\t\t\thasCbdIndustry: currentMethod.hasCbdIndustry,\n\t\t\t\t\t} ) }\n\t\t\t\t</Card>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<div className=\"woocommerce-task-payments\">\n\t\t\t\t{ methods.map( ( method ) => {\n\t\t\t\t\tconst {\n\t\t\t\t\t\tbefore,\n\t\t\t\t\t\tcontainer,\n\t\t\t\t\t\tcontent,\n\t\t\t\t\t\tisConfigured,\n\t\t\t\t\t\tkey,\n\t\t\t\t\t\ttitle,\n\t\t\t\t\t\tvisible,\n\t\t\t\t\t} = method;\n\n\t\t\t\t\tif ( ! visible ) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst classes = classnames(\n\t\t\t\t\t\t'woocommerce-task-payment',\n\t\t\t\t\t\t'is-narrow',\n\t\t\t\t\t\t! isConfigured &&\n\t\t\t\t\t\t\t'woocommerce-task-payment-not-configured',\n\t\t\t\t\t\t'woocommerce-task-payment-' + key\n\t\t\t\t\t);\n\n\t\t\t\t\tconst isRecommended =\n\t\t\t\t\t\tkey === recommendedMethod && ! isConfigured;\n\t\t\t\t\tconst showRecommendedRibbon =\n\t\t\t\t\t\tisRecommended && key !== 'wcpay';\n\t\t\t\t\tconst showRecommendedPill =\n\t\t\t\t\t\tisRecommended && key === 'wcpay';\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<Card key={ key } className={ classes }>\n\t\t\t\t\t\t\t<div className=\"woocommerce-task-payment__before\">\n\t\t\t\t\t\t\t\t{ showRecommendedRibbon && (\n\t\t\t\t\t\t\t\t\t<div className=\"woocommerce-task-payment__recommended-ribbon\">\n\t\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t\t{ __(\n\t\t\t\t\t\t\t\t\t\t\t\t'Recommended',\n\t\t\t\t\t\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t{ before }\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"woocommerce-task-payment__text\">\n\t\t\t\t\t\t\t\t<H className=\"woocommerce-task-payment__title\">\n\t\t\t\t\t\t\t\t\t{ title }\n\t\t\t\t\t\t\t\t\t{ showRecommendedPill && (\n\t\t\t\t\t\t\t\t\t\t<span className=\"woocommerce-task-payment__recommended-pill\">\n\t\t\t\t\t\t\t\t\t\t\t{ __(\n\t\t\t\t\t\t\t\t\t\t\t\t'Recommended',\n\t\t\t\t\t\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t</H>\n\t\t\t\t\t\t\t\t<div className=\"woocommerce-task-payment__content\">\n\t\t\t\t\t\t\t\t\t{ content }\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"woocommerce-task-payment__after\">\n\t\t\t\t\t\t\t\t{ container && ! isConfigured ? (\n\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\tisPrimary={ key === recommendedMethod }\n\t\t\t\t\t\t\t\t\t\tisSecondary={\n\t\t\t\t\t\t\t\t\t\t\tkey !== recommendedMethod\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tisBusy={ busyMethod === key }\n\t\t\t\t\t\t\t\t\t\tdisabled={ busyMethod }\n\t\t\t\t\t\t\t\t\t\tonClick={ () =>\n\t\t\t\t\t\t\t\t\t\t\tthis.handleClick( method )\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{ __( 'Set up', 'woocommerce-admin' ) }\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<FormToggle\n\t\t\t\t\t\t\t\t\t\tchecked={ enabledMethods[ key ] }\n\t\t\t\t\t\t\t\t\t\tonChange={ () =>\n\t\t\t\t\t\t\t\t\t\t\tthis.toggleMethod( key )\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tonClick={ ( e ) => e.stopPropagation() }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Card>\n\t\t\t\t\t);\n\t\t\t\t} ) }\n\t\t\t\t<div className=\"woocommerce-task-payments__actions\">\n\t\t\t\t\t{ ! hasEnabledMethods ? (\n\t\t\t\t\t\t<Button isLink onClick={ this.skipTask }>\n\t\t\t\t\t\t\t{ __(\n\t\t\t\t\t\t\t\t'My store doesn’t take payments',\n\t\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tisPrimary\n\t\t\t\t\t\t\tisBusy={ requesting }\n\t\t\t\t\t\t\tonClick={ this.completeTask }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ __( 'Done', 'woocommerce-admin' ) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default compose(\n\twithDispatch( ( dispatch ) => {\n\t\tconst { createNotice } = dispatch( 'core/notices' );\n\t\tconst { installAndActivatePlugins } = dispatch( PLUGINS_STORE_NAME );\n\t\tconst { updateOptions } = dispatch( OPTIONS_STORE_NAME );\n\t\treturn {\n\t\t\tcreateNotice,\n\t\t\tinstallAndActivatePlugins,\n\t\t\tupdateOptions,\n\t\t};\n\t} ),\n\twithSelect( ( select, props ) => {\n\t\tconst { createNotice, installAndActivatePlugins } = props;\n\t\tconst { getProfileItems } = select( ONBOARDING_STORE_NAME );\n\t\tconst { getOption, isOptionsUpdating } = select( OPTIONS_STORE_NAME );\n\t\tconst { getActivePlugins, isJetpackConnected } = select(\n\t\t\tPLUGINS_STORE_NAME\n\t\t);\n\t\tconst { getSettings } = select( SETTINGS_STORE_NAME );\n\t\tconst { general: generalSettings = {} } = getSettings( 'general' );\n\n\t\tconst activePlugins = getActivePlugins();\n\t\tconst profileItems = getProfileItems();\n\n\t\tconst optionNames = [\n\t\t\t'woocommerce_woocommerce_payments_settings',\n\t\t\t'woocommerce_stripe_settings',\n\t\t\t'woocommerce_ppec_paypal_settings',\n\t\t\t'woocommerce_payfast_settings',\n\t\t\t'woocommerce_square_credit_card_settings',\n\t\t\t'woocommerce_klarna_payments_settings',\n\t\t\t'woocommerce_kco_settings',\n\t\t\t'wc_square_refresh_tokens',\n\t\t\t'woocommerce_cod_settings',\n\t\t\t'woocommerce_bacs_settings',\n\t\t\t'woocommerce_bacs_accounts',\n\t\t\t'woocommerce_eway_settings',\n\t\t];\n\n\t\tconst options = optionNames.reduce( ( result, name ) => {\n\t\t\tresult[ name ] = getOption( name );\n\t\t\treturn result;\n\t\t}, {} );\n\t\tconst countryCode = getCountryCode(\n\t\t\tgeneralSettings.woocommerce_default_country\n\t\t);\n\n\t\tconst methods = getPaymentMethods( {\n\t\t\tactivePlugins,\n\t\t\tcountryCode,\n\t\t\tcreateNotice,\n\t\t\tinstallAndActivatePlugins,\n\t\t\tisJetpackConnected: isJetpackConnected(),\n\t\t\toptions,\n\t\t\tprofileItems,\n\t\t} );\n\n\t\tconst requesting = isOptionsUpdating();\n\n\t\treturn {\n\t\t\tcountryCode,\n\t\t\tprofileItems,\n\t\t\tactivePlugins,\n\t\t\toptions,\n\t\t\tmethods,\n\t\t\trequesting,\n\t\t};\n\t} )\n)( Payments );\n","/**\n * External dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Component, Fragment } from '@wordpress/element';\n\n/**\n * WooCommerce dependencies\n */\nimport { Card, List } from '@woocommerce/components';\nimport { getAdminLink } from '@woocommerce/wc-admin-settings';\n\n/**\n * Internal dependencies\n */\nimport { recordEvent } from 'lib/tracks';\n\nconst subTasks = [\n\t{\n\t\ttitle: __( 'Add manually (recommended)', 'woocommerce-admin' ),\n\t\tcontent: __(\n\t\t\t'For small stores we recommend adding products manually',\n\t\t\t'woocommerce-admin'\n\t\t),\n\t\tbefore: <i className=\"material-icons-outlined\">add_box</i>,\n\t\tafter: <i className=\"material-icons-outlined\">chevron_right</i>,\n\t\tonClick: () =>\n\t\t\trecordEvent( 'tasklist_add_product', { method: 'manually' } ),\n\t\thref: getAdminLink(\n\t\t\t'post-new.php?post_type=product&wc_onboarding_active_task=products&tutorial=true'\n\t\t),\n\t},\n\t{\n\t\ttitle: __( 'Import', 'woocommerce-admin' ),\n\t\tcontent: __(\n\t\t\t'For larger stores we recommend importing all products at once via CSV file',\n\t\t\t'woocommerce-admin'\n\t\t),\n\t\tbefore: <i className=\"material-icons-outlined\">import_export</i>,\n\t\tafter: <i className=\"material-icons-outlined\">chevron_right</i>,\n\t\tonClick: () =>\n\t\t\trecordEvent( 'tasklist_add_product', { method: 'import' } ),\n\t\thref: getAdminLink(\n\t\t\t'edit.php?post_type=product&page=product_importer&wc_onboarding_active_task=product-import'\n\t\t),\n\t},\n\t{\n\t\ttitle: __( 'Migrate', 'woocommerce-admin' ),\n\t\tcontent: __(\n\t\t\t'For stores currently selling elsewhere we suggest using a product migration service',\n\t\t\t'woocommerce-admin'\n\t\t),\n\t\tbefore: <i className=\"material-icons-outlined\">cloud_download</i>,\n\t\tafter: <i className=\"material-icons-outlined\">chevron_right</i>,\n\t\tonClick: () =>\n\t\t\trecordEvent( 'tasklist_add_product', { method: 'migrate' } ),\n\t\t// @todo This should be replaced with the in-app purchase iframe when ready.\n\t\thref: 'https://woocommerce.com/products/cart2cart/',\n\t\ttarget: '_blank',\n\t},\n];\n\nexport default class Products extends Component {\n\trender() {\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t<Card className=\"woocommerce-task-card\">\n\t\t\t\t\t<List items={ subTasks } />\n\t\t\t\t</Card>\n\t\t\t</Fragment>\n\t\t);\n\t}\n}\n","/**\n * External dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport apiFetch from '@wordpress/api-fetch';\nimport { Component } from '@wordpress/element';\nimport { compose } from '@wordpress/compose';\nimport { difference, filter } from 'lodash';\nimport interpolateComponents from 'interpolate-components';\nimport { withDispatch, withSelect } from '@wordpress/data';\n\n/**\n * WooCommerce dependencies\n */\nimport { Card, Link, Stepper, Plugins } from '@woocommerce/components';\nimport { getAdminLink, getSetting } from '@woocommerce/wc-admin-settings';\nimport { getHistory, getNewPath } from '@woocommerce/navigation';\nimport { SETTINGS_STORE_NAME, PLUGINS_STORE_NAME } from '@woocommerce/data';\n\n/**\n * Internal dependencies\n */\nimport Connect from 'dashboard/components/connect';\nimport { getCountryCode } from 'dashboard/utils';\nimport StoreLocation from '../steps/location';\nimport ShippingRates from './rates';\nimport { recordEvent } from 'lib/tracks';\n\nclass Shipping extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\n\t\tthis.initialState = {\n\t\t\tisPending: false,\n\t\t\tstep: 'store_location',\n\t\t\tshippingZones: [],\n\t\t};\n\n\t\t// Cache active plugins to prevent removal mid-step.\n\t\tthis.activePlugins = props.activePlugins;\n\t\tthis.state = this.initialState;\n\t\tthis.completeStep = this.completeStep.bind( this );\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.reset();\n\t}\n\n\treset() {\n\t\tthis.setState( this.initialState );\n\t}\n\n\tasync fetchShippingZones() {\n\t\tthis.setState( { isPending: true } );\n\t\tconst { countryCode, countryName } = this.props;\n\n\t\t// @todo The following fetches for shipping information should be moved into\n\t\t// the wc-api to make these methods and states more readily available.\n\t\tconst shippingZones = [];\n\t\tconst zones = await apiFetch( { path: '/wc/v3/shipping/zones' } );\n\t\tlet hasCountryZone = false;\n\n\t\tawait Promise.all(\n\t\t\tzones.map( async ( zone ) => {\n\t\t\t\t// \"Rest of the world zone\"\n\t\t\t\tif ( zone.id === 0 ) {\n\t\t\t\t\tzone.methods = await apiFetch( {\n\t\t\t\t\t\tpath: `/wc/v3/shipping/zones/${ zone.id }/methods`,\n\t\t\t\t\t} );\n\t\t\t\t\tzone.name = __( 'Rest of the world', 'woocommerce-admin' );\n\t\t\t\t\tzone.toggleable = true;\n\t\t\t\t\tshippingZones.push( zone );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Return any zone with a single location matching the country zone.\n\t\t\t\tzone.locations = await apiFetch( {\n\t\t\t\t\tpath: `/wc/v3/shipping/zones/${ zone.id }/locations`,\n\t\t\t\t} );\n\t\t\t\tconst countryLocation = zone.locations.find(\n\t\t\t\t\t( location ) => countryCode === location.code\n\t\t\t\t);\n\t\t\t\tif ( countryLocation ) {\n\t\t\t\t\tzone.methods = await apiFetch( {\n\t\t\t\t\t\tpath: `/wc/v3/shipping/zones/${ zone.id }/methods`,\n\t\t\t\t\t} );\n\t\t\t\t\tshippingZones.push( zone );\n\t\t\t\t\thasCountryZone = true;\n\t\t\t\t}\n\t\t\t} )\n\t\t);\n\n\t\t// Create the default store country zone if it doesn't exist.\n\t\tif ( ! hasCountryZone ) {\n\t\t\tconst zone = await apiFetch( {\n\t\t\t\tmethod: 'POST',\n\t\t\t\tpath: '/wc/v3/shipping/zones',\n\t\t\t\tdata: { name: countryName },\n\t\t\t} );\n\t\t\tzone.locations = await apiFetch( {\n\t\t\t\tmethod: 'POST',\n\t\t\t\tpath: `/wc/v3/shipping/zones/${ zone.id }/locations`,\n\t\t\t\tdata: [ { code: countryCode, type: 'country' } ],\n\t\t\t} );\n\t\t\tshippingZones.push( zone );\n\t\t}\n\n\t\tshippingZones.reverse();\n\n\t\tthis.setState( { isPending: false, shippingZones } );\n\t}\n\n\tcomponentDidUpdate( prevProps, prevState ) {\n\t\tconst { countryCode, settings } = this.props;\n\t\tconst {\n\t\t\twoocommerce_store_address: storeAddress,\n\t\t\twoocommerce_default_country: defaultCountry,\n\t\t\twoocommerce_store_postcode: storePostCode,\n\t\t} = settings;\n\t\tconst { step } = this.state;\n\n\t\tif (\n\t\t\tstep === 'rates' &&\n\t\t\t( prevProps.countryCode !== countryCode ||\n\t\t\t\tprevState.step !== 'rates' )\n\t\t) {\n\t\t\tthis.fetchShippingZones();\n\t\t}\n\n\t\tconst isCompleteAddress = Boolean(\n\t\t\tstoreAddress && defaultCountry && storePostCode\n\t\t);\n\n\t\tif ( step === 'store_location' && isCompleteAddress ) {\n\t\t\tthis.completeStep();\n\t\t}\n\t}\n\n\tcompleteStep() {\n\t\tconst { createNotice } = this.props;\n\t\tconst { step } = this.state;\n\t\tconst steps = this.getSteps();\n\t\tconst currentStepIndex = steps.findIndex( ( s ) => s.key === step );\n\t\tconst nextStep = steps[ currentStepIndex + 1 ];\n\n\t\tif ( nextStep ) {\n\t\t\tthis.setState( { step: nextStep.key } );\n\t\t} else {\n\t\t\tcreateNotice(\n\t\t\t\t'success',\n\t\t\t\t__(\n\t\t\t\t\t\"📦 Shipping is done! Don't worry, you can always change it later.\",\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t)\n\t\t\t);\n\t\t\tgetHistory().push( getNewPath( {}, '/', {} ) );\n\t\t}\n\t}\n\n\tgetPluginsToActivate() {\n\t\tconst { countryCode } = this.props;\n\n\t\tconst plugins = [];\n\t\tif ( [ 'GB', 'CA', 'AU' ].includes( countryCode ) ) {\n\t\t\tplugins.push( 'woocommerce-shipstation-integration' );\n\t\t} else if ( countryCode === 'US' ) {\n\t\t\tplugins.push( 'woocommerce-services' );\n\t\t\tplugins.push( 'jetpack' );\n\t\t}\n\t\treturn difference( plugins, this.activePlugins );\n\t}\n\n\tgetSteps() {\n\t\tconst { countryCode, isJetpackConnected } = this.props;\n\t\tconst pluginsToActivate = this.getPluginsToActivate();\n\t\tconst requiresJetpackConnection =\n\t\t\t! isJetpackConnected && countryCode === 'US';\n\n\t\tconst steps = [\n\t\t\t{\n\t\t\t\tkey: 'store_location',\n\t\t\t\tlabel: __( 'Set store location', 'woocommerce-admin' ),\n\t\t\t\tdescription: __(\n\t\t\t\t\t'The address from which your business operates',\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t),\n\t\t\t\tcontent: (\n\t\t\t\t\t<StoreLocation\n\t\t\t\t\t\t{ ...this.props }\n\t\t\t\t\t\tonComplete={ ( values ) => {\n\t\t\t\t\t\t\tconst country = getCountryCode(\n\t\t\t\t\t\t\t\tvalues.countryState\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\trecordEvent( 'tasklist_shipping_set_location', {\n\t\t\t\t\t\t\t\tcountry,\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\tthis.completeStep();\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t),\n\t\t\t\tvisible: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'rates',\n\t\t\t\tlabel: __( 'Set shipping costs', 'woocommerce-admin' ),\n\t\t\t\tdescription: __(\n\t\t\t\t\t'Define how much customers pay to ship to different destinations',\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t),\n\t\t\t\tcontent: (\n\t\t\t\t\t<ShippingRates\n\t\t\t\t\t\tbuttonText={\n\t\t\t\t\t\t\tpluginsToActivate.length ||\n\t\t\t\t\t\t\trequiresJetpackConnection\n\t\t\t\t\t\t\t\t? __( 'Proceed', 'woocommerce-admin' )\n\t\t\t\t\t\t\t\t: __( 'Complete task', 'woocommerce-admin' )\n\t\t\t\t\t\t}\n\t\t\t\t\t\tshippingZones={ this.state.shippingZones }\n\t\t\t\t\t\tonComplete={ this.completeStep }\n\t\t\t\t\t\t{ ...this.props }\n\t\t\t\t\t/>\n\t\t\t\t),\n\t\t\t\tvisible: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'label_printing',\n\t\t\t\tlabel: __(\n\t\t\t\t\t'Enable shipping label printing',\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t),\n\t\t\t\tdescription: pluginsToActivate.includes(\n\t\t\t\t\t'woocommerce-shipstation-integration'\n\t\t\t\t)\n\t\t\t\t\t? interpolateComponents( {\n\t\t\t\t\t\t\tmixedString: __(\n\t\t\t\t\t\t\t\t'We recommend using ShipStation to save time at the post office by printing your shipping ' +\n\t\t\t\t\t\t\t\t\t'labels at home. Try ShipStation free for 30 days. {{link}}Learn more{{/link}}.',\n\t\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tcomponents: {\n\t\t\t\t\t\t\t\tlink: (\n\t\t\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\t\t\thref=\"https://woocommerce.com/products/shipstation-integration\"\n\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t\t\t\ttype=\"external\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t  } )\n\t\t\t\t\t: __(\n\t\t\t\t\t\t\t'With WooCommerce Services and Jetpack you can save time at the ' +\n\t\t\t\t\t\t\t\t'Post Office by printing your shipping labels at home',\n\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t  ),\n\t\t\t\tcontent: (\n\t\t\t\t\t<Plugins\n\t\t\t\t\t\tonComplete={ () => {\n\t\t\t\t\t\t\trecordEvent( 'tasklist_shipping_label_printing', {\n\t\t\t\t\t\t\t\tinstall: true,\n\t\t\t\t\t\t\t\tpluginsToActivate,\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\tthis.completeStep();\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonSkip={ () => {\n\t\t\t\t\t\t\trecordEvent( 'tasklist_shipping_label_printing', {\n\t\t\t\t\t\t\t\tinstall: false,\n\t\t\t\t\t\t\t\tpluginsToActivate,\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\tgetHistory().push( getNewPath( {}, '/', {} ) );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tpluginSlugs={ pluginsToActivate }\n\t\t\t\t\t\t{ ...this.props }\n\t\t\t\t\t/>\n\t\t\t\t),\n\t\t\t\tvisible: pluginsToActivate.length,\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'connect',\n\t\t\t\tlabel: __( 'Connect your store', 'woocommerce-admin' ),\n\t\t\t\tdescription: __(\n\t\t\t\t\t'Connect your store to WordPress.com to enable label printing',\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t),\n\t\t\t\tcontent: (\n\t\t\t\t\t<Connect\n\t\t\t\t\t\tredirectUrl={ getAdminLink(\n\t\t\t\t\t\t\t'admin.php?page=wc-admin'\n\t\t\t\t\t\t) }\n\t\t\t\t\t\tcompleteStep={ this.completeStep }\n\t\t\t\t\t\t{ ...this.props }\n\t\t\t\t\t\tonConnect={ () => {\n\t\t\t\t\t\t\trecordEvent( 'tasklist_shipping_connect_store' );\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t),\n\t\t\t\tvisible: requiresJetpackConnection,\n\t\t\t},\n\t\t];\n\n\t\treturn filter( steps, ( step ) => step.visible );\n\t}\n\n\trender() {\n\t\tconst { isPending, step } = this.state;\n\t\tconst { isUpdateSettingsRequesting } = this.props;\n\n\t\treturn (\n\t\t\t<div className=\"woocommerce-task-shipping\">\n\t\t\t\t<Card className=\"is-narrow\">\n\t\t\t\t\t<Stepper\n\t\t\t\t\t\tisPending={ isPending || isUpdateSettingsRequesting }\n\t\t\t\t\t\tisVertical\n\t\t\t\t\t\tcurrentStep={ step }\n\t\t\t\t\t\tsteps={ this.getSteps() }\n\t\t\t\t\t/>\n\t\t\t\t</Card>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default compose(\n\twithSelect( ( select ) => {\n\t\tconst { getSettings, isUpdateSettingsRequesting } = select(\n\t\t\tSETTINGS_STORE_NAME\n\t\t);\n\t\tconst { getActivePlugins, isJetpackConnected } = select(\n\t\t\tPLUGINS_STORE_NAME\n\t\t);\n\n\t\tconst { general: settings = {} } = getSettings( 'general' );\n\t\tconst countryCode = getCountryCode(\n\t\t\tsettings.woocommerce_default_country\n\t\t);\n\n\t\tconst { countries = [] } = getSetting( 'dataEndpoints', {} );\n\t\tconst country = countryCode\n\t\t\t? countries.find( ( c ) => c.code === countryCode )\n\t\t\t: null;\n\t\tconst countryName = country ? country.name : null;\n\t\tconst activePlugins = getActivePlugins();\n\n\t\treturn {\n\t\t\tcountryCode,\n\t\t\tcountryName,\n\t\t\tisUpdateSettingsRequesting: isUpdateSettingsRequesting( 'general' ),\n\t\t\tsettings,\n\t\t\tactivePlugins,\n\t\t\tisJetpackConnected: isJetpackConnected(),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { createNotice } = dispatch( 'core/notices' );\n\t\tconst { updateAndPersistSettingsForGroup } = dispatch(\n\t\t\tSETTINGS_STORE_NAME\n\t\t);\n\n\t\treturn {\n\t\t\tcreateNotice,\n\t\t\tupdateAndPersistSettingsForGroup,\n\t\t};\n\t} )\n)( Shipping );\n","/**\n * External dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport apiFetch from '@wordpress/api-fetch';\nimport { Component, Fragment } from '@wordpress/element';\nimport { Button, FormToggle } from '@wordpress/components';\nimport PropTypes from 'prop-types';\n\n/**\n * WooCommerce dependencies\n */\nimport { Flag, Form, TextControlWithAffixes } from '@woocommerce/components';\nimport { getSetting, setSetting } from '@woocommerce/wc-admin-settings';\n\n/**\n * Internal dependencies\n */\nimport { recordEvent } from 'lib/tracks';\nimport { CurrencyContext } from 'lib/currency-context';\n\nclass ShippingRates extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.updateShippingZones = this.updateShippingZones.bind( this );\n\t}\n\n\tgetShippingMethods( zone, type = null ) {\n\t\t// Sometimes the wc/v3/shipping/zones response does not include a methods attribute, return early if so.\n\t\tif ( ! zone || ! zone.methods || ! Array.isArray( zone.methods ) ) {\n\t\t\treturn [];\n\t\t}\n\n\t\tif ( ! type ) {\n\t\t\treturn zone.methods;\n\t\t}\n\n\t\treturn zone.methods\n\t\t\t? zone.methods.filter( ( method ) => method.method_id === type )\n\t\t\t: [];\n\t}\n\n\tdisableShippingMethods( zone, methods ) {\n\t\tif ( ! methods.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tmethods.forEach( ( method ) => {\n\t\t\tapiFetch( {\n\t\t\t\tmethod: 'POST',\n\t\t\t\tpath: `/wc/v3/shipping/zones/${ zone.id }/methods/${ method.instance_id }`,\n\t\t\t\tdata: {\n\t\t\t\t\tenabled: false,\n\t\t\t\t},\n\t\t\t} );\n\t\t} );\n\t}\n\n\tasync updateShippingZones( values ) {\n\t\tconst { createNotice, shippingZones } = this.props;\n\n\t\tlet restOfTheWorld = false;\n\t\tlet shippingCost = false;\n\t\tshippingZones.forEach( ( zone ) => {\n\t\t\tif ( zone.id === 0 ) {\n\t\t\t\trestOfTheWorld =\n\t\t\t\t\tzone.toggleable && values[ `${ zone.id }_enabled` ];\n\t\t\t} else {\n\t\t\t\tshippingCost =\n\t\t\t\t\tvalues[ `${ zone.id }_rate` ] !== '' &&\n\t\t\t\t\tparseFloat( values[ `${ zone.id }_rate` ] ) !==\n\t\t\t\t\t\tparseFloat( 0 );\n\t\t\t}\n\n\t\t\tconst shippingMethods = this.getShippingMethods( zone );\n\t\t\tconst methodType =\n\t\t\t\tparseFloat( values[ `${ zone.id }_rate` ] ) === parseFloat( 0 )\n\t\t\t\t\t? 'free_shipping'\n\t\t\t\t\t: 'flat_rate';\n\t\t\tconst shippingMethod = this.getShippingMethods( zone, methodType )\n\t\t\t\t.length\n\t\t\t\t? this.getShippingMethods( zone, methodType )[ 0 ]\n\t\t\t\t: null;\n\n\t\t\tif ( zone.toggleable && ! values[ `${ zone.id }_enabled` ] ) {\n\t\t\t\t// Disable any shipping methods that exist if toggled off.\n\t\t\t\tthis.disableShippingMethods( zone, shippingMethods );\n\t\t\t\treturn;\n\t\t\t} else if ( shippingMethod ) {\n\t\t\t\t// Disable all methods except the one being updated.\n\t\t\t\tconst methodsToDisable = shippingMethods.filter(\n\t\t\t\t\t( method ) =>\n\t\t\t\t\t\tmethod.instance_id !== shippingMethod.instance_id\n\t\t\t\t);\n\t\t\t\tthis.disableShippingMethods( zone, methodsToDisable );\n\t\t\t}\n\n\t\t\tapiFetch( {\n\t\t\t\tmethod: 'POST',\n\t\t\t\tpath: shippingMethod\n\t\t\t\t\t? // Update the first existing method if one exists, otherwise create a new one.\n\t\t\t\t\t  `/wc/v3/shipping/zones/${ zone.id }/methods/${ shippingMethod.instance_id }`\n\t\t\t\t\t: `/wc/v3/shipping/zones/${ zone.id }/methods`,\n\t\t\t\tdata: {\n\t\t\t\t\tmethod_id: methodType,\n\t\t\t\t\tenabled: true,\n\t\t\t\t\tsettings: { cost: values[ `${ zone.id }_rate` ] },\n\t\t\t\t},\n\t\t\t} );\n\t\t} );\n\n\t\trecordEvent( 'tasklist_shipping_set_costs', {\n\t\t\tshipping_cost: shippingCost,\n\t\t\trest_world: restOfTheWorld,\n\t\t} );\n\n\t\t// @todo This is a workaround to force the task to mark as complete.\n\t\t// This should probably be updated to use wc-api so we can fetch shipping methods.\n\t\tsetSetting( 'onboarding', {\n\t\t\t...getSetting( 'onboarding', {} ),\n\t\t\tshippingZonesCount: 1,\n\t\t} );\n\n\t\tcreateNotice(\n\t\t\t'success',\n\t\t\t__( 'Your shipping rates have been updated.', 'woocommerce-admin' )\n\t\t);\n\n\t\tthis.props.onComplete();\n\t}\n\n\trenderInputPrefix() {\n\t\tconst { symbolPosition, symbol } = this.context.getCurrencyConfig();\n\t\tif ( symbolPosition.indexOf( 'right' ) === 0 ) {\n\t\t\treturn null;\n\t\t}\n\t\treturn (\n\t\t\t<span className=\"woocommerce-shipping-rate__control-prefix\">\n\t\t\t\t{ symbol }\n\t\t\t</span>\n\t\t);\n\t}\n\n\trenderInputSuffix( rate ) {\n\t\tconst { symbolPosition, symbol } = this.context.getCurrencyConfig();\n\t\tif ( symbolPosition.indexOf( 'right' ) === 0 ) {\n\t\t\treturn (\n\t\t\t\t<span className=\"woocommerce-shipping-rate__control-suffix\">\n\t\t\t\t\t{ symbol }\n\t\t\t\t</span>\n\t\t\t);\n\t\t}\n\n\t\treturn parseFloat( rate ) === parseFloat( 0 ) ? (\n\t\t\t<span className=\"woocommerce-shipping-rate__control-suffix\">\n\t\t\t\t{ __( 'Free shipping', 'woocommerce-admin' ) }\n\t\t\t</span>\n\t\t) : null;\n\t}\n\n\tgetFormattedRate( value ) {\n\t\tconst { formatDecimalString } = this.context;\n\t\tconst currencyString = formatDecimalString( value );\n\t\tif ( ! value.length || ! currencyString.length ) {\n\t\t\treturn formatDecimalString( 0 );\n\t\t}\n\n\t\treturn formatDecimalString( value );\n\t}\n\n\tgetInitialValues() {\n\t\tconst { formatDecimalString } = this.context;\n\t\tconst values = {};\n\n\t\tthis.props.shippingZones.forEach( ( zone ) => {\n\t\t\tconst shippingMethods = this.getShippingMethods( zone );\n\t\t\tconst rate =\n\t\t\t\tshippingMethods.length && shippingMethods[ 0 ].settings.cost\n\t\t\t\t\t? this.getFormattedRate(\n\t\t\t\t\t\t\tshippingMethods[ 0 ].settings.cost.value\n\t\t\t\t\t  )\n\t\t\t\t\t: formatDecimalString( 0 );\n\t\t\tvalues[ `${ zone.id }_rate` ] = rate;\n\n\t\t\tif ( shippingMethods.length && shippingMethods[ 0 ].enabled ) {\n\t\t\t\tvalues[ `${ zone.id }_enabled` ] = true;\n\t\t\t} else {\n\t\t\t\tvalues[ `${ zone.id }_enabled` ] = false;\n\t\t\t}\n\t\t} );\n\n\t\treturn values;\n\t}\n\n\tvalidate( values ) {\n\t\tconst errors = {};\n\n\t\tconst rates = Object.keys( values ).filter( ( field ) =>\n\t\t\tfield.endsWith( '_rate' )\n\t\t);\n\n\t\trates.forEach( ( rate ) => {\n\t\t\tif ( values[ rate ] < 0 ) {\n\t\t\t\terrors[ rate ] = __(\n\t\t\t\t\t'Shipping rates can not be negative numbers.',\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t);\n\t\t\t}\n\t\t} );\n\n\t\treturn errors;\n\t}\n\n\trender() {\n\t\tconst { buttonText, shippingZones } = this.props;\n\n\t\tif ( ! shippingZones.length ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (\n\t\t\t<Form\n\t\t\t\tinitialValues={ this.getInitialValues() }\n\t\t\t\tonSubmitCallback={ this.updateShippingZones }\n\t\t\t\tvalidate={ this.validate }\n\t\t\t>\n\t\t\t\t{ ( {\n\t\t\t\t\tgetInputProps,\n\t\t\t\t\thandleSubmit,\n\t\t\t\t\tsetTouched,\n\t\t\t\t\tsetValue,\n\t\t\t\t\tvalues,\n\t\t\t\t} ) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t\t<div className=\"woocommerce-shipping-rates\">\n\t\t\t\t\t\t\t\t{ shippingZones.map( ( zone ) => (\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclassName=\"woocommerce-shipping-rate\"\n\t\t\t\t\t\t\t\t\t\tkey={ zone.id }\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<div className=\"woocommerce-shipping-rate__icon\">\n\t\t\t\t\t\t\t\t\t\t\t{ zone.locations ? (\n\t\t\t\t\t\t\t\t\t\t\t\tzone.locations.map(\n\t\t\t\t\t\t\t\t\t\t\t\t\t( location ) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Flag\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize={ 24 }\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcode={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlocation.code\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlocation.code\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t// Icon used for zones without locations or \"Rest of the world\".\n\t\t\t\t\t\t\t\t\t\t\t\t<i className=\"material-icons-outlined\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tpublic\n\t\t\t\t\t\t\t\t\t\t\t\t</i>\n\t\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div className=\"woocommerce-shipping-rate__main\">\n\t\t\t\t\t\t\t\t\t\t\t{ zone.toggleable ? (\n\t\t\t\t\t\t\t\t\t\t\t\t<label\n\t\t\t\t\t\t\t\t\t\t\t\t\thtmlFor={ `woocommerce-shipping-rate__toggle-${ zone.id }` }\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"woocommerce-shipping-rate__name\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{ zone.name }\n\t\t\t\t\t\t\t\t\t\t\t\t\t<FormToggle\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid={ `woocommerce-shipping-rate__toggle-${ zone.id }` }\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{ ...getInputProps(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`${ zone.id }_enabled`\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"woocommerce-shipping-rate__name\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{ zone.name }\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\t\t{ ( ! zone.toggleable ||\n\t\t\t\t\t\t\t\t\t\t\t\tvalues[\n\t\t\t\t\t\t\t\t\t\t\t\t\t`${ zone.id }_enabled`\n\t\t\t\t\t\t\t\t\t\t\t\t] ) && (\n\t\t\t\t\t\t\t\t\t\t\t\t<TextControlWithAffixes\n\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={ __(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Shipping cost',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t\t\t\t\t\t{ ...getInputProps(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`${ zone.id }_rate`\n\t\t\t\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\t\t\t\tonBlur={ () => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetTouched(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`${ zone.id }_rate`\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetValue(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`${ zone.id }_rate`,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.getFormattedRate(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalues[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`${ zone.id }_rate`\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t\t\t\t\t\tprefix={ this.renderInputPrefix() }\n\t\t\t\t\t\t\t\t\t\t\t\t\tsuffix={ this.renderInputSuffix(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalues[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`${ zone.id }_rate`\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"muriel-input-text woocommerce-shipping-rate__control-wrapper\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t) ) }\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<Button isPrimary onClick={ handleSubmit }>\n\t\t\t\t\t\t\t\t{ buttonText ||\n\t\t\t\t\t\t\t\t\t__( 'Update', 'woocommerce-admin' ) }\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t);\n\t\t\t\t} }\n\t\t\t</Form>\n\t\t);\n\t}\n}\n\nShippingRates.propTypes = {\n\t/**\n\t * Text displayed on the primary button.\n\t */\n\tbuttonText: PropTypes.string,\n\t/**\n\t * Function used to mark the step complete.\n\t */\n\tonComplete: PropTypes.func.isRequired,\n\t/**\n\t * Function to create a transient notice in the store.\n\t */\n\tcreateNotice: PropTypes.func.isRequired,\n\t/**\n\t * Array of shipping zones returned from the WC REST API with added\n\t * `methods` and `locations` properties appended from separate API calls.\n\t */\n\tshippingZones: PropTypes.array,\n};\n\nShippingRates.defaultProps = {\n\tshippingZones: [],\n};\n\nShippingRates.contextType = CurrencyContext;\n\nexport default ShippingRates;\n","/**\n * External dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Button } from '@wordpress/components';\nimport { Component, Fragment } from '@wordpress/element';\n\n/**\n * WooCommerce dependencies\n */\nimport { Form } from '@woocommerce/components';\n\n/**\n * Internal dependencies\n */\nimport {\n\tStoreAddress,\n\tvalidateStoreAddress,\n} from 'dashboard/components/settings/general/store-address';\n\nexport default class StoreLocation extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.onSubmit = this.onSubmit.bind( this );\n\t}\n\n\tasync onSubmit( values ) {\n\t\tconst {\n\t\t\tonComplete,\n\t\t\tcreateNotice,\n\t\t\tisSettingsError,\n\t\t\tupdateAndPersistSettingsForGroup,\n\t\t\tsettings,\n\t\t} = this.props;\n\n\t\tawait updateAndPersistSettingsForGroup( 'general', {\n\t\t\tgeneral: {\n\t\t\t\t...settings,\n\t\t\t\twoocommerce_store_address: values.addressLine1,\n\t\t\t\twoocommerce_store_address_2: values.addressLine2,\n\t\t\t\twoocommerce_default_country: values.countryState,\n\t\t\t\twoocommerce_store_city: values.city,\n\t\t\t\twoocommerce_store_postcode: values.postCode,\n\t\t\t},\n\t\t} );\n\n\t\tif ( ! isSettingsError ) {\n\t\t\tonComplete( values );\n\t\t} else {\n\t\t\tcreateNotice(\n\t\t\t\t'error',\n\t\t\t\t__(\n\t\t\t\t\t'There was a problem saving your store location.',\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t}\n\n\tgetInitialValues() {\n\t\tconst { settings } = this.props;\n\n\t\tconst {\n\t\t\twoocommerce_store_address: storeAddress,\n\t\t\twoocommerce_store_address_2: storeAddress2,\n\t\t\twoocommerce_store_city: storeCity,\n\t\t\twoocommerce_default_country: defaultCountry,\n\t\t\twoocommerce_store_postcode: storePostcode,\n\t\t} = settings;\n\n\t\treturn {\n\t\t\taddressLine1: storeAddress || '',\n\t\t\taddressLine2: storeAddress2 || '',\n\t\t\tcity: storeCity || '',\n\t\t\tcountryState: defaultCountry || '',\n\t\t\tpostCode: storePostcode || '',\n\t\t};\n\t}\n\n\trender() {\n\t\tconst { isSettingsRequesting } = this.props;\n\n\t\tif ( isSettingsRequesting ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (\n\t\t\t<Form\n\t\t\t\tinitialValues={ this.getInitialValues() }\n\t\t\t\tonSubmitCallback={ this.onSubmit }\n\t\t\t\tvalidate={ validateStoreAddress }\n\t\t\t>\n\t\t\t\t{ ( { getInputProps, handleSubmit, setValue } ) => (\n\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t<StoreAddress\n\t\t\t\t\t\t\tgetInputProps={ getInputProps }\n\t\t\t\t\t\t\tsetValue={ setValue }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Button isPrimary onClick={ handleSubmit }>\n\t\t\t\t\t\t\t{ __( 'Continue', 'woocommerce-admin' ) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</Fragment>\n\t\t\t\t) }\n\t\t\t</Form>\n\t\t);\n\t}\n}\n","/**\n * External dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Button, __experimentalText as Text } from '@wordpress/components';\nimport { Component, Fragment } from '@wordpress/element';\nimport { compose } from '@wordpress/compose';\nimport { difference, filter } from 'lodash';\nimport interpolateComponents from 'interpolate-components';\nimport { withDispatch, withSelect } from '@wordpress/data';\n\n/**\n * WooCommerce dependencies\n */\nimport { Card, H, Link, Stepper, Plugins } from '@woocommerce/components';\nimport { getHistory, getNewPath } from '@woocommerce/navigation';\nimport {\n\tgetAdminLink,\n\tgetSetting,\n\tsetSetting,\n} from '@woocommerce/wc-admin-settings';\nimport {\n\tSETTINGS_STORE_NAME,\n\tPLUGINS_STORE_NAME,\n\tOPTIONS_STORE_NAME,\n} from '@woocommerce/data';\n\n/**\n * Internal dependencies\n */\nimport Connect from 'dashboard/components/connect';\nimport { createNoticesFromResponse } from 'lib/notices';\nimport { getCountryCode } from 'dashboard/utils';\nimport StoreLocation from './steps/location';\nimport { recordEvent, queueRecordEvent } from 'lib/tracks';\n\nclass Tax extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\t\tconst { hasCompleteAddress, pluginsToActivate } = props;\n\n\t\tthis.initialState = {\n\t\t\tisPending: false,\n\t\t\tstepIndex: hasCompleteAddress ? 1 : 0,\n\t\t\t// Cache the value of pluginsToActivate so that we can\n\t\t\t// show/hide tasks based on it, but not have them update mid task.\n\t\t\tcachedPluginsToActivate: pluginsToActivate,\n\t\t};\n\t\tthis.state = this.initialState;\n\n\t\tthis.completeStep = this.completeStep.bind( this );\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.reset();\n\t}\n\n\treset() {\n\t\tthis.setState( this.initialState );\n\t}\n\n\tshouldShowSuccessScreen() {\n\t\tconst {\n\t\t\tisJetpackConnected,\n\t\t\thasCompleteAddress,\n\t\t\tpluginsToActivate,\n\t\t} = this.props;\n\n\t\treturn (\n\t\t\thasCompleteAddress &&\n\t\t\t! pluginsToActivate.length &&\n\t\t\tisJetpackConnected &&\n\t\t\tthis.isTaxJarSupported()\n\t\t);\n\t}\n\n\tisTaxJarSupported() {\n\t\tconst { countryCode } = this.props;\n\t\tconst {\n\t\t\tautomatedTaxSupportedCountries = [],\n\t\t\ttaxJarActivated,\n\t\t} = getSetting( 'onboarding', {} );\n\n\t\treturn (\n\t\t\t! taxJarActivated && // WCS integration doesn't work with the official TaxJar plugin.\n\t\t\tautomatedTaxSupportedCountries.includes( countryCode )\n\t\t);\n\t}\n\n\tcompleteStep() {\n\t\tconst { stepIndex } = this.state;\n\t\tconst steps = this.getSteps();\n\t\tconst nextStep = steps[ stepIndex + 1 ];\n\n\t\tif ( nextStep ) {\n\t\t\tthis.setState( { stepIndex: stepIndex + 1 } );\n\t\t}\n\t}\n\n\tasync manuallyConfigureTaxRates() {\n\t\tconst {\n\t\t\tgeneralSettings,\n\t\t\tupdateAndPersistSettingsForGroup,\n\t\t} = this.props;\n\n\t\tif ( generalSettings.woocommerce_calc_taxes !== 'yes' ) {\n\t\t\tthis.setState( { isPending: true } );\n\t\t\tupdateAndPersistSettingsForGroup( 'general', {\n\t\t\t\tgeneral: {\n\t\t\t\t\t...generalSettings,\n\t\t\t\t\twoocommerce_calc_taxes: 'yes',\n\t\t\t\t},\n\t\t\t} )\n\t\t\t\t.then( () => this.redirectToTaxSettings() )\n\t\t\t\t.catch( ( error ) => createNoticesFromResponse( error ) );\n\t\t} else {\n\t\t\tthis.redirectToTaxSettings();\n\t\t}\n\t}\n\n\tupdateAutomatedTax( isEnabling ) {\n\t\tconst {\n\t\t\tcreateNotice,\n\t\t\tupdateAndPersistSettingsForGroup,\n\t\t\tgeneralSettings,\n\t\t\ttaxSettings,\n\t\t} = this.props;\n\n\t\tPromise.all( [\n\t\t\tupdateAndPersistSettingsForGroup( 'tax', {\n\t\t\t\ttax: {\n\t\t\t\t\t...taxSettings,\n\t\t\t\t\twc_connect_taxes_enabled: isEnabling ? 'yes' : 'no',\n\t\t\t\t},\n\t\t\t} ),\n\t\t\tupdateAndPersistSettingsForGroup( 'general', {\n\t\t\t\tgeneral: {\n\t\t\t\t\t...generalSettings,\n\t\t\t\t\twoocommerce_calc_taxes: 'yes',\n\t\t\t\t},\n\t\t\t} ),\n\t\t] )\n\t\t\t.then( () => {\n\t\t\t\t// @todo This is a workaround to force the task to mark as complete.\n\t\t\t\t// This should probably be updated to use wc-api so we can fetch tax rates.\n\t\t\t\tsetSetting( 'onboarding', {\n\t\t\t\t\t...getSetting( 'onboarding', {} ),\n\t\t\t\t\tisTaxComplete: true,\n\t\t\t\t} );\n\t\t\t\tif ( isEnabling ) {\n\t\t\t\t\tcreateNotice(\n\t\t\t\t\t\t'success',\n\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t\"You're awesome! One less item on your to-do list ✅\",\n\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t\tgetHistory().push( getNewPath( {}, '/', {} ) );\n\t\t\t\t} else {\n\t\t\t\t\tthis.redirectToTaxSettings();\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.catch( () => {\n\t\t\t\tcreateNotice(\n\t\t\t\t\t'error',\n\t\t\t\t\t__(\n\t\t\t\t\t\t'There was a problem updating your tax settings.',\n\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t} );\n\t}\n\n\tredirectToTaxSettings() {\n\t\twindow.location = getAdminLink(\n\t\t\t'admin.php?page=wc-settings&tab=tax&section=standard&wc_onboarding_active_task=tax'\n\t\t);\n\t}\n\n\tgetSteps() {\n\t\tconst {\n\t\t\tgeneralSettings,\n\t\t\tisJetpackConnected,\n\t\t\tisPending,\n\t\t\ttosAccepted,\n\t\t\tupdateOptions,\n\t\t} = this.props;\n\t\tconst { cachedPluginsToActivate } = this.state;\n\n\t\tconst steps = [\n\t\t\t{\n\t\t\t\tkey: 'store_location',\n\t\t\t\tlabel: __( 'Set store location', 'woocommerce-admin' ),\n\t\t\t\tdescription: __(\n\t\t\t\t\t'The address from which your business operates',\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t),\n\t\t\t\tcontent: (\n\t\t\t\t\t<StoreLocation\n\t\t\t\t\t\t{ ...this.props }\n\t\t\t\t\t\tonComplete={ ( values ) => {\n\t\t\t\t\t\t\tconst country = getCountryCode(\n\t\t\t\t\t\t\t\tvalues.countryState\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\trecordEvent( 'tasklist_tax_set_location', {\n\t\t\t\t\t\t\t\tcountry,\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\tthis.completeStep();\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tisSettingsRequesting={ false }\n\t\t\t\t\t\tsettings={ generalSettings }\n\t\t\t\t\t/>\n\t\t\t\t),\n\t\t\t\tvisible: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'plugins',\n\t\t\t\tlabel: __(\n\t\t\t\t\t'Install Jetpack and WooCommerce Services',\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t),\n\t\t\t\tdescription: __(\n\t\t\t\t\t'Jetpack and WooCommerce Services allow you to automate sales tax calculations',\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t),\n\t\t\t\tcontent: (\n\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t<Plugins\n\t\t\t\t\t\t\tonComplete={ () => {\n\t\t\t\t\t\t\t\trecordEvent(\n\t\t\t\t\t\t\t\t\t'tasklist_tax_install_extensions',\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tinstall_extensions: true,\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tupdateOptions( {\n\t\t\t\t\t\t\t\t\twoocommerce_setup_jetpack_opted_in: true,\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\tthis.completeStep();\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\tonSkip={ () => {\n\t\t\t\t\t\t\t\tqueueRecordEvent(\n\t\t\t\t\t\t\t\t\t'tasklist_tax_install_extensions',\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tinstall_extensions: false,\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.manuallyConfigureTaxRates();\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\tskipText={ __(\n\t\t\t\t\t\t\t\t'Set up tax rates manually',\n\t\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{ ! tosAccepted && (\n\t\t\t\t\t\t\t<Text\n\t\t\t\t\t\t\t\tvariant=\"caption\"\n\t\t\t\t\t\t\t\tclassName=\"woocommerce-task__caption\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ interpolateComponents( {\n\t\t\t\t\t\t\t\t\tmixedString: __(\n\t\t\t\t\t\t\t\t\t\t'By installing Jetpack and WooCommerce Services you agree to the {{link}}Terms of Service{{/link}}.',\n\t\t\t\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\tcomponents: {\n\t\t\t\t\t\t\t\t\t\tlink: (\n\t\t\t\t\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\t\t\t\t\thref={\n\t\t\t\t\t\t\t\t\t\t\t\t\t'https://wordpress.com/tos/'\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"external\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t} ) }\n\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t) }\n\t\t\t\t\t</Fragment>\n\t\t\t\t),\n\t\t\t\tvisible:\n\t\t\t\t\t( cachedPluginsToActivate.length || ! tosAccepted ) &&\n\t\t\t\t\tthis.isTaxJarSupported(),\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'connect',\n\t\t\t\tlabel: __( 'Connect your store', 'woocommerce-admin' ),\n\t\t\t\tdescription: __(\n\t\t\t\t\t'Connect your store to WordPress.com to enable automated sales tax calculations',\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t),\n\t\t\t\tcontent: (\n\t\t\t\t\t<Connect\n\t\t\t\t\t\t{ ...this.props }\n\t\t\t\t\t\tonConnect={ () => {\n\t\t\t\t\t\t\trecordEvent( 'tasklist_tax_connect_store', {\n\t\t\t\t\t\t\t\tconnect: true,\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonSkip={ () => {\n\t\t\t\t\t\t\tqueueRecordEvent( 'tasklist_tax_connect_store', {\n\t\t\t\t\t\t\t\tconnect: false,\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\tthis.manuallyConfigureTaxRates();\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tskipText={ __(\n\t\t\t\t\t\t\t'Set up tax rates manually',\n\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t) }\n\t\t\t\t\t/>\n\t\t\t\t),\n\t\t\t\tvisible: ! isJetpackConnected && this.isTaxJarSupported(),\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'manual_configuration',\n\t\t\t\tlabel: __( 'Configure tax rates', 'woocommerce-admin' ),\n\t\t\t\tdescription: __(\n\t\t\t\t\t'Head over to the tax rate settings screen to configure your tax rates',\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t),\n\t\t\t\tcontent: (\n\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tdisabled={ isPending }\n\t\t\t\t\t\t\tisPrimary\n\t\t\t\t\t\t\tisBusy={ isPending }\n\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\trecordEvent( 'tasklist_tax_config_rates' );\n\t\t\t\t\t\t\t\tthis.manuallyConfigureTaxRates();\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ __( 'Configure', 'woocommerce-admin' ) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t{ generalSettings.woocommerce_calc_taxes !==\n\t\t\t\t\t\t\t\t'yes' &&\n\t\t\t\t\t\t\t\tinterpolateComponents( {\n\t\t\t\t\t\t\t\t\tmixedString: __(\n\t\t\t\t\t\t\t\t\t\t/*eslint-disable max-len*/\n\t\t\t\t\t\t\t\t\t\t'By clicking \"Configure\" you\\'re enabling tax rates and calculations. More info {{link}}here{{/link}}.',\n\t\t\t\t\t\t\t\t\t\t/*eslint-enable max-len*/\n\t\t\t\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\tcomponents: {\n\t\t\t\t\t\t\t\t\t\tlink: (\n\t\t\t\t\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\t\t\t\t\thref=\"https://docs.woocommerce.com/document/setting-up-taxes-in-woocommerce/#section-1\"\n\t\t\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"external\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t} ) }\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</Fragment>\n\t\t\t\t),\n\t\t\t\tvisible: ! this.isTaxJarSupported(),\n\t\t\t},\n\t\t];\n\n\t\treturn filter( steps, ( step ) => step.visible );\n\t}\n\n\trender() {\n\t\tconst { stepIndex } = this.state;\n\t\tconst { isPending, isResolving } = this.props;\n\t\tconst step = this.getSteps()[ stepIndex ];\n\n\t\treturn (\n\t\t\t<div className=\"woocommerce-task-tax\">\n\t\t\t\t<Card className=\"is-narrow\">\n\t\t\t\t\t{ this.shouldShowSuccessScreen() ? (\n\t\t\t\t\t\t<div className=\"woocommerce-task-tax__success\">\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclassName=\"woocommerce-task-tax__success-icon\"\n\t\t\t\t\t\t\t\trole=\"img\"\n\t\t\t\t\t\t\t\taria-labelledby=\"woocommerce-task-tax__success-message\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t🎊\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<H id=\"woocommerce-task-tax__success-message\">\n\t\t\t\t\t\t\t\t{ __( 'Good news!', 'woocommerce-admin' ) }\n\t\t\t\t\t\t\t</H>\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t{ interpolateComponents( {\n\t\t\t\t\t\t\t\t\tmixedString: __(\n\t\t\t\t\t\t\t\t\t\t'{{strong}}Jetpack{{/strong}} and {{strong}}WooCommerce Services{{/strong}} ' +\n\t\t\t\t\t\t\t\t\t\t\t'can automate your sales tax calculations for you.',\n\t\t\t\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\tcomponents: {\n\t\t\t\t\t\t\t\t\t\tstrong: <strong />,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t} ) }\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tdisabled={ isPending }\n\t\t\t\t\t\t\t\tisPrimary\n\t\t\t\t\t\t\t\tisBusy={ isPending }\n\t\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\t\trecordEvent(\n\t\t\t\t\t\t\t\t\t\t'tasklist_tax_setup_automated_proceed',\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tsetup_automatically: true,\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tthis.updateAutomatedTax( true );\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ __( 'Yes please', 'woocommerce-admin' ) }\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tdisabled={ isPending }\n\t\t\t\t\t\t\t\tisBusy={ isPending }\n\t\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\t\trecordEvent(\n\t\t\t\t\t\t\t\t\t\t'tasklist_tax_setup_automated_proceed',\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tsetup_automatically: false,\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tthis.updateAutomatedTax( false );\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ __(\n\t\t\t\t\t\t\t\t\t\"No thanks, I'll configure taxes manually\",\n\t\t\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<Stepper\n\t\t\t\t\t\t\tisPending={ isPending || isResolving }\n\t\t\t\t\t\t\tisVertical={ true }\n\t\t\t\t\t\t\tcurrentStep={ step.key }\n\t\t\t\t\t\t\tsteps={ this.getSteps() }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</Card>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default compose(\n\twithSelect( ( select ) => {\n\t\tconst { getSettings, isUpdateSettingsRequesting } = select(\n\t\t\tSETTINGS_STORE_NAME\n\t\t);\n\t\tconst { getOption } = select( OPTIONS_STORE_NAME );\n\t\tconst {\n\t\t\tgetActivePlugins,\n\t\t\tisJetpackConnected,\n\t\t\tisPluginsRequesting,\n\t\t} = select( PLUGINS_STORE_NAME );\n\n\t\tconst { general: generalSettings = {} } = getSettings( 'general' );\n\t\tconst countryCode = getCountryCode(\n\t\t\tgeneralSettings.woocommerce_default_country\n\t\t);\n\t\tconst {\n\t\t\twoocommerce_store_address: storeAddress,\n\t\t\twoocommerce_default_country: defaultCountry,\n\t\t\twoocommerce_store_postcode: storePostCode,\n\t\t} = generalSettings;\n\t\tconst hasCompleteAddress = Boolean(\n\t\t\tstoreAddress && defaultCountry && storePostCode\n\t\t);\n\n\t\tconst { tax: taxSettings = {} } = getSettings( 'tax' );\n\t\tconst activePlugins = getActivePlugins();\n\t\tconst pluginsToActivate = difference(\n\t\t\t[ 'jetpack', 'woocommerce-services' ],\n\t\t\tactivePlugins\n\t\t);\n\t\tconst connectOptions = getOption( 'wc_connect_options' ) || {};\n\t\tconst tosAccepted =\n\t\t\tconnectOptions.tos_accepted ||\n\t\t\tgetOption( 'woocommerce_setup_jetpack_opted_in' );\n\n\t\tconst isPending =\n\t\t\tisUpdateSettingsRequesting( 'tax' ) ||\n\t\t\tisUpdateSettingsRequesting( 'general' );\n\t\tconst isResolving = isPluginsRequesting( 'getJetpackConnectUrl' );\n\n\t\treturn {\n\t\t\tcountryCode,\n\t\t\tgeneralSettings,\n\t\t\thasCompleteAddress,\n\t\t\tisJetpackConnected: isJetpackConnected(),\n\t\t\tisPending,\n\t\t\tisResolving,\n\t\t\tpluginsToActivate,\n\t\t\ttaxSettings,\n\t\t\ttosAccepted,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { createNotice } = dispatch( 'core/notices' );\n\t\tconst { updateOptions } = dispatch( OPTIONS_STORE_NAME );\n\t\tconst { updateAndPersistSettingsForGroup } = dispatch(\n\t\t\tSETTINGS_STORE_NAME\n\t\t);\n\n\t\treturn {\n\t\t\tcreateNotice,\n\t\t\tupdateAndPersistSettingsForGroup,\n\t\t\tupdateOptions,\n\t\t};\n\t} )\n)( Tax );\n"],"sourceRoot":""}