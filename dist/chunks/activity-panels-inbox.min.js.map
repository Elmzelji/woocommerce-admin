{"version":3,"sources":["webpack://wc.[modulename]/./client/header/activity-panel/panels/reviews.js"],"names":["ReviewsPanel","mountTime","Date","getTime","eventName","recordEvent","review","props","lastRead","product","_embedded","up","isNull","title","interpolateComponents","mixedString","sprintf","__","name","reviewer","components","productLink","permalink","recordReviewEvent","authorLink","reviewer_email","subtitle","verified","productImage","get","productImageClasses","classnames","src","icon","manageReviewEvent","date","date_created_gmt","status","cardActions","getAdminLink","id","sanitizeHTML","lastApprovedReviewTime","buttonUrl","buttonTarget","buttonText","content","now","DAY","isError","isRequesting","reviews","actionLabel","actionCallback","window","location","reload","length","map","renderReview","renderEmptyMessage","Component","propTypes","PropTypes","array","isRequired","bool","defaultProps","withSelect","select","hasUnapprovedReviews","REVIEWS_STORE_NAME","getReviews","getReviewsError","isResolving","reviewsQuery","page","per_page","QUERY_DEFAULTS","pageSize","_embed","Boolean","approvedReviewsQuery","approvedReviews","lastApprovedReview","creationDate"],"mappings":"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","file":"chunks/activity-panels-inbox.min.js","sourcesContent":["/**\n * External dependencies\n */\nimport { __, sprintf } from '@wordpress/i18n';\nimport classnames from 'classnames';\nimport { Component, Fragment } from '@wordpress/element';\nimport { withSelect } from '@wordpress/data';\nimport { Button } from '@wordpress/components';\nimport Gridicon from 'gridicons';\nimport interpolateComponents from 'interpolate-components';\nimport { get, isNull } from 'lodash';\nimport PropTypes from 'prop-types';\n\nimport {\n\tEmptyContent,\n\tGravatar,\n\tLink,\n\tProductImage,\n\tReviewRating,\n\tSection,\n} from '@woocommerce/components';\nimport { getAdminLink } from '@woocommerce/wc-admin-settings';\nimport { REVIEWS_STORE_NAME, QUERY_DEFAULTS } from '@woocommerce/data';\nimport { recordEvent } from '@woocommerce/tracks';\n\n/**\n * Internal dependencies\n */\nimport { ActivityCard, ActivityCardPlaceholder } from '../activity-card';\nimport ActivityHeader from '../activity-header';\nimport sanitizeHTML from '../../../lib/sanitize-html';\n\nclass ReviewsPanel extends Component {\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.mountTime = new Date().getTime();\n\t}\n\n\trecordReviewEvent( eventName ) {\n\t\trecordEvent( `activity_panel_reviews_${ eventName }`, {} );\n\t}\n\n\trenderReview( review, props ) {\n\t\tconst { lastRead } = props;\n\t\tconst product =\n\t\t\t( review &&\n\t\t\t\treview._embedded &&\n\t\t\t\treview._embedded.up &&\n\t\t\t\treview._embedded.up[ 0 ] ) ||\n\t\t\tnull;\n\n\t\tif ( isNull( product ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst title = interpolateComponents( {\n\t\t\tmixedString: sprintf(\n\t\t\t\t__(\n\t\t\t\t\t'{{productLink}}%s{{/productLink}} reviewed by {{authorLink}}%s{{/authorLink}}',\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t),\n\t\t\t\tproduct.name,\n\t\t\t\treview.reviewer\n\t\t\t),\n\t\t\tcomponents: {\n\t\t\t\tproductLink: (\n\t\t\t\t\t<Link\n\t\t\t\t\t\thref={ product.permalink }\n\t\t\t\t\t\tonClick={ () => this.recordReviewEvent( 'product' ) }\n\t\t\t\t\t\ttype=\"external\"\n\t\t\t\t\t/>\n\t\t\t\t),\n\t\t\t\tauthorLink: (\n\t\t\t\t\t<Link\n\t\t\t\t\t\thref={ 'mailto:' + review.reviewer_email }\n\t\t\t\t\t\tonClick={ () => this.recordReviewEvent( 'customer' ) }\n\t\t\t\t\t\ttype=\"external\"\n\t\t\t\t\t/>\n\t\t\t\t),\n\t\t\t},\n\t\t} );\n\n\t\tconst subtitle = (\n\t\t\t<Fragment>\n\t\t\t\t<ReviewRating review={ review } />\n\t\t\t\t{ review.verified && (\n\t\t\t\t\t<span className=\"woocommerce-review-activity-card__verified\">\n\t\t\t\t\t\t<Gridicon icon=\"checkmark\" size={ 18 } />\n\t\t\t\t\t\t{ __( 'Verified customer', 'woocommerce-admin' ) }\n\t\t\t\t\t</span>\n\t\t\t\t) }\n\t\t\t</Fragment>\n\t\t);\n\n\t\tconst productImage =\n\t\t\tget( product, [ 'images', 0 ] ) || get( product, [ 'image' ] );\n\t\tconst productImageClasses = classnames(\n\t\t\t'woocommerce-review-activity-card__image-overlay__product',\n\t\t\t{\n\t\t\t\t'is-placeholder': ! productImage || ! productImage.src,\n\t\t\t}\n\t\t);\n\t\tconst icon = (\n\t\t\t<div className=\"woocommerce-review-activity-card__image-overlay\">\n\t\t\t\t<Gravatar user={ review.reviewer_email } size={ 24 } />\n\t\t\t\t<div className={ productImageClasses }>\n\t\t\t\t\t<ProductImage product={ product } />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\n\t\tconst manageReviewEvent = {\n\t\t\tdate: review.date_created_gmt,\n\t\t\tstatus: review.status,\n\t\t};\n\n\t\tconst cardActions = (\n\t\t\t<Button\n\t\t\t\tisSecondary\n\t\t\t\tonClick={ () =>\n\t\t\t\t\trecordEvent( 'review_manage_click', manageReviewEvent )\n\t\t\t\t}\n\t\t\t\thref={ getAdminLink(\n\t\t\t\t\t'comment.php?action=editcomment&c=' + review.id\n\t\t\t\t) }\n\t\t\t>\n\t\t\t\t{ __( 'Manage', 'woocommerce-admin' ) }\n\t\t\t</Button>\n\t\t);\n\n\t\treturn (\n\t\t\t<ActivityCard\n\t\t\t\tclassName=\"woocommerce-review-activity-card\"\n\t\t\t\tkey={ review.id }\n\t\t\t\ttitle={ title }\n\t\t\t\tsubtitle={ subtitle }\n\t\t\t\tdate={ review.date_created_gmt }\n\t\t\t\ticon={ icon }\n\t\t\t\tactions={ cardActions }\n\t\t\t\tunread={\n\t\t\t\t\treview.status === 'hold' ||\n\t\t\t\t\t! lastRead ||\n\t\t\t\t\t! review.date_created_gmt ||\n\t\t\t\t\tnew Date( review.date_created_gmt + 'Z' ).getTime() >\n\t\t\t\t\t\tlastRead\n\t\t\t\t}\n\t\t\t>\n\t\t\t\t<span\n\t\t\t\t\tdangerouslySetInnerHTML={ sanitizeHTML( review.review ) }\n\t\t\t\t/>\n\t\t\t</ActivityCard>\n\t\t);\n\t}\n\n\trenderEmptyMessage() {\n\t\tconst { lastApprovedReviewTime } = this.props;\n\n\t\tconst title = __(\n\t\t\t'You have no reviews to moderate',\n\t\t\t'woocommerce-admin'\n\t\t);\n\t\tlet buttonUrl = '';\n\t\tlet buttonTarget = '';\n\t\tlet buttonText = '';\n\t\tlet content = '';\n\t\tlet eventName = 'learn_more';\n\n\t\tif ( lastApprovedReviewTime ) {\n\t\t\tconst now = new Date();\n\t\t\tconst DAY = 24 * 60 * 60 * 1000;\n\t\t\tif ( ( now.getTime() - lastApprovedReviewTime ) / DAY > 30 ) {\n\t\t\t\tbuttonUrl =\n\t\t\t\t\t'https://woocommerce.com/posts/reviews-woocommerce-best-practices/';\n\t\t\t\tbuttonTarget = '_blank';\n\t\t\t\tbuttonText = __( 'Learn more', 'woocommerce-admin' );\n\t\t\t\tcontent = (\n\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t{ __(\n\t\t\t\t\t\t\t\t\"We noticed that it's been a while since your products had any reviews.\",\n\t\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t{ __(\n\t\t\t\t\t\t\t\t'Take some time to learn about best practices for collecting and using your reviews.',\n\t\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</Fragment>\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tbuttonUrl = getAdminLink(\n\t\t\t\t\t'edit-comments.php?comment_type=review'\n\t\t\t\t);\n\t\t\t\tbuttonText = __( 'View all Reviews', 'woocommerce-admin' );\n\t\t\t\tcontent = (\n\t\t\t\t\t<p>\n\t\t\t\t\t\t{ __(\n\t\t\t\t\t\t\t/* eslint-disable max-len */\n\t\t\t\t\t\t\t\"Awesome, you've moderated all of your product reviews. How about responding to some of those negative reviews?\",\n\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t\t/* eslint-enable */\n\t\t\t\t\t\t) }\n\t\t\t\t\t</p>\n\t\t\t\t);\n\t\t\t\teventName = 'view_reviews';\n\t\t\t}\n\t\t} else {\n\t\t\tbuttonUrl =\n\t\t\t\t'https://woocommerce.com/posts/reviews-woocommerce-best-practices/';\n\t\t\tbuttonTarget = '_blank';\n\t\t\tbuttonText = __( 'Learn more', 'woocommerce-admin' );\n\t\t\tcontent = (\n\t\t\t\t<Fragment>\n\t\t\t\t\t<p>\n\t\t\t\t\t\t{ __(\n\t\t\t\t\t\t\t\"Your customers haven't started reviewing your products.\",\n\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t) }\n\t\t\t\t\t</p>\n\t\t\t\t\t<p>\n\t\t\t\t\t\t{ __(\n\t\t\t\t\t\t\t'Take some time to learn about best practices for collecting and using your reviews.',\n\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t) }\n\t\t\t\t\t</p>\n\t\t\t\t</Fragment>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<ActivityCard\n\t\t\t\tclassName=\"woocommerce-empty-activity-card\"\n\t\t\t\ttitle={ title }\n\t\t\t\ticon={ <Gridicon icon=\"time\" size={ 48 } /> }\n\t\t\t\tactions={\n\t\t\t\t\t<Button\n\t\t\t\t\t\thref={ buttonUrl }\n\t\t\t\t\t\ttarget={ buttonTarget }\n\t\t\t\t\t\tisSecondary\n\t\t\t\t\t\tonClick={ () => this.recordReviewEvent( eventName ) }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ buttonText }\n\t\t\t\t\t</Button>\n\t\t\t\t}\n\t\t\t>\n\t\t\t\t{ content }\n\t\t\t</ActivityCard>\n\t\t);\n\t}\n\n\trender() {\n\t\tconst { isError, isRequesting, reviews } = this.props;\n\n\t\tif ( isError ) {\n\t\t\tconst title = __(\n\t\t\t\t'There was an error getting your reviews. Please try again.',\n\t\t\t\t'woocommerce-admin'\n\t\t\t);\n\t\t\tconst actionLabel = __( 'Reload', 'woocommerce-admin' );\n\t\t\tconst actionCallback = () => {\n\t\t\t\twindow.location.reload();\n\t\t\t};\n\n\t\t\treturn (\n\t\t\t\t<Fragment>\n\t\t\t\t\t<EmptyContent\n\t\t\t\t\t\ttitle={ title }\n\t\t\t\t\t\tactionLabel={ actionLabel }\n\t\t\t\t\t\tactionURL={ null }\n\t\t\t\t\t\tactionCallback={ actionCallback }\n\t\t\t\t\t/>\n\t\t\t\t</Fragment>\n\t\t\t);\n\t\t}\n\n\t\tconst title =\n\t\t\tisRequesting || reviews.length\n\t\t\t\t? __( 'Reviews', 'woocommerce-admin' )\n\t\t\t\t: __( 'No reviews to moderate', 'woocommerce-admin' );\n\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t<ActivityHeader title={ title } />\n\t\t\t\t<Section>\n\t\t\t\t\t{ isRequesting ? (\n\t\t\t\t\t\t<ActivityCardPlaceholder\n\t\t\t\t\t\t\tclassName=\"woocommerce-review-activity-card\"\n\t\t\t\t\t\t\thasAction\n\t\t\t\t\t\t\thasDate\n\t\t\t\t\t\t\tlines={ 2 }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t\t{ reviews.length\n\t\t\t\t\t\t\t\t? reviews.map( ( review ) =>\n\t\t\t\t\t\t\t\t\t\tthis.renderReview( review, this.props )\n\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t: this.renderEmptyMessage() }\n\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t) }\n\t\t\t\t</Section>\n\t\t\t</Fragment>\n\t\t);\n\t}\n}\n\nReviewsPanel.propTypes = {\n\treviews: PropTypes.array.isRequired,\n\tisError: PropTypes.bool,\n\tisRequesting: PropTypes.bool,\n};\n\nReviewsPanel.defaultProps = {\n\treviews: [],\n\tisError: false,\n\tisRequesting: false,\n};\n\nexport default withSelect( ( select, props ) => {\n\tconst { hasUnapprovedReviews } = props;\n\tconst { getReviews, getReviewsError, isResolving } = select(\n\t\tREVIEWS_STORE_NAME\n\t);\n\tlet reviews = [];\n\tlet isError = false;\n\tlet isRequesting = false;\n\tlet lastApprovedReviewTime = null;\n\tif ( hasUnapprovedReviews ) {\n\t\tconst reviewsQuery = {\n\t\t\tpage: 1,\n\t\t\tper_page: QUERY_DEFAULTS.pageSize,\n\t\t\tstatus: 'hold',\n\t\t\t_embed: 1,\n\t\t};\n\t\treviews = getReviews( reviewsQuery );\n\t\tisError = Boolean( getReviewsError( reviewsQuery ) );\n\t\tisRequesting = isResolving( 'getReviews', [ reviewsQuery ] );\n\t} else {\n\t\tconst approvedReviewsQuery = {\n\t\t\tpage: 1,\n\t\t\tper_page: 1,\n\t\t\tstatus: 'approved',\n\t\t\t_embed: 1,\n\t\t};\n\t\tconst approvedReviews = getReviews( approvedReviewsQuery );\n\t\tif ( approvedReviews.length ) {\n\t\t\tconst lastApprovedReview = approvedReviews[ 0 ];\n\t\t\tif ( lastApprovedReview.date_created_gmt ) {\n\t\t\t\tconst creationDate = new Date(\n\t\t\t\t\tlastApprovedReview.date_created_gmt\n\t\t\t\t);\n\t\t\t\tlastApprovedReviewTime = creationDate.getTime();\n\t\t\t}\n\t\t}\n\n\t\tisError = Boolean( getReviewsError( approvedReviewsQuery ) );\n\t\tisRequesting = isResolving( 'getReviews', [ approvedReviewsQuery ] );\n\t}\n\n\treturn {\n\t\treviews,\n\t\tisError,\n\t\tisRequesting,\n\t\tlastApprovedReviewTime,\n\t};\n} )( ReviewsPanel );\n"],"sourceRoot":""}