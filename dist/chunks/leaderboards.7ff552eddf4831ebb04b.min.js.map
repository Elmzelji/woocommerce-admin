{"version":3,"sources":["webpack://wc.[modulename]/./client/analytics/components/leaderboard/index.js","webpack://wc.[modulename]/./client/dashboard/leaderboards/index.js","webpack://wc.[modulename]/./client/lib/sanitize-html/index.js"],"names":["Leaderboard","props","headers","map","header","i","isLeftAligned","hiddenByDefault","isSortable","key","label","rows","row","column","display","sanitizeHTML","value","isRequesting","isError","totalRows","title","classes","getFormattedRows","length","__","getFormattedHeaders","Component","propTypes","PropTypes","arrayOf","shape","string","id","isRequired","query","object","node","oneOfType","number","bool","defaultProps","compose","withSelect","select","SETTINGS_STORE_NAME","getSetting","defaultDateRange","woocommerce_default_date_range","leaderboardQuery","per_page","persisted_query","getPersistedQuery","leaderboardData","getLeaderboard","Leaderboards","arguments","setRowsPerTable","setState","rowsPerTable","parseInt","userDataFields","dashboard_leaderboard_rows","updateCurrentUserData","state","userPrefLeaderboardRows","allLeaderboards","isFirst","isLast","hiddenBlocks","onMove","onRemove","onTitleBlur","onTitleChange","onToggleHiddenBlock","titleInput","Controls","controls","onToggle","leaderboard","checked","includes","recordEvent","status","Array","from","v","window","undefined","renderMenu","renderLeaderboards","getCurrentUserData","getItems","getItemsError","isGetItemsRequesting","userData","leaderboards","withDispatch","dispatch","ALLOWED_TAGS","ALLOWED_ATTR","html","__html","sanitize"],"mappings":"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","file":"chunks/leaderboards.7ff552eddf4831ebb04b.min.js","sourcesContent":["/**\n * External dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Component } from '@wordpress/element';\nimport { compose } from '@wordpress/compose';\nimport PropTypes from 'prop-types';\n\n/**\n * WooCommerce dependencies\n */\nimport { Card, EmptyTable, TableCard } from '@woocommerce/components';\nimport { getPersistedQuery } from '@woocommerce/navigation';\nimport { SETTINGS_STORE_NAME } from '@woocommerce/data';\n\n/**\n * Internal dependencies\n */\nimport { getLeaderboard } from 'wc-api/items/utils';\nimport ReportError from 'analytics/components/report-error';\nimport sanitizeHTML from 'lib/sanitize-html';\nimport withSelect from 'wc-api/with-select';\nimport './style.scss';\n\nexport class Leaderboard extends Component {\n\tgetFormattedHeaders() {\n\t\treturn this.props.headers.map( ( header, i ) => {\n\t\t\treturn {\n\t\t\t\tisLeftAligned: i === 0,\n\t\t\t\thiddenByDefault: false,\n\t\t\t\tisSortable: false,\n\t\t\t\tkey: header.label,\n\t\t\t\tlabel: header.label,\n\t\t\t};\n\t\t} );\n\t}\n\n\tgetFormattedRows() {\n\t\treturn this.props.rows.map( ( row ) => {\n\t\t\treturn row.map( ( column ) => {\n\t\t\t\treturn {\n\t\t\t\t\tdisplay: (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdangerouslySetInnerHTML={ sanitizeHTML(\n\t\t\t\t\t\t\t\tcolumn.display\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t/>\n\t\t\t\t\t),\n\t\t\t\t\tvalue: column.value,\n\t\t\t\t};\n\t\t\t} );\n\t\t} );\n\t}\n\n\trender() {\n\t\tconst { isRequesting, isError, totalRows, title } = this.props;\n\t\tconst classes = 'woocommerce-leaderboard';\n\n\t\tif ( isError ) {\n\t\t\treturn <ReportError className={ classes } isError />;\n\t\t}\n\n\t\tconst rows = this.getFormattedRows();\n\n\t\tif ( ! isRequesting && rows.length === 0 ) {\n\t\t\treturn (\n\t\t\t\t<Card title={ title } className={ classes }>\n\t\t\t\t\t<EmptyTable>\n\t\t\t\t\t\t{ __(\n\t\t\t\t\t\t\t'No data recorded for the selected time period.',\n\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t) }\n\t\t\t\t\t</EmptyTable>\n\t\t\t\t</Card>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<TableCard\n\t\t\t\tclassName={ classes }\n\t\t\t\theaders={ this.getFormattedHeaders() }\n\t\t\t\tisLoading={ isRequesting }\n\t\t\t\trows={ rows }\n\t\t\t\trowsPerPage={ totalRows }\n\t\t\t\tshowMenu={ false }\n\t\t\t\ttitle={ title }\n\t\t\t\ttotalRows={ totalRows }\n\t\t\t/>\n\t\t);\n\t}\n}\n\nLeaderboard.propTypes = {\n\t/**\n\t * An array of column headers.\n\t */\n\theaders: PropTypes.arrayOf(\n\t\tPropTypes.shape( {\n\t\t\tlabel: PropTypes.string,\n\t\t} )\n\t),\n\t/**\n\t * String of leaderboard ID to display.\n\t */\n\tid: PropTypes.string.isRequired,\n\t/**\n\t * Query args added to the report table endpoint request.\n\t */\n\tquery: PropTypes.object,\n\t/**\n\t * Which column should be the row header, defaults to the first item (`0`) (see `Table` props).\n\t */\n\trows: PropTypes.arrayOf(\n\t\tPropTypes.arrayOf(\n\t\t\tPropTypes.shape( {\n\t\t\t\tdisplay: PropTypes.node,\n\t\t\t\tvalue: PropTypes.oneOfType( [\n\t\t\t\t\tPropTypes.string,\n\t\t\t\t\tPropTypes.number,\n\t\t\t\t\tPropTypes.bool,\n\t\t\t\t] ),\n\t\t\t} )\n\t\t)\n\t).isRequired,\n\t/**\n\t * String to display as the title of the table.\n\t */\n\ttitle: PropTypes.string.isRequired,\n\t/**\n\t * Number of table rows.\n\t */\n\ttotalRows: PropTypes.number.isRequired,\n};\n\nLeaderboard.defaultProps = {\n\trows: [],\n\tisError: false,\n\tisRequesting: false,\n};\n\nexport default compose(\n\twithSelect( ( select, props ) => {\n\t\tconst { id, query, totalRows } = props;\n\t\tconst { woocommerce_default_date_range: defaultDateRange } = select(\n\t\t\tSETTINGS_STORE_NAME\n\t\t).getSetting( 'wc_admin', 'wcAdminSettings' );\n\n\t\tconst leaderboardQuery = {\n\t\t\tid,\n\t\t\tper_page: totalRows,\n\t\t\tpersisted_query: getPersistedQuery( query ),\n\t\t\tquery,\n\t\t\tselect,\n\t\t\tdefaultDateRange,\n\t\t};\n\t\tconst leaderboardData = getLeaderboard( leaderboardQuery );\n\n\t\treturn leaderboardData;\n\t} )\n)( Leaderboard );\n","/**\n * External dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Component, Fragment } from '@wordpress/element';\nimport { compose } from '@wordpress/compose';\nimport PropTypes from 'prop-types';\nimport { SelectControl } from '@wordpress/components';\nimport { withDispatch } from '@wordpress/data';\n\n/**\n * WooCommerce dependencies\n */\nimport {\n\tEllipsisMenu,\n\tMenuItem,\n\tMenuTitle,\n\tSectionHeader,\n} from '@woocommerce/components';\nimport { getSetting } from '@woocommerce/wc-admin-settings';\n\n/**\n * Internal dependencies\n */\nimport Leaderboard from 'analytics/components/leaderboard';\nimport withSelect from 'wc-api/with-select';\nimport { recordEvent } from 'lib/tracks';\nimport './style.scss';\n\nclass Leaderboards extends Component {\n\tconstructor( props ) {\n\t\tsuper( ...arguments );\n\n\t\tthis.state = {\n\t\t\trowsPerTable: parseInt( props.userPrefLeaderboardRows, 10 ) || 5,\n\t\t};\n\t}\n\n\tsetRowsPerTable = ( rows ) => {\n\t\tthis.setState( { rowsPerTable: parseInt( rows, 10 ) } );\n\t\tconst userDataFields = {\n\t\t\tdashboard_leaderboard_rows: parseInt( rows, 10 ),\n\t\t};\n\t\tthis.props.updateCurrentUserData( userDataFields );\n\t};\n\n\trenderMenu() {\n\t\tconst {\n\t\t\tallLeaderboards,\n\t\t\tisFirst,\n\t\t\tisLast,\n\t\t\thiddenBlocks,\n\t\t\tonMove,\n\t\t\tonRemove,\n\t\t\tonTitleBlur,\n\t\t\tonTitleChange,\n\t\t\tonToggleHiddenBlock,\n\t\t\ttitleInput,\n\t\t\tcontrols: Controls,\n\t\t} = this.props;\n\t\tconst { rowsPerTable } = this.state;\n\n\t\treturn (\n\t\t\t<EllipsisMenu\n\t\t\t\tlabel={ __(\n\t\t\t\t\t'Choose which leaderboards to display and other settings',\n\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t) }\n\t\t\t\trenderContent={ ( { onToggle } ) => (\n\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t<MenuTitle>\n\t\t\t\t\t\t\t{ __( 'Leaderboards', 'woocommerce-admin' ) }\n\t\t\t\t\t\t</MenuTitle>\n\t\t\t\t\t\t{ allLeaderboards.map( ( leaderboard ) => {\n\t\t\t\t\t\t\tconst checked = ! hiddenBlocks.includes(\n\t\t\t\t\t\t\t\tleaderboard.id\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\t\t\tchecked={ checked }\n\t\t\t\t\t\t\t\t\tisCheckbox\n\t\t\t\t\t\t\t\t\tisClickable\n\t\t\t\t\t\t\t\t\tkey={ leaderboard.id }\n\t\t\t\t\t\t\t\t\tonInvoke={ () => {\n\t\t\t\t\t\t\t\t\t\tonToggleHiddenBlock( leaderboard.id )();\n\t\t\t\t\t\t\t\t\t\trecordEvent(\n\t\t\t\t\t\t\t\t\t\t\t'dash_leaderboards_toggle',\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tstatus: checked ? 'off' : 'on',\n\t\t\t\t\t\t\t\t\t\t\t\tkey: leaderboard.id,\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{ leaderboard.label }\n\t\t\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} ) }\n\t\t\t\t\t\t<SelectControl\n\t\t\t\t\t\t\tclassName=\"woocommerce-dashboard__dashboard-leaderboards__select\"\n\t\t\t\t\t\t\tlabel={ __(\n\t\t\t\t\t\t\t\t'Rows Per Table',\n\t\t\t\t\t\t\t\t'woocommerce-admin'\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\tvalue={ rowsPerTable }\n\t\t\t\t\t\t\toptions={ Array.from(\n\t\t\t\t\t\t\t\t{ length: 20 },\n\t\t\t\t\t\t\t\t( v, key ) => ( {\n\t\t\t\t\t\t\t\t\tv: key + 1,\n\t\t\t\t\t\t\t\t\tlabel: key + 1,\n\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\tonChange={ this.setRowsPerTable }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{ window.wcAdminFeatures[\n\t\t\t\t\t\t\t'analytics-dashboard/customizable'\n\t\t\t\t\t\t] && (\n\t\t\t\t\t\t\t<Controls\n\t\t\t\t\t\t\t\tonToggle={ onToggle }\n\t\t\t\t\t\t\t\tonMove={ onMove }\n\t\t\t\t\t\t\t\tonRemove={ onRemove }\n\t\t\t\t\t\t\t\tisFirst={ isFirst }\n\t\t\t\t\t\t\t\tisLast={ isLast }\n\t\t\t\t\t\t\t\tonTitleBlur={ onTitleBlur }\n\t\t\t\t\t\t\t\tonTitleChange={ onTitleChange }\n\t\t\t\t\t\t\t\ttitleInput={ titleInput }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t</Fragment>\n\t\t\t\t) }\n\t\t\t/>\n\t\t);\n\t}\n\n\trenderLeaderboards() {\n\t\tconst { rowsPerTable } = this.state;\n\t\tconst { allLeaderboards, hiddenBlocks, query } = this.props;\n\n\t\treturn allLeaderboards.map( ( leaderboard ) => {\n\t\t\tif ( hiddenBlocks.includes( leaderboard.id ) ) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn (\n\t\t\t\t<Leaderboard\n\t\t\t\t\theaders={ leaderboard.headers }\n\t\t\t\t\tid={ leaderboard.id }\n\t\t\t\t\tkey={ leaderboard.id }\n\t\t\t\t\tquery={ query }\n\t\t\t\t\ttitle={ leaderboard.label }\n\t\t\t\t\ttotalRows={ rowsPerTable }\n\t\t\t\t/>\n\t\t\t);\n\t\t} );\n\t}\n\n\trender() {\n\t\tconst { title } = this.props;\n\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t<div className=\"woocommerce-dashboard__dashboard-leaderboards\">\n\t\t\t\t\t<SectionHeader\n\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\ttitle || __( 'Leaderboards', 'woocommerce-admin' )\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmenu={ this.renderMenu() }\n\t\t\t\t\t/>\n\t\t\t\t\t<div className=\"woocommerce-dashboard__columns\">\n\t\t\t\t\t\t{ this.renderLeaderboards() }\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Fragment>\n\t\t);\n\t}\n}\n\nLeaderboards.propTypes = {\n\tquery: PropTypes.object.isRequired,\n};\n\nexport default compose(\n\twithSelect( ( select ) => {\n\t\tconst {\n\t\t\tgetCurrentUserData,\n\t\t\tgetItems,\n\t\t\tgetItemsError,\n\t\t\tisGetItemsRequesting,\n\t\t} = select( 'wc-api' );\n\t\tconst userData = getCurrentUserData();\n\t\tconst { leaderboards: allLeaderboards } = getSetting( 'dataEndpoints', {\n\t\t\tleaderboards: [],\n\t\t} );\n\n\t\treturn {\n\t\t\tallLeaderboards,\n\t\t\tgetItems,\n\t\t\tgetItemsError,\n\t\t\tisGetItemsRequesting,\n\t\t\tuserPrefLeaderboardRows: userData.dashboard_leaderboard_rows,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { updateCurrentUserData } = dispatch( 'wc-api' );\n\n\t\treturn {\n\t\t\tupdateCurrentUserData,\n\t\t};\n\t} )\n)( Leaderboards );\n","/**\n * External dependencies\n */\nimport { sanitize } from 'dompurify';\n\nexport const ALLOWED_TAGS = [ 'a', 'b', 'em', 'i', 'strong', 'p' ];\nexport const ALLOWED_ATTR = [ 'target', 'href', 'rel', 'name', 'download' ];\n\nexport default ( html ) => {\n\treturn {\n\t\t__html: sanitize( html, { ALLOWED_TAGS, ALLOWED_ATTR } ),\n\t};\n};\n"],"sourceRoot":""}